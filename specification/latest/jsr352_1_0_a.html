<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Batch Applications for the Java Platform</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Batch Applications for the Java Platform</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Version 1.0, Revision A</p>
</div>
<div class="paragraph">
<p>Maintenance Release</p>
</div>
<div class="paragraph">
<p><strong>Scott Kurz</strong></p>
</div>
<div class="paragraph">
<p>Final Release: <strong>Chris Vignola</strong>, <strong>18 April 2013</strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license">1. License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>IBM Corporation (the "Spec Lead") for the Java Batch specification (the "Specification") hereby grants permission to copy and display the Specification, in any medium without fee or royalty, provided that you include the following on ALL copies, or portions thereof, that you make:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A link or URL to the Specification at this location: <a href="http://jcp.org/aboutJava/communityprocess/final/jsr352/index.html">http://jcp.org/aboutJava/communityprocess/final/jsr352/index.html</a></p>
</li>
<li>
<p>The copyright notice as shown herein.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>The Spec Lead offers to grant a perpetual, non-exclusive, worldwide, fully paid-up, royalty free, irrevocable license under its licensable copyrights and patent claims for which there is no technically feasible way of avoiding infringement in the course of implementing the Specification, provided that you:

a. fully implement the Specification including all its required interfaces and functionality.
b. do not modify, subset, superset or otherwise extend the Specification's name space;
c. pass the TCK for this Specification; and
d. grant a reciprocal license to any of your patents necessary to implement required portions of the Specification on terms consistent with the provisions of Section 6.A of the Java Specification Participation Agreement.

THE SPECIFICATION IS PROVIDED "AS IS," AND THE SPEC LEAD AND ANY OTHER AUTHORS MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, NONINFRINGEMENT, OR TITLE; THAT THE CONTENTS OF THE SPECIFICATION ARE SUITABLE FOR ANY PURPOSE; NOR THAT THE IMPLEMENTATION OF SUCH CONTENTS WILL NOT INFRINGE
ANY THIRD PARTY PATENTS, COPYRIGHTS, TRADEMARKS OR OTHER RIGHTS. THE SPEC LEAD AND ANY OTHER AUTHORS WILL NOT BE LIABLE FOR ANY DIRECT, INDIRECT, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF ANY USE OF THE SPECIFICATION OR THE PERFORMANCE OR IMPLEMENTATION OF THE CONTENTS THEREOF.

The name and trademarks of the Spec Lead or any other Authors may NOT be used in any manner, including advertising or publicity pertaining to the Specification or its contents without specific, written prior permission. Title to copyright in the Specification will at all times remain with the Authors. No other rights are granted by implication, estoppel or otherwise.</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements">2. Acknowledgements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A number of individuals deserve special recognition for their contributions to forming this specification:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kevin Conner</p>
</li>
<li>
<p>Tim Fanelli</p>
</li>
<li>
<p>Cheng Fang</p>
</li>
<li>
<p>Mahesh Kannan</p>
</li>
<li>
<p>Scott Kurz</p>
</li>
<li>
<p>Wayne Lund</p>
</li>
<li>
<p>Simon Martinelli</p>
</li>
<li>
<p>Michael Minella</p>
</li>
<li>
<p>Kaushik Mukherjee</p>
</li>
<li>
<p>Joe Pullen</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_foreword">3. Foreword</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This specification describes the job specification language, Java programming model, and runtime environment for batch applications for the Java platform. It is designed for use on both the Java SE and Java EE platforms. Additionally, it is designed to work with dependency injection (DI) containers without prescribing a particular DI implementation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_table_of_contents">4. Table of Contents</h2>
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_license">1. License</a></li>
<li><a href="#_acknowledgements">2. Acknowledgements</a></li>
<li><a href="#_foreword">3. Foreword</a></li>
<li><a href="#_table_of_contents">4. Table of Contents</a></li>
<li><a href="#_introduction_to_jsr_352">5. Introduction to JSR 352</a></li>
<li><a href="#_applicability_of_specification">6. Applicability of Specification</a></li>
<li><a href="#_domain_language_of_batch">7. Domain Language of Batch</a>
<ul class="sectlevel2">
<li><a href="#_job">7.1. Job</a>
<ul class="sectlevel3">
<li><a href="#_jobinstance">7.1.1. JobInstance</a></li>
<li><a href="#_jobparameters">7.1.2. JobParameters</a></li>
<li><a href="#_jobexecution">7.1.3. JobExecution</a></li>
</ul>
</li>
<li><a href="#_step">7.2. Step</a>
<ul class="sectlevel3">
<li><a href="#_stepexecution">7.2.1. StepExecution</a></li>
</ul>
</li>
<li><a href="#_joboperator">7.3. JobOperator</a></li>
<li><a href="#_job_repository">7.4. Job Repository</a></li>
<li><a href="#_itemreader">7.5. ItemReader</a></li>
<li><a href="#_itemwriter">7.6. ItemWriter</a></li>
<li><a href="#_itemprocessor">7.7. ItemProcessor</a></li>
<li><a href="#_chunk_oriented_processing">7.8. Chunk-oriented Processing</a></li>
<li><a href="#_batch_checkpoints">7.9. Batch Checkpoints</a></li>
</ul>
</li>
<li><a href="#_job_specification_language">8. Job Specification Language</a>
<ul class="sectlevel2">
<li><a href="#_job_2">8.1. Job</a>
<ul class="sectlevel3">
<li><a href="#_job_level_listeners">8.1.1. Job Level Listeners</a></li>
<li><a href="#_job_level_exception_handling">8.1.2. Job Level Exception Handling</a></li>
<li><a href="#_job_level_properties">8.1.3. Job Level Properties</a></li>
</ul>
</li>
<li><a href="#_step_2">8.2. Step</a>
<ul class="sectlevel3">
<li><a href="#_chunk">8.2.1. Chunk</a>
<ul class="sectlevel4">
<li><a href="#_reader">8.2.1.1. Reader</a>
<ul class="sectlevel5">
<li><a href="#_reader_properties">8.2.1.1.1. Reader Properties</a></li>
</ul>
</li>
<li><a href="#_processor">8.2.1.2. Processor</a>
<ul class="sectlevel5">
<li><a href="#_processor_properties">8.2.1.2.1. Processor Properties</a></li>
</ul>
</li>
<li><a href="#_writer">8.2.1.3. Writer</a>
<ul class="sectlevel5">
<li><a href="#_writer_properties">8.2.1.3.1. Writer Properties</a></li>
</ul>
</li>
<li><a href="#_chunk_exception_handling">8.2.1.4. Chunk Exception Handling</a>
<ul class="sectlevel5">
<li><a href="#_skipping_exceptions">8.2.1.4.1. Skipping Exceptions</a></li>
<li><a href="#_retrying_exceptions">8.2.1.4.2. Retrying Exceptions</a></li>
<li><a href="#_retry_and_skip_the_same_exception">8.2.1.4.3. Retry and Skip the Same Exception</a></li>
<li><a href="#_default_retry_behavior_rollback">8.2.1.4.4. Default Retry Behavior - Rollback</a></li>
<li><a href="#_preventing_rollback_during_retry">8.2.1.4.5. Preventing Rollback During Retry</a></li>
</ul>
</li>
<li><a href="#_checkpoint_algorithm">8.2.1.5. Checkpoint Algorithm</a>
<ul class="sectlevel5">
<li><a href="#_checkpoint_algorithm_properties">8.2.1.5.1. Checkpoint Algorithm Properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_batchlet">8.2.2. Batchlet</a>
<ul class="sectlevel4">
<li><a href="#_batchlet_exception_handling">8.2.2.1. Batchlet Exception Handling</a></li>
<li><a href="#_batchlet_properties">8.2.2.2. Batchlet Properties</a></li>
</ul>
</li>
<li><a href="#_step_level_properties">8.2.3. Step Level Properties</a></li>
<li><a href="#_step_level_listeners">8.2.4. Step Level Listeners</a>
<ul class="sectlevel4">
<li><a href="#_step_level_listener_properties">8.2.4.1. Step Level Listener Properties</a></li>
</ul>
</li>
<li><a href="#_step_sequence">8.2.5. Step Sequence</a></li>
<li><a href="#_step_partitioning">8.2.6. Step Partitioning</a>
<ul class="sectlevel4">
<li><a href="#_partition_plan">8.2.6.1. Partition Plan</a></li>
<li><a href="#_partition_properties">8.2.6.2. Partition Properties</a></li>
<li><a href="#_partition_mapper">8.2.6.3. Partition Mapper</a>
<ul class="sectlevel5">
<li><a href="#_mapper_properties">8.2.6.3.1. Mapper Properties</a></li>
</ul>
</li>
<li><a href="#_partition_reducer">8.2.6.4. Partition Reducer</a>
<ul class="sectlevel5">
<li><a href="#_partition_reducer_properties">8.2.6.4.1. Partition Reducer Properties</a></li>
</ul>
</li>
<li><a href="#_partition_collector">8.2.6.5. Partition Collector</a>
<ul class="sectlevel5">
<li><a href="#_partition_collector_properties">8.2.6.5.1. Partition Collector Properties</a></li>
</ul>
</li>
<li><a href="#_partition_analyzer">8.2.6.6. Partition Analyzer</a>
<ul class="sectlevel5">
<li><a href="#_partition_analyzer_properties">8.2.6.6.1. Partition Analyzer Properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_step_exception_handling">8.2.7. Step Exception Handling</a></li>
</ul>
</li>
<li><a href="#_flow">8.3. Flow</a></li>
<li><a href="#_split">8.4. Split</a>
<ul class="sectlevel3">
<li><a href="#_split_termination_processing_incomplete">8.4.1. Split Termination Processing Incomplete</a></li>
</ul>
</li>
<li><a href="#_decision">8.5. Decision</a>
<ul class="sectlevel3">
<li><a href="#_decision_properties">8.5.1. Decision Properties</a></li>
<li><a href="#_decision_exception_handling">8.5.2. Decision Exception Handling</a></li>
</ul>
</li>
<li><a href="#_transition_elements">8.6. Transition Elements</a>
<ul class="sectlevel3">
<li><a href="#_next_element">8.6.1. Next Element</a></li>
<li><a href="#_fail_element">8.6.2. Fail Element</a></li>
<li><a href="#_end_element">8.6.3. End Element</a></li>
<li><a href="#_stop_element">8.6.4. Stop Element</a></li>
</ul>
</li>
<li><a href="#_batch_and_exit_status">8.7. Batch and Exit Status</a>
<ul class="sectlevel3">
<li><a href="#_batch_and_exit_status_for_steps">8.7.1. Batch and Exit Status for Steps</a></li>
<li><a href="#_exit_status_for_partitioned_steps">8.7.2. Exit Status for Partitioned Steps</a></li>
</ul>
</li>
<li><a href="#_job_xml_substitution">8.8. Job XML Substitution</a>
<ul class="sectlevel3">
<li><a href="#_substitution_processing_rules">8.8.1. Substitution Processing Rules</a>
<ul class="sectlevel4">
<li><a href="#_jobparameters_substitution_operator">8.8.1.1. jobParameters Substitution Operator</a></li>
<li><a href="#_jobproperties_substitution_operator">8.8.1.2. jobProperties Substitution Operator</a></li>
<li><a href="#_systemproperties_substitution_operator">8.8.1.3. systemProperties Substitution Operator</a></li>
<li><a href="#_partitionplan_substitution_operator">8.8.1.4. partitionPlan Substitution Operator</a></li>
<li><a href="#_substitution_expression_default">8.8.1.5. Substitution Expression Default</a></li>
<li><a href="#_property_resolution_rule">8.8.1.6. Property Resolution Rule</a></li>
<li><a href="#_undefined_target_name_rule">8.8.1.7. Undefined Target Name Rule</a></li>
<li><a href="#_job_restart_rule">8.8.1.8. Job Restart Rule</a></li>
</ul>
</li>
<li><a href="#_examples">8.8.2. Examples</a></li>
</ul>
</li>
<li><a href="#_transitioning_rules">8.9. Transitioning Rules</a>
<ul class="sectlevel3">
<li><a href="#_combining_transition_elements">8.9.1. Combining Transition Elements</a></li>
<li><a href="#_transitioning_precedence_rules">8.9.2. Transitioning Precedence Rules</a></li>
<li><a href="#_loop_definition">8.9.3. Loop definition</a></li>
<li><a href="#_transitioning_from_within_flows">8.9.4. Transitioning From Within Flows</a></li>
<li><a href="#_flow_level_transitions_undefined">8.9.5. Flow-level Transitions Undefined</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_batch_programming_model">9. Batch Programming Model</a>
<ul class="sectlevel2">
<li><a href="#_steps">9.1. Steps</a>
<ul class="sectlevel3">
<li><a href="#_chunk_2">9.1.1. Chunk</a>
<ul class="sectlevel4">
<li><a href="#_itemreader_interface">9.1.1.1. ItemReader Interface</a></li>
<li><a href="#_itemprocessor_interface">9.1.1.2. ItemProcessor Interface</a></li>
<li><a href="#_itemwriter_interface">9.1.1.3. ItemWriter Interface</a></li>
<li><a href="#_checkpointalgorithm_interface">9.1.1.4. CheckpointAlgorithm Interface</a></li>
</ul>
</li>
<li><a href="#_batchlet_interface">9.1.2. Batchlet Interface</a></li>
</ul>
</li>
<li><a href="#_listeners">9.2. Listeners</a>
<ul class="sectlevel3">
<li><a href="#_joblistener_interface">9.2.1. JobListener Interface</a></li>
<li><a href="#_steplistener_interface">9.2.2. StepListener Interface</a></li>
<li><a href="#_chunklistener_interface">9.2.3. ChunkListener Interface</a></li>
<li><a href="#_itemreadlistener_interface">9.2.4. ItemReadListener Interface</a></li>
<li><a href="#_itemprocesslistener_interface">9.2.5. ItemProcessListener Interface</a></li>
<li><a href="#_itemwritelistener_interface">9.2.6. ItemWriteListener Interface</a></li>
<li><a href="#_skip_listener_interfaces">9.2.7. Skip Listener Interfaces</a></li>
<li><a href="#_retrylistener_interface">9.2.8. RetryListener Interface</a></li>
</ul>
</li>
<li><a href="#_batch_properties">9.3. Batch Properties</a>
<ul class="sectlevel3">
<li><a href="#_batchproperty">9.3.1. @BatchProperty</a></li>
<li><a href="#_scope_of_property_definitions_for_batchproperty_injection">9.3.2. Scope of property definitions for @BatchProperty Injection</a></li>
</ul>
</li>
<li><a href="#_batch_contexts">9.4. Batch Contexts</a>
<ul class="sectlevel3">
<li><a href="#_batch_contexts_2">9.4.1. Batch Contexts</a>
<ul class="sectlevel4">
<li><a href="#_batch_context_lifecycle_and_scope">9.4.1.1. Batch Context Lifecycle and Scope</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_parallelization">9.5. Parallelization</a>
<ul class="sectlevel3">
<li><a href="#_partitionmapper_interface">9.5.1. PartitionMapper Interface</a></li>
<li><a href="#_partitionreducer_interface">9.5.2. PartitionReducer Interface</a></li>
<li><a href="#_partitioncollector_interface">9.5.3. PartitionCollector Interface</a></li>
<li><a href="#_partitionanalyzer_interface">9.5.4. PartitionAnalyzer Interface</a></li>
</ul>
</li>
<li><a href="#_decider_interface">9.6. Decider Interface</a></li>
<li><a href="#_transactionality">9.7. Transactionality</a></li>
</ul>
</li>
<li><a href="#_batch_runtime_specification">10. Batch Runtime Specification</a>
<ul class="sectlevel2">
<li><a href="#_batch_properties_reserved_namespace">10.1. Batch Properties Reserved Namespace</a></li>
<li><a href="#_job_metrics">10.2. Job Metrics</a></li>
<li><a href="#_job_runtime_identifiers">10.3. Job Runtime Identifiers</a></li>
<li><a href="#_joboperator_2">10.4. JobOperator</a></li>
<li><a href="#_batch_artifact_loading">10.5. Batch Artifact Loading</a></li>
<li><a href="#_job_xml_loading">10.6. Job XML Loading</a></li>
<li><a href="#_application_packaging_model">10.7. Application Packaging Model</a>
<ul class="sectlevel3">
<li><a href="#_meta_infbatch_xml">10.7.1. <code>META-INF/batch.xml</code></a></li>
<li><a href="#_meta_infbatch_jobs">10.7.2. <code>META-INF/batch-jobs</code></a></li>
</ul>
</li>
<li><a href="#_restart_processing">10.8. Restart Processing</a>
<ul class="sectlevel3">
<li><a href="#_job_parameters_on_restart">10.8.1. Job Parameters on Restart</a></li>
<li><a href="#_job_xml_substitution_during_restart">10.8.2. Job XML Substitution during Restart</a></li>
<li><a href="#_execution_sequence_on_restart_overview">10.8.3. Execution Sequence on Restart – Overview</a></li>
<li><a href="#_execution_sequence_on_restart_detailed_rules">10.8.4. Execution Sequence on Restart – Detailed Rules</a></li>
<li><a href="#_partitionmapper_on_restart">10.8.5. PartitionMapper on Restart</a>
<ul class="sectlevel4">
<li><a href="#_partitionsoverride_false">10.8.5.1. partitionsOverride = False</a>
<ul class="sectlevel5">
<li><a href="#_number_of_partitions_must_be_same">10.8.5.1.1. Number of Partitions Must Be Same</a></li>
<li><a href="#_partition_properties_populated_from_current_plan">10.8.5.1.2. Partition Properties Populated From Current Plan</a></li>
<li><a href="#_numbering_of_partitions_via_partition_properties">10.8.5.1.3. "Numbering" of Partitions via Partition Properties</a></li>
</ul>
</li>
<li><a href="#_partitionsoverride_true">10.8.5.2. partitionsOverride = True</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_supporting_classes">10.9. Supporting Classes</a>
<ul class="sectlevel3">
<li><a href="#_jobcontext">10.9.1. JobContext</a></li>
<li><a href="#_stepcontext">10.9.2. StepContext</a></li>
<li><a href="#_metric">10.9.3. Metric</a></li>
<li><a href="#_partitionplan">10.9.4. PartitionPlan</a></li>
<li><a href="#_batchruntime">10.9.5. BatchRuntime</a></li>
<li><a href="#_batchstatus">10.9.6. BatchStatus</a></li>
<li><a href="#_joboperator_3">10.9.7. JobOperator</a></li>
<li><a href="#_jobinstance_2">10.9.8. JobInstance</a></li>
<li><a href="#_jobexecution_2">10.9.9. JobExecution</a></li>
<li><a href="#_stepexecution_2">10.9.10. StepExecution</a></li>
<li><a href="#_batch_exception_classes">10.9.11. Batch Exception Classes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_job_runtime_lifecycle">11. Job Runtime Lifecycle</a>
<ul class="sectlevel2">
<li><a href="#_batch_artifact_lifecycle">11.1. Batch Artifact Lifecycle</a></li>
<li><a href="#_job_repository_artifact_lifecycle">11.2. Job Repository Artifact Lifecycle</a></li>
<li><a href="#_job_processsing">11.3. Job Processsing</a></li>
<li><a href="#_regular_batchlet_processsing">11.4. Regular Batchlet Processsing</a></li>
<li><a href="#_partitioned_batchlet_processsing">11.5. Partitioned Batchlet Processsing</a></li>
<li><a href="#_regular_chunk_processing">11.6. Regular Chunk Processing</a></li>
<li><a href="#_partitioned_chunk_processing">11.7. Partitioned Chunk Processing</a></li>
<li><a href="#_chunk_with_listeners_except_retrylistener">11.8. Chunk with Listeners (except RetryListener)</a></li>
<li><a href="#_chunk_with_retrylistener">11.9. Chunk with RetryListener</a></li>
<li><a href="#_chunk_with_custom_checkpoint_processing">11.10. Chunk with Custom Checkpoint Processing</a></li>
<li><a href="#_split_processing">11.11. Split Processing</a></li>
<li><a href="#_flow_processing">11.12. Flow Processing</a></li>
<li><a href="#_stop_processing">11.13. Stop Processing</a></li>
</ul>
</li>
<li><a href="#_batch_xml_xsd">12. Batch XML XSD</a></li>
<li><a href="#_job_specification_language_2">13. Job Specification Language</a>
<ul class="sectlevel2">
<li><a href="#_validation_rules">13.1. Validation Rules</a></li>
<li><a href="#_jsl_xsd">13.2. JSL XSD</a></li>
</ul>
</li>
<li><a href="#_credits">14. Credits</a></li>
<li><a href="#_change_log">15. Change Log</a>
<ul class="sectlevel2">
<li><a href="#_version_1_0_revision_a_maintenance_release">15.1. Version 1.0 Revision A - Maintenance Release</a>
<ul class="sectlevel3">
<li><a href="#_issues_list">15.1.1. Issues List</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction_to_jsr_352">5. Introduction to JSR 352</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Batch processing is a pervasive workload pattern, expressed by a distinct application organization and execution model. It is found across virtually every industry, applied to such tasks as statement generation, bank postings, risk evaluation, credit score calculation, inventory management, portfolio optimization, and on and on. Nearly any bulk processing task from any business sector is a candidate for batch processing.</p>
</div>
<div class="paragraph">
<p>Batch processing is typified by bulk-oriented, non-interactive, background execution. Frequently long-running, it may be data or computationally intensive, execute sequentially or in parallel, and may be initiated through various invocation models, including ad hoc, scheduled, and on-demand.</p>
</div>
<div class="paragraph">
<p>Batch applications have common requirements, including logging, checkpointing, and parallelization. Batch workloads have common requirements, especially operational control, which allow for initiation of, and interaction with, batch instances; such interactions include stop and restart.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_applicability_of_specification">6. Applicability of Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This specification applies to Java SE and Java EE environments. It requires Java 6 or higher.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_domain_language_of_batch">7. Domain Language of Batch</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To any experienced batch architect, the overall concepts of batch
processing used by JSR 352 should be familiar and comfortable. There are
"Jobs" and "Steps" and developer supplied processing units called
ItemReaders and ItemWriters. However, because of the JSR 352 operations,
callbacks, and idioms, there are opportunities for the following:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>significant improvement in adherence to a clear separation of
concerns</p>
</li>
<li>
<p>clearly delineated architectural layers and services provided as
interfaces</p>
</li>
<li>
<p>significantly enhanced extensibility</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The diagram below is a simplified version of the batch reference
architecture that has been used for decades. It provides an overview of
the components that make up the domain language of batch processing.
This architecture framework is a blueprint that has been proven through
decades of implementations on the last several generations of platforms
(COBOL/Mainframe, C/Unix, and now Java/anywhere). JCL and COBOL
developers are likely to be as comfortable with the concepts as C, C#
and Java developers. JSR 352 specifies the layers, components and
technical services commonly found in robust, maintainable systems used
to address the creation of simple to complex batch applications.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/image003.png" alt="image">
</div>
</div>
<div class="paragraph">
<p>The diagram above highlights the key concepts that make up the domain
language of batch. A Job has one to many steps, which has no more than
one ItemReader, ItemProcessor, and ItemWriter. A job needs to be
launched (JobOperator), and meta data about the currently running
process needs to be stored (JobRepository).</p>
</div>
<div class="sect2">
<h3 id="_job">7.1. Job</h3>
<div class="paragraph">
<p>A Job is an entity that encapsulates an entire batch process. A Job
will be wired together via a Job Specification Language. However, Job is
just the top of an overall hierarchy:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/image005.png" alt="http://static.springsource.org/spring-batch/trunk/reference/html-single/images/job-heirarchy.png">
</div>
</div>
<div class="paragraph">
<p>With JSR 352, a Job is simply a container for Steps. It combines
multiple steps that belong logically together in a flow and allows for
configuration of properties global to all steps, such as restartability.
The job configuration contains:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The simple name of the job</p>
</li>
<li>
<p>Definition and ordering of Steps</p>
</li>
<li>
<p>Whether or not the job is restartable</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_jobinstance">7.1.1. JobInstance</h4>
<div class="paragraph">
<p>A JobInstance refers to the concept of a logical job run. Let&#8217;s consider
a batch job that should be run once at the end of the day, such as the
'EndOfDay' job from the diagram above. There is one 'EndOfDay' Job, but
each individual run of the Job must be tracked separately. In the case
of this job, there will be one logical JobInstance per day. For example,
there will be a January 1st run, and a January 2nd run. If the January
1st run fails the first time and is run again the next day, it is still
the January 1st run. Usually this corresponds with the data it is
processing as well, meaning the January 1st run processes data for
January 1st, etc. Therefore, each JobInstance can have multiple
executions (JobExecution is discussed in more detail below); one or many
JobInstances corresponding to a particular Job can be running at a given
time.</p>
</div>
<div class="paragraph">
<p>The definition of a JobInstance has absolutely no bearing on the data
that will be loaded. It is entirely up to the ItemReader implementation
used to determine how data will be loaded. For example, in the EndOfDay
scenario, there may be a column on the data that indicates the
'effective date' or 'schedule date' to which the data belongs. So, the
January 1st run would only load data from the 1st, and the January 2nd
run would only use data from the 2nd. Because this determination will
likely be a business decision, it is left up to the ItemReader to
decide. What using the same JobInstance will determine, however, is
whether or not the 'state' from previous executions will be available to
the new run. Using a new JobInstance will mean 'start from the
beginning' and using an existing instance will generally mean 'start
from where you left off'.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jobparameters">7.1.2. JobParameters</h4>
<div class="paragraph">
<p>Job parameters can be specified each time a job is started or restarted.
Job parameters are keyword/value string pairs. The JobOperator start and
restart operations support the specification of job parameters. See
section <a href="#_joboperator_2">10.4</a> for further details on JobOperator.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jobexecution">7.1.3. JobExecution</h4>
<div class="paragraph">
<p>A JobExecution refers to the technical concept of a single attempt to
run a Job. Each time a job is started or restarted, a new JobExecution
is created, belonging to the same JobInstance.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step">7.2. Step</h3>
<div class="paragraph">
<p>A Step is a domain object that encapsulates an independent, sequential
phase of a batch job. Therefore, every Job is composed entirely of one
or more steps. A Step contains all of the information necessary to
define and control the actual batch processing. This is a necessarily
vague description because the contents of any given Step are at the
discretion of the developer writing it. A Step can be as simple or
complex as the developer desires. A simple Step might load data from a
file into the database, requiring little or no code, depending upon the
implementations used. A more complex Step may have complicated business
rules that are applied as part of the processing. As with Job, a Step
has an individual StepExecution that corresponds with a unique
JobExecution:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/image007.png" alt="http://static.springsource.org/spring-batch/trunk/reference/html-single/images/jobHeirarchyWithSteps.png">
</div>
</div>
<div class="sect3">
<h4 id="_stepexecution">7.2.1. StepExecution</h4>
<div class="paragraph">
<p>A StepExecution represents a single attempt to execute a Step. A new
StepExecution will be created each time a Step is run, similar to
JobExecution. However, if a step fails to execute because the step
before it fails, there will be no execution persisted for it. A
StepExecution will only be created when its Step is actually started.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_joboperator">7.3. JobOperator</h3>
<div class="paragraph">
<p>JobOperator provides an interface to manage all aspects of job
processing, including operational commands, such as start, restart, and
stop, as well as job repository related commands, such as retrieval of
job and step executions. See section <a href="#_joboperator_2">10.4</a> for more details about
JobOperator.</p>
</div>
</div>
<div class="sect2">
<h3 id="_job_repository">7.4. Job Repository</h3>
<div class="paragraph">
<p>A job repository holds information about jobs currently running and
jobs that have run in the past. The JobOperator interface provides
access to this repository. The repository contains job instances, job
executions, and step executions. For further information on this
content, see sections 10.9.8, 10.9.9, 10.9.10, respectively.</p>
</div>
<div class="paragraph">
<p>Note the implementation of the job repository is outside the scope of
this specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="_itemreader">7.5. ItemReader</h3>
<div class="paragraph">
<p>ItemReader is an abstraction that represents the retrieval of input for
a Step, one item at a time. An ItemReader provides an indicator when it
has exhausted the items it can supply. See section 9.1.1.1 for more
details about ItemReaders.</p>
</div>
</div>
<div class="sect2">
<h3 id="_itemwriter">7.6. ItemWriter</h3>
<div class="paragraph">
<p>ItemWriter is an abstraction that represents the output of a Step, one
batch or chunk of items at a time. Generally, an item writer has no
knowledge of the input it will receive next, only the item that was
passed in its current invocation. See section 9.1.1.3 for more details
about ItemWriters.</p>
</div>
</div>
<div class="sect2">
<h3 id="_itemprocessor">7.7. ItemProcessor</h3>
<div class="paragraph">
<p>ItemProcessor is an abstraction that represents the business processing
of an item. While the ItemReader reads one item, and the ItemWriter
writes them, the ItemProcessor provides access to transform or apply
other business processing. See section 9.1.1.2 for more details about
ItemProcessors.</p>
</div>
</div>
<div class="sect2">
<h3 id="_chunk_oriented_processing">7.8. Chunk-oriented Processing</h3>
<div class="paragraph">
<p>JSR 352 specifies a 'Chunk Oriented' processing style as its primary
pattern. Chunk oriented processing refers to reading the data one item
at a time, and creating 'chunks' that will be written out, within a
transaction boundary. One item is read in from an ItemReader, handed to
an ItemProcessor, and aggregated. Once the number of items read equals
the commit interval, the entire chunk is written out via the ItemWriter,
and then the transaction is committed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/image009.png" alt="http://static.springsource.org/spring-batch/trunk/reference/html-single/images/chunk-oriented-processing.png">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_batch_checkpoints">7.9. Batch Checkpoints</h3>
<div class="paragraph">
<p>For data intensive batch applications - particularly those that may run
for long periods of time - checkpoint/restart is a common design
requirement. Checkpoints allow a step execution to periodically bookmark
its current progress to enable restart from the last point of
consistency, following a planned or unplanned interruption.</p>
</div>
<div class="paragraph">
<p>Checkpoints work naturally with chunk-oriented processing. The end of
processing for each chunk is a natural point for taking a checkpoint.</p>
</div>
<div class="paragraph">
<p>JSR 352 specifies runtime support for checkpoint/restart in a generic
way that can be exploited by any chunk-oriented batch step that has this
requirement.</p>
</div>
<div class="paragraph">
<p>Since progress during a step execution is really a function of the
current position of the input/output data, natural placement of function
suggests the knowledge for saving/restoring current position is a
reader/writer responsibility.</p>
</div>
<div class="paragraph">
<p>Since managing step execution is a runtime responsibility, the batch
runtime must necessarily understand step execution lifecycle, including
initial start, execution end states, and restart.</p>
</div>
<div class="paragraph">
<p>Since checkpoint frequency has a direct effect on lock hold times, for
lockable resources, tuning checkpoint interval size can have a direct
bearing on overall system throughput.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_job_specification_language">8. Job Specification Language</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Job Specification Language (JSL) specifies a job, its steps, and
directs their execution. The JSL for JSR 352 is implemented with XML and
will be henceforth referred to as "Job XML".</p>
</div>
<div class="sect2">
<h3 id="_job_2">8.1. Job</h3>
<div class="paragraph">
<p>The 'job' element identifies a job.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;job id="{name}" restartable="{true|false}"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the logical <em>name</em> of the job and is used for
identification purposes. It must be a valid XML string value. This is a
required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">restartable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies whether or not this job is restartable . It must
specify <em>true</em> or <em>false</em>. This is an optional attribute. The default is
<em>true.</em></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_job_level_listeners">8.1.1. Job Level Listeners</h4>
<div class="paragraph">
<p>Job level listeners may be configured to a job in order to intercept job
execution. The listener element may be specified as child element of the
job element for this purpose. Job listener is the only listener type
that may be specified as a job level listener.</p>
</div>
<div class="paragraph">
<p>Multiple listeners may be configured on a job. However, there is no guarantee of the order in which they are invoked.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;listeners&gt;
  &lt;listener ref="{name}"&gt;
  ...
 &lt;/listeners&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_job_level_exception_handling">8.1.2. Job Level Exception Handling</h4>
<div class="paragraph">
<p>Any unhandled exception thrown by a job-level listener causes the job to
terminate with a batch status of FAILED. In this context, "unhandled"
simply means an exception thrown by the listener back to the runtime
implementation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_job_level_properties">8.1.3. Job Level Properties</h4>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the job
element. It is used to expose properties to any batch artifact belonging
to the job and also to the batch runtime. Any number of properties may
be specified. Job level properties are available through the JobContext
runtime object. See section <a href="#_batch_contexts">9.4</a> for further information about Job
Context.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
   &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_step_2">8.2. Step</h3>
<div class="paragraph">
<p>The 'step' element identifies a job step and its characteristics. Step
is a child element of job. A job may contain any number of steps. Each
step may be either a chunk type step or batchlet type step. See section
<a href="#_chunk">8.2.1</a> for information on chunk type steps and section <a href="#_batchlet">8.2.2</a> for
information on batchlet type steps.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;step id="{name}"
       start-limit="{integer}"
       allow-start-if-complete ="{true|false}"
       next="{flow-id|step-id|split-id|decision-id}"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the logical <em>name</em> of the step and is used for
identification purposes. It must be a valid XML string value. This is a
required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start-limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of times this step may be started or
restarted. It must be a valid XML integer value. This is an optional
attribute. The default is 0, which means no limit. If the limit is
exceeded, the job is placed in the FAILED state.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allow-start-if-complete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies whether this step is allowed to
start during job restart, even if the step completed in a previous
execution. It must be <em>true</em> or <em>false</em>. A value of <em>true</em> means the
step is allowed to restart. This is an optional attribute. The default
is <em>false</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">next</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the next step, flow, split, or decision to run after
this step is complete. It must be a valid XML string value. This is an
optional attribute. The default is this step is the last step in the job
or flow. Note: next attributes cannot be specified such that a loop
occurs among steps.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_chunk">8.2.1. Chunk</h4>
<div class="paragraph">
<p>The 'chunk' element identifies a chunk type step. It is a child element
of the step element. A chunk type step is periodically checkpointed by
the batch runtime according to a configured checkpoint policy. Items
processed between checkpoints are referred to as a "chunk". A single
call is made to the ItemWriter per chunk. Each chunk is processed in a
separate transaction. See section <a href="#_transactionality">9.7</a> for more details on
transactionality. A chunk that is not complete is restartable from its
last checkpoint. A chunk that is complete and belongs to a step
configured with allow-start-if-complete=true runs from the beginning
when restarted.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;chunk checkpoint-policy="\{item|custom}"
  item-count="{value}"
  time-limit="{value}"
  skip-limit="{value}"
  retry-limit="{value}" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">checkpoint-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the checkpoint policy that governs commit
behavior for this chunk. Valid values are: "item" or "custom". The
"item" policy means the chunk is checkpointed after a specified number
of items are processed. The "custom" policy means the chunk is
checkpointed according to a checkpoint algorithm implementation.
Specifying "custom" requires that the checkpoint-algorithm element is
also specified. See section 8.2.1.5 for checkpoint-algorithm. It is an
optional attribute. The default policy is "item".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">item-count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of items to process per chunk when
using the item checkpoint policy. It must be valid XML integer. It is an
optional attribute. The default is 10. The item-count attribute is
ignored for "custom" checkpoint policy.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">time-limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the amount of time in seconds before taking a
checkpoint for the item checkpoint policy. It must be valid XML integer.
It is an optional attribute. The default is 0, which means no limit.
When a value greater than zero is specified, a checkpoint is taken when
time-limit is reached or item-count items have been processed, whichever
comes first. The time-limit attribute is ignored for "custom" checkpoint
policy.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">skip-limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of exceptions a step will skip if any
configured skippable exceptions are thrown by chunk processing. It must
be a valid XML integer value. It is an optional attribute. The default
is no limit.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">retry-limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of times a step will retry if any
configured retryable exceptions are thrown by chunk processing. It must
be a valid XML integer value. It is an optional attribute. The default
is no limit.</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_reader">8.2.1.1. Reader</h5>
<div class="paragraph">
<p>The 'reader' element specifies the item reader for a chunk step. It is a
child element of the 'chunk' element. A chunk step must have one and
only one item reader.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;reader ref="{name}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_reader_properties">8.2.1.1.1. Reader Properties</h6>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
reader element. It is used to pass property values to a item reader. Any
number of properties may be specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">  &lt;properties&gt;
    &lt;property name="{property-name}" value="{name-value}"/&gt;
  &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_processor">8.2.1.2. Processor</h5>
<div class="paragraph">
<p>The 'processor' element specifies the item processor for a chunk step.
It is a child element of the 'chunk' element. The processor element is
optional on a chunk step. Only a single processor element may be
specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;processor ref="{name}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_processor_properties">8.2.1.2.1. Processor Properties</h6>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
processor element. It is used to pass property values to a item
processor. Any number of properties may be specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_writer">8.2.1.3. Writer</h5>
<div class="paragraph">
<p>The 'writer' element specifies the item writer for a chunk step. It is a
child element of the 'chunk' element. A chunk type step must have one
and only one item writer.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;writer ref="{name}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_writer_properties">8.2.1.3.1. Writer Properties</h6>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
writer element. It is used to pass property values to a item writer. Any
number of properties may be specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_chunk_exception_handling">8.2.1.4. Chunk Exception Handling</h5>
<div class="paragraph">
<p>By default, when any batch artifact that is part of a chunk type step
throws an exception to the Batch Runtime, the job execution ends with a
batch status of FAILED. The default behavior can be overridden for a
reader, processor, or writer artifact by configuring exceptions to skip
or to retry. The default behavior can be overridden for the entire step
by configuring a transition element that matches the step&#8217;s exit
status.</p>
</div>
<div class="sect5">
<h6 id="_skipping_exceptions">8.2.1.4.1. Skipping Exceptions</h6>
<div class="paragraph">
<p>The skippable-exception-classes element specifies a set of exceptions
that chunk processing will skip. This element is a child element of the
chunk element. It applies to exceptions thrown from the reader,
processor, and writer batch artifacts of a chunk type step. It also applies
to exceptions thrown during checkpoint commit processing. A failed
commit will be treated the same as a failed write. The total number of
skips is set by the skip-limit attribute on the chunk element. See
section <a href="#_chunk">8.2.1</a> for details on the chunk element.</p>
</div>
<div class="paragraph">
<p>A given exception will be skipped if it "matches" an include child
element of the skippable-exception-classes element, though this might be
negated (and the exception not skipped) if it also "matches" an exclude
child element of skippable-exception-classes.</p>
</div>
<div class="paragraph">
<p>The behavior is determined by the "nearest superclass" in the class
hierarchy.</p>
</div>
<div class="paragraph">
<p>To elaborate, in this context, "matches" means the following: For an
include (or exclude) element C with @class attribute value T, an
exception E "matches" C when either E is of type T or E&#8217;s type is a
subclass of T.</p>
</div>
<div class="paragraph">
<p>When an exception E "matches" both one or more include and one or more
exclude elements, then there will be one type T1 among all the matching
include/exclude elements such that all other distinct matching element
types are superclasses of T1 (because of Java&#8217;s single inheritance). If
T1 only occurs in a matching include element then include (skip) this
exception. If T1 appears in a matching exclude element (even if it also
appears in a matching include element), then exclude (don&#8217;t skip) this
exception.</p>
</div>
<div class="paragraph">
<p>Optional Skip Listener batch artifacts can be configured to the step. A
Skip Listener receives control after a skippable exception is thrown by
the reader, processor, or writer. See section <a href="#_skip_listener_interfaces">9.2.7</a> for details on the
Skip Listener batch interfaces.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;skippable-exception-classes&gt;
  &lt;include class="{class name}"/&gt;
  &lt;exclude class="{class name}"/&gt;
 &lt;/skippable-exception-classes&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">include class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the class name of an exception or exception
superclass to skip. It must be a fully qualified class name. Multiple
instances of the include element may be specified. The include child
element is optional. However, when specified, the class attribute is
required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exclude class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a class name of an exception or exception
superclass to not skip. 'Exclude class' reduces the number of exceptions
eligible to skip as specified by 'include class'. It must be a fully
qualified class name. Multiple instances of the exclude element may be
specified. The exclude child element is optional. However, when
specified, the class attribute is required.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;skippable-exception-classes&gt;
  &lt;include class="java.lang.Exception"/&gt;
  &lt;exclude class="java.io.FileNotFoundException"/&gt;
 &lt;/skippable-exception-classes&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding example would skip all exceptions except
<code>java.io.FileNotFoundException</code>, (along with any subclasses of
<code>java.io.FileNotFoundException</code>).</p>
</div>
</div>
<div class="sect5">
<h6 id="_retrying_exceptions">8.2.1.4.2. Retrying Exceptions</h6>
<div class="paragraph">
<p>The retryable-exception-classes element specifies a set of exceptions
that chunk processing will retry. This element is a child element of the
chunk element. It applies to exceptions thrown from the reader,
processor, or writer batch artifacts of a chunk type step. It also
applies to exceptions thrown by checkpoint commit processing. The total
number of retry attempts is set by the retry-limit attribute on the
chunk element. See section <a href="#_chunk">8.2.1</a> for details on the chunk element.</p>
</div>
<div class="paragraph">
<p>The list of exceptions that will be retried (or not retried) is
specified in the retryable-exception-classes element on the child
include element. This list, however, may be modified using one or more
child exclude elements. The rules for deciding whether to retry or not
retry a given exception when a combination of include and exclude
elements are used are analogous to the rules described in the discussion
in section 8.2.1.4.1 for skipping exceptions.</p>
</div>
<div class="paragraph">
<p>Optional Retry Listener batch artifacts can be configured on the step. A
Retry Listener receives control after a retryable exception is thrown by
the reader, processor, or writer. See section <a href="#_retrylistener_interface">9.2.8</a> for details on the
Retry Listener batch artifact.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;retryable-exception-classes&gt;
  &lt;include class="{class name}"/&gt;
  &lt;exclude class="{class name}"/&gt;
 &lt;/retryable-exception-classes&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">include class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a class name of an exception or exception
superclass to retry. It must be a fully qualified class name. Multiple
instances of the include element may be specified. The include child
element is optional. However, when specified, the class attribute is
required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exclude class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a class name of an exception or exception
superclass to not retry. 'Exclude class' reduces the number of
exceptions eligible for retry as specified by 'include class'. It must
be a fully qualified class name. Multiple instances of the include
element may be specified. The exclude child element is optional.
However, when specified, the class attribute is required.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;retryable-exception-classes&gt;
  &lt;include class="java.io.IOException"/&gt;
  &lt;exclude class="java.io.FileNotFoundException"/&gt;
 &lt;/retryable-exception-classes&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result is that all IOExceptions except <code>FileNotFoundException</code> (and
its subclasses) would be retried.</p>
</div>
</div>
<div class="sect5">
<h6 id="_retry_and_skip_the_same_exception">8.2.1.4.3. Retry and Skip the Same Exception</h6>
<div class="paragraph">
<p>When the same exception is specified as both retryable and skippable,
retryable takes precedence over skippable during regular processing of
the chunk. While the chunk is retrying, skippable takes precedence over
retryable since the exception is already being retried.</p>
</div>
<div class="paragraph">
<p>This allows an exception to initially be retried for the entire chunk
and then skipped if it recurs. When retrying with default retry behavior
(see section 8.2.1.4.4) the skips can occur for individual items, since
the retry is done with an item-count of 1.</p>
</div>
</div>
<div class="sect5">
<h6 id="_default_retry_behavior_rollback">8.2.1.4.4. Default Retry Behavior - Rollback</h6>
<div class="paragraph">
<p>When a retryable exception occurs, the default behavior is for the batch
runtime to rollback the current chunk and re-process it with an
item-count of 1 and a checkpoint policy of item. If the optional
ChunkListener is configured on the step, the onError method is called
before rollback. The default retry behavior can be overridden by
configuring the no-rollback-exception-classes element. See section
8.2.1.4.5 for more information on specifying no-rollback exceptions.</p>
</div>
</div>
<div class="sect5">
<h6 id="_preventing_rollback_during_retry">8.2.1.4.5. Preventing Rollback During Retry</h6>
<div class="paragraph">
<p>The no-rollback-exception-classes element specifies a list of exceptions
that override the default behavior of rollback for retryable exceptions.
This element is a child element of the chunk element. If a retryable
exception is thrown the default behavior is to rollback before retry. If
an exception is specified as both a retryable and a no-rollback
exception, then no rollback occurs and the current operation is retried.
Retry Listeners, if configured, are invoked. See section <a href="#_retrylistener_interface">9.2.8</a> for
details on the Retry Listener batch artifact.</p>
</div>
<div class="paragraph">
<p>The rules for determining whether a combination of include and exclude
child elements of no-rollback-exception-classes results in the "no
rollback" behavior or not are analogous to the rules described in the
discussion in section 8.2.1.4.1 for skipping exceptions.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;no-rollback-exception-classes&gt;
  &lt;include class="{class name}"/&gt;
  &lt;exclude class="{class name}"/&gt;
 &lt;/no-rollback-exception-classes&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">include class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a class name of an exception or exception
superclass for which rollback will not occur during retry processing. It
must be a fully qualified class name. Multiple instances of the include
element may be specified. The include child element is optional.
However, when specified, the class attribute is required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exclude class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a class name of an exception or exception
superclass for which rollback will occur during retry processing. It
must be a fully qualified class name. Multiple instances of the include
element may be specified. The exclude child element is optional.
However, when specified, the class attribute is required.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_checkpoint_algorithm">8.2.1.5. Checkpoint Algorithm</h5>
<div class="paragraph">
<p>The checkpoint-algorithm element specifies an optional custom checkpoint
algorithm. It is a child element of the chunk element. It is valid when
the chunk element checkpoint-policy attribute specifies the value
'custom'. A custom checkpoint algorithm may be used to provide a
checkpoint decision based on factors other than only number of items, or
amount of time. See section 9.1.1.4 for further information about custom
checkpoint algorithms.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;checkpoint-algorithm ref="{name}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_checkpoint_algorithm_properties">8.2.1.5.1. Checkpoint Algorithm Properties</h6>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
checkpoint algorithm element. It is used to pass property values to a
checkpoint algorithm. Any number of properties may be specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_batchlet">8.2.2. Batchlet</h4>
<div class="paragraph">
<p>The batchlet element specifies a task-oriented batch step. It is
specified as a child element of the step element. It is mutually
exclusive with the chunk element. See <a href="#_batchlet_interface">9.1.2</a> for further details about
batchlets. Steps of this type are useful for performing a variety of
tasks that are not item-oriented, such as executing a command or doing
file transfer.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;batchlet ref="{name}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_batchlet_exception_handling">8.2.2.1. Batchlet Exception Handling</h5>
<div class="paragraph">
<p>This section is superseded by section <a href="#_step_exception_handling">8.2.7</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_batchlet_properties">8.2.2.2. Batchlet Properties</h5>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
batchlet element. It is used to pass property values to a batchlet. Any
number of properties may be specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_step_level_properties">8.2.3. Step Level Properties</h4>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the step
element. It is used to expose properties to any step level batch
artifact and also to the batch runtime. Any number of properties may be
specified. Step level properties are available through the StepContext
runtime object. See section <a href="#_batch_contexts">9.4</a> for further information about
StepContext.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_step_level_listeners">8.2.4. Step Level Listeners</h4>
<div class="paragraph">
<p>Step level listeners may be configured to a job step in order to
intercept step execution. The listener element may be specified as child
element of the step element for this purpose. The following listener
types may be specified according to step type:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>chunk step - step listener, item read listener, item process listener,
item write listener, chunk listener, skip listener, and retry listener</p>
</li>
<li>
<p>batchlet step - step listener</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Multiple listeners may be configured on a step. However, there is no
guarantee of the order in which they are invoked.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;listeners&gt;
  &lt;listener ref="{name}"&gt;
  ...
 &lt;/listeners&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_step_level_listener_properties">8.2.4.1. Step Level Listener Properties</h5>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
step-level listeners element. It is used to pass property values to a
step listener. Any number of properties may be specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;listener ref="{name}"&gt;
  &lt;properties&gt;
   &lt;property name="Property1" value="Property1-Value"/&gt;
  &lt;/properties&gt;
 &lt;/listener&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_step_sequence">8.2.5. Step Sequence</h4>
<div class="paragraph">
<p>The first step, flow, or split defines the first step (flow or split) to
execute for a given Job XML. "First" means first according to order of
occurrence as the Job XML document is parsed from beginning to end. The
'next' attribute on the step, flow, or split defines what executes next.
The next attribute may specify a step, flow, split, or decision. For the
purpose of discussing transitioning it is convenient to group these four
with the term "execution elements". The next attribute is supported on
step, flow, and split elements. Steps, flows, and decisions may also
 use the "next" <em>element</em> to specify what executes
next. The next attribute and next element may not be used in a way that
allows for looping among job execution elements.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;next on="{exit status}" to="{id}" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies an exit status to match to the current next element. It
must be a valid XML string value. Wildcards of "<strong>" and "" may be used.
"</strong>" matches zero or more characters. "" matches exactly one character.
It must match an exit status value in order to have effect. This is a
required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the id of another step, split, flow, or decision, which
will execute next. It must be a valid XML string value. It must match an
id of another step, split, flow, or decision in the same job. For a step
inside a flow, the id must match another step in the same flow. This is
a required attribute.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See section  <a href="#_transition_elements">8.6</a> for more details about transition
elements and section <a href="#_transitioning_rules">8.9</a> for details on transitioning rules.</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_partitioning">8.2.6. Step Partitioning</h4>
<div class="paragraph">
<p>A batch step may run as a partitioned step. A partitioned step runs as
multiple instances of the same step definition across multiple threads,
one partition per thread. The number of partitions and the number of
threads is controlled through either a static specification in the Job
XML or through a batch artifact called a partition mapper. Each
partition needs the ability to receive unique parameters to instruct it
which data on which to operate. Properties for each partition may be
specified statically in the Job XML or through the optional partition
mapper. Since each thread runs a separate copy of the step, chunking and
checkpointing occur independently on each thread for chunk type steps.</p>
</div>
<div class="paragraph">
<p>There is an optional way to coordinate these separate units of work in a
partition reducer so that backout is possible if one or more partitions
experience failure. The PartitionReducer batch artifact provides a way
to do that. A PartitionReducer provides programmatic control over
logical unit of work demarcation that scopes all partitions of a
partitioned step.</p>
</div>
<div class="paragraph">
<p>The partitions of a partitioned step may need to share results with a
control point to decide the overall outcome of the step. The
PartitionCollector and PartitionAnalyzer batch artifact pair provide for
this need.</p>
</div>
<div class="paragraph">
<p>The 'partition' element specifies that a step is a partitioned step. The
partition element is a child element of the 'step' element. It is an
optional element.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;partition&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>The following Job XML snippet shows how to specify a partitioned step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;step id="Step1"&gt;
  &lt;chunk .../&gt; or &lt;batchlet ... /&gt;
  &lt;partition .../&gt;
 &lt;/step&gt;</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_partition_plan">8.2.6.1. Partition Plan</h5>
<div class="paragraph">
<p>A partition plan defines several configuration attributes that affect
partitioned step execution. A partition plan specifies the number of
partitions, the number of partitions to execute concurrently, and the
properties for each partition. A partition plan may be defined in a Job
XML declaratively or dynamically at runtime with a partition mapper.</p>
</div>
<div class="paragraph">
<p>The 'plan' element is a child element of the 'partition' element. The
'plan' element is mutually exclusive with partition mapper element. See
section <a href="#_partitionmapper_interface">9.5.1</a> for further details on partition mapper.</p>
</div>
<div class="paragraph">
<p>Note the specification does not attempt to guarantee order of partition
execution with respect to the order within a statically or
dynamically-defined plan.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;plan partitions="{number}" threads="{number}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partitions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the number of partitions for this partitioned
step. This is a an optional attribute. The default is 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">threads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the maximum number of threads on which to execute
the partitions of this step. Note the batch runtime cannot guarantee the
requested number of threads are available; it will use as many as it can
up to the requested maximum. This is an optional attribute. The default
is the number of partitions.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>The following Job XML snippet shows how to specify a step partitioned
into 3 partitions on 2 threads:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;step id="Step1"&gt;
   &lt;chunk .../&gt;
   &lt;partition&gt;
     &lt;plan partitions="3" threads="2"/&gt;
   &lt;/partition&gt;
 &lt;/step&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_partition_properties">8.2.6.2. Partition Properties</h5>
<div class="paragraph">
<p>When defining a statically partitioned step, it is possible to specify
unique property values to pass to each partition directly in the Job XML
using the property element. See section <a href="#_partitionmapper_interface">9.5.1</a> for further information on
partition mapper.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties partition="_partition-number_"&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">partition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the logical partition number to which the
specified properties apply. This must be a non-negative integer value,
starting at 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current
scope . It must be a valid XML string value. If
it matches a named property in the associated batch artifact, its value
is assigned to that property. If not, it is ignored. This is a required
attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>The following Job XML snippet shows a step of 2 partitions with a unique
value for the property named "filename" for each partition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;partition&gt;
  &lt;plan partitions="2"&gt;
   &lt;properties partition="0"&gt;
    &lt;property name="filename" value="/tmp/file1.txt"/&gt;
   &lt;/properties&gt;
   &lt;properties partition="1"&gt;
    &lt;property name="filename" value="/tmp/file2.txt"/&gt;
   &lt;/properties&gt;
  &lt;/plan&gt;
 &lt;/partition&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_partition_mapper">8.2.6.3. Partition Mapper</h5>
<div class="paragraph">
<p>The partition mapper provides a programmatic means for calculating the
number of partitions and threads for a partitioned step. The partition
mapper also specifies the properties for each partition. The mapper
element specifies a reference to a PartitionMapper batch artifact; see
section <a href="#_partitionmapper_interface">9.5.1</a> for further information. Note the mapper element is
mutually exclusive with the plan element.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;mapper ref="{name}"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;partition&gt;
  &lt;mapper ref="MyStepPartitioner"/&gt;
 &lt;/partition&gt;</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_mapper_properties">8.2.6.3.1. Mapper Properties</h6>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
mapper element. It is used to pass property values to a PartitionMapper
batch artifact. Any number of properties may be specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_partition_reducer">8.2.6.4. Partition Reducer</h5>
<div class="paragraph">
<p>A partitioned step may execute with an optional partition reducer. A
partition reducer provides a kind of unit of work demarcation around the
processing of the partitions. Programmatic interception of the
partitioned step&#8217;s lifecycle is possible through the partition reducer.
The reducer element specifies a reference to a PartitionReducer batch
artifact; see section <a href="#_partitionreducer_interface">9.5.2</a> for further information.</p>
</div>
<div class="paragraph">
<p>The 'reducer' element is a child element of the 'partition' element.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;reducer ref="{name}"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;partition&gt;
 &lt;reducer ref="MyStepPartitionReducer"/&gt;
 &lt;/partition&gt;</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_partition_reducer_properties">8.2.6.4.1. Partition Reducer Properties</h6>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
PartitionReducer element. It is used to pass property values to a
PartitionReducer batch artifact. Any number of properties may be
specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_partition_collector">8.2.6.5. Partition Collector</h5>
<div class="paragraph">
<p>A Partition Collector is useful for sending intermediary results for
analysis from each partition to the step&#8217;s Partition Analyzer. A
separate Partition Collector instance runs on each thread executing a
partition of the step. The collector is invoked at the conclusion of
each checkpoint for chunking type steps and again at the end of
partition; it is invoked once at the end of partition for batchlet type
steps. A collector returns a Java Serializable object, which is
delivered to the step&#8217;s Partition Analyzer. See section <a href="#_partitionanalyzer_interface">9.5.4</a> for
further information about the Partition Analyzer. The collector element
specifies a reference to a PartitionCollector batch artifact; see
section <a href="#_partitioncollector_interface">9.5.3</a> for further information.</p>
</div>
<div class="paragraph">
<p>The 'collector' element is a child element of the 'partition' element.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;collector ref="{name}"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;partition&gt;
  &lt;collector ref="MyStepCollector"/&gt;
 &lt;/partition&gt;</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_partition_collector_properties">8.2.6.5.1. Partition Collector Properties</h6>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
collector element. It is used to pass property values to a
PartitionCollector batch artifact. Any number of properties may be
specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_partition_analyzer">8.2.6.6. Partition Analyzer</h5>
<div class="paragraph">
<p>A Partition Analyzer receives intermediary results from each partition
sent via the step&#8217;s Partition Collector. A Partition analyzer runs on
the step main thread and serves as a collection point for this data. The
PartitionAnalyzer also receives control with the partition exit status
for each partition, after that partition ends. An analyzer can be used
to implement custom exit status handling for the step, based on the
results of the individual partitions. The analyzer element specifies a
reference to a PartitionAnalyzer batch artifact; see section <a href="#_partitionanalyzer_interface">9.5.4</a> for
further information.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;analyzer ref="{name}"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;partition&gt;
  &lt;analyzer ref="MyStepAnalyzer"/&gt;
 &lt;/partition&gt;</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="_partition_analyzer_properties">8.2.6.6.1. Partition Analyzer Properties</h6>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
analyzer element. It is used to pass property values to a
PartitionAnalyzer batch artifact. Any number of properties may be
specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_step_exception_handling">8.2.7. Step Exception Handling</h4>
<div class="paragraph">
<p>Any unhandled exception thrown by any step-level artifact during step
processing causes the step to terminate with a batch status of FAILED.
In this context, "unhandled" means an exception thrown by the execution
of the artifact back to the runtime implementation which does not result
in a skip or a retry as described in section 8.2.1.4.
 See section <a href="#_transitioning_precedence_rules">8.9.2</a> for complete details on
transitioning after an unhandled exception.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_flow">8.3. Flow</h3>
<div class="paragraph">
<p>A flow defines a sequence of execution elements that execute together as
a unit. When the flow is finished, it is the entire flow that
transitions to the next execution element. A flow may transition to a
step, split, decision, or another flow. A flow may contain step, flow,
decision, and split execution elements. See section <a href="#_decision">8.5</a> for more on
decisions. See section <a href="#_split">8.4</a> for more on splits. The execution elements
within a flow may only transition among themselves; they may not
transition to elements outside of the flow. A flow may also contain the
transition elements next, stop, fail, and end. See section <a href="#_transition_elements">8.6</a> for more
on transition elements.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;flow id="{name}"next="{flow-id|step-id|split-id|decision-id}"&gt;
  &lt;step&gt; ... &lt;/step&gt; ...
 &lt;/flow&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the logical <em>name</em> of the flow and is used for
identification purposes. It must be a valid XML string value. This is a
required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">next</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the next step, flow, split, or decision to run after
this step is complete. It must be a valid XML string value. This is an
optional attribute. The default is this flow is the last execution
element in the job. Note: next attributes cannot be specified such that
a loop occurs among steps.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_split">8.4. Split</h3>
<div class="paragraph">
<p>A split defines a set of flows that execute concurrently. A split may
include only flow elements as children. See section <a href="#_flow">8.3</a> for more on
flows. Each flow runs on a separate thread. The split is finished after
all flows complete. When the split is finished, it is the entire split
that transitions to the next execution element. A split may transition
to a step, flow, decision, or another split.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;split id="{name}"next="{flow-id|step-id|split-id|decision-id}"&gt;
  &lt;flow&gt; ... &lt;/flow&gt;
  ...
 &lt;/split&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the logical <em>name</em> of the split and is used for
identification purposes. It must be a valid XML string value. This is a
required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">next</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the next step, flow, split, or decision to run after
this step is complete. It must be a valid XML string value. This is an
optional attribute. The default is this split is the last execution
element in the job. Note: next attributes cannot be specified such that
a loop occurs among steps.</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_split_termination_processing_incomplete">8.4.1. Split Termination Processing Incomplete</h4>
<div class="paragraph">
<p>The effort of the initial 1.0 final release specification to define
split termination processing is recognized as incomplete. This is
related to the recognition that flow transitioning is incomplete
(section <a href="#_flow_level_transitions">8.9.5</a>).</p>
</div>
<div class="paragraph">
<p>As such, there is no well-defined mechanism for "passing back" status
from the individual child flows of a split and aggregating them into a
status at the split level. There is, accordingly, no termination based
on the status of the constituent flows performed after a split
execution.</p>
</div>
<div class="paragraph">
<p>However, the implementor must be aware that a split may have a child
flow where the flow itself or a flows child (step, decision, etc.)
causes the job execution to terminate. This could be via an end, stop,
or fail transition element, or via an unhandled exception.</p>
</div>
<div class="paragraph">
<p>In such a case the job should then cease execution before transitioning
past the current, containing split, on to the next execution element.</p>
</div>
<div class="paragraph">
<p>Typically only one such element (in one single flow) would terminate job
execution, with a corresponding batch and exit status that would then be
set by the implementation as the job-level batch status and exit status,
since typically the whole split would be intended to complete.</p>
</div>
<div class="paragraph">
<p>The spec does not make an effort, then, to define the outcome if more
than one flow within a split produced a terminating status. A
suggestion, though, is that a FAILED batch status should be given
preference to STOPPED, which should be given preference to COMPLETED
status, and a natural corollary might be to bubble up the associate exit
status as the job-level exit status as well.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_decision">8.5. Decision</h3>
<div class="paragraph">
<p>A decision provides a customized way of determining sequencing among
steps, flows, and splits. The decision element may follow a step, flow,
or split. A job may contain any number of decision elements. A decision
element is the target of the "next" attribute from a job-level step,
flow, split, or another decision. A decision must supply a decider batch
artifact (see section <a href="#_decider_interface">9.6</a>). The decider&#8217;s purpose is to decide the next
transition. The decision uses any of the transition elements, stop,
fail, end, and next elements to select the next transition. See section
<a href="#_transition_elements">8.6</a> for further information on transition elements. The decider return
value will also be set as the current value of the job exit status, in
addition to being matched against the decisions own child transition
elements to decide the next transition.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;decision id="{name}" ref="{ref_-_name}"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the logical <em>name</em> of the decision and is used for
identification purposes. It must be a valid XML string value. This is a
required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ref</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a batch artifact.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;decision id="AfterFlow1" ref="MyDecider"&gt;
 ...
 &lt;/decision&gt;</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_decision_properties">8.5.1. Decision Properties</h4>
<div class="paragraph">
<p>The 'properties' element may be specified as a child element of the
decision element. It is used to pass property values to a decider. Any
number of properties may be specified.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;properties&gt;
  &lt;property name="{property-name}" value="{name-value}"/&gt;
 &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a unique property name within the current scope. It
must be a valid XML string value. If it matches a named property in the
associated batch artifact, its value is assigned to that property. If
not, it is ignored. This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the value corresponding to the named property. It must
be a valid XML string value. This is a required attribute.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_decision_exception_handling">8.5.2. Decision Exception Handling</h4>
<div class="paragraph">
<p>Any exception thrown by a batch artifact invoked during decision
handling will end the job with a batch status of FAILED. This exception
is visible to job-level listeners.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transition_elements">8.6. Transition Elements</h3>
<div class="paragraph">
<p>Transition elements may be specified in the containment scope of a step,
flow, or decision (but not a split) to direct job execution sequence or
to terminate job execution. There are fo ur
transition elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>next - directs execution flow to the next execution element.</p>
</li>
<li>
<p>fail - causes a job to end with FAILED batch status.</p>
</li>
<li>
<p>end - causes a job to end with COMPLETED batch status.</p>
</li>
<li>
<p>stop - causes a job to end with STOPPED batch status.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Fail, end, and stop are considered "terminating elements" because they
cause a job execution to terminate.</p>
</div>
<div class="sect3">
<h4 id="_next_element">8.6.1. Next Element</h4>
<div class="paragraph">
<p>The next element is used to transition execution to the next execution element.
Multiple next elements may be specified in the current containment
scope.
Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;next on="{exit status}" to="{step id_|_flow id_|_split id}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the exit status value that activates this end element. It
must be a valid XML string value. Wildcards of "<strong>" and "" may be used.
"</strong>" matches zero or more characters. "" matches exactly one character.
It must match an exit status value in order to have effect. This is a
required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the execution element  to which
to transition after this decision. It must be a valid XML string value.
This is a required attribute. Note: the to value cannot specify the next
execution element such that a loop occurs in the batch job.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;step id="Step1"&gt;
 &lt;next on="*" to="Step2"/&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fail_element">8.6.2. Fail Element</h4>
<div class="paragraph">
<p>The fail element is used to terminate the job at the conclusion of the
current step or flow. The job  batch status is
set to FAILED. This does not, however, directly affect the batch status
of the step containing the fail element.
 Multiple fail elements may be specified in the
current containment scope. The fail element is supported as a child of
the step, flow, and decision elements.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;fail on="{exit status}" exit-status="{exit status}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the exit status value that activates this fail element.
It must be a valid XML string value. Wildcards of "<strong>" and "" may be
used. "</strong>" matches zero or more characters. "" matches exactly one
character. It must match an exit status value in order to have effect.
This is a required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exit-status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the new exit status for the job. It
 must be a valid XML string value. This is an
optional attribute. If not specified, the job-level exit status is
unchanged. This attribute does not directly change any step exit status
(particularly the step which contains  this
fail element).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;step id="Step1"&gt;
 &lt;fail on="FAILED" exit-status="EARLY COMPLETION"/&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_end_element">8.6.3. End Element</h4>
<div class="paragraph">
<p>The end element is used to terminate the job at the current step. The
job  batch status is set to COMPLETED. This does
not, however, directly affect the batch status of the step containing
the  end element. Multiple end elements may be
specified in the current containment scope. The end element is supported
as a child of the step, flow, and decision elements.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;end on="{exit status}" exit-status="{exit status}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the exit status value that activates this end element. It
must be a valid XML string value. Wildcards of "<strong>" and "" may be used.
"</strong>" matches zero or more characters. "" matches exactly one character.
It must match an exit status value in order to have effect. This is a
required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exit-status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the new exit status for the job. It
 must be a valid XML string value. This is an
optional attribute. If not specified, the job-level exit status is
unchanged. This attribute does not directly change any step exit status
(particularly the step which contains  this end
element).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;step id="Step1"&gt;
  &lt;end on="COMPLETED" exit-status="EARLY COMPLETION"&gt;
 &lt;/step&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_stop_element">8.6.4. Stop Element</h4>
<div class="paragraph">
<p>The stop element is used to terminate the job after the current step or
flow. If the stop element matches the exit status, the job-level batch
status is then set to STOPPED. This does not, however, directly affect
the batch status of the step containing the
 .
Multiple stop elements may be specified in the current containment
scope. The stop element is supported as a child of step, flow, and
decision elements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;stop on="{exit status}" exit-status="{exit status}" restart="{step id_|_flow id_|_split id}"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the exit status value that activates this end element. It
must be a valid XML string value. Wildcards of "<strong>" and "" may be used.
"</strong>" matches zero or more characters. "" matches exactly one character.
It must match an exit status value in order to have effect. This is a
required attribute.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exit-status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the exit status for the job. It
 must be a valid XML string value. This is an
optional attribute. If not specified, the job-level exit status is
unchanged. This attribute does not directly change any step exit status
(particularly the step which contains  this
stop element).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">restart</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the job-level step, flow, or split at which to
restart when the job is restarted. It must be a valid XML string value.
This is an optional attribute.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;step id="Step1"&gt;
  &lt;stop on="COMPLETED" restart="step2"/&gt;
 &lt;/step&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_batch_and_exit_status">8.7. Batch and Exit Status</h3>
<div class="paragraph">
<p>Batch execution reflects a sequence of state changes, culminating in an
end state after a job has terminated. These state changes apply to the
entire job as a whole, as well as to each step within the job. These
state changes are exposed through the programming model as status
values. There is both a runtime status value, called "batch status", as
well as a user-defined value, called "exit status".</p>
</div>
<div class="paragraph">
<p>A job and each step in a job end with a batch status and exit status
value. Batch status is set by the batch runtime; exit status may be set
through the Job XML or by the batch application. The exit status for a
job  and a step will be initially set to null.
At the time that the job or step completes execution, if the exit status
is equal to null, it will then be set by the runtime implementation
 to the string value of the batch status, which
will be its final value. The batch and exit status values are available
in the JobContext and StepContext runtime objects, and the exit status
can be set explicitly via any batch artifact. The overall batch and exit
status for the job are available through the JobOperator interface.
Batch and exit status values are strings. The following batch status
values are defined:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Meaning</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STARTING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch job has been passed to the batch runtime for execution through the JobOperator interface start or restart operation. A step has a status of STARTING before it actually begins execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STARTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch job has begun execution by the batch runtime. A step has a status of STARTED once it has begun execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STOPPING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch job has been requested to stop through the JobOperator interface
stop operation or by a &lt;stop&gt; element in the Job XML. A step has a
status of STOPPING as soon as JobOperator.stop receives control.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STOPPED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch job has been stopped through the JobOperator interface stop
operation or by a &lt;stop&gt; element in the Job XML. A step has a status of
STOPPED once it has actually been stopped by the batch runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch job has ended due to an unresolved exception or by a &lt;fail&gt;
element in the Job XML. A step has a status of FAILED under the same
conditions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMPLETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch job has ended normally or by an &lt;end&gt; element in the Job XML. A
step has a status of COMPLETED under the same conditions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ABANDONED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Batch job has been marked abandoned through the JobOperator interface
abandon operation. An abandoned job is still visible through the
JobOperator interface, but is not running, nor can it be restarted. It
exists only as a matter of history.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A job execution will end under the following conditions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A job-level execution element (step, flow, or split) finishes
execution, without specifying a "next" attribute and without the exit
status matching any transition elements. (See section <a href="#_transitioning_precedence_rules">8.9.2</a> for
details).  In this case, the batch status is set
to COMPLETED.</p>
</li>
<li>
<p>A step throws an exception to the batch runtime that does not match
skip or retry criteria, with the exit status not matching any transition
elements. In this case, the batch status is set to FAILED. (See section
<a href="#_transitioning_precedence_rules">8.9.2</a> for details).  In the case of partitioned
or concurrent (split) step execution, all other still-running parallel
instances are allowed to complete before the job ends with FAILED batch
status.</p>
</li>
<li>
<p>A step, flow, or decision terminates execution with a stop, end, or
fail element. In this case, the batch status is STOPPED, COMPLETED, or
FAILED, respectively .</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The batch and exit status of the job is set as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Batch status is initially set to STARTING by the batch runtime.
Immediately before starting the first step, the batch runtime sets the
batch status to STARTED .</p>
</li>
<li>
<p>Exit status can be overridden by any artifact by invoking the exit
status setter method on the JobContext object.</p>
</li>
<li>
<p>Exit status can be overridden by a decision element.</p>
</li>
<li>
<p>Exit status can be overridden by a terminating transition element on
a step, flow, or split. See section <a href="#_transition_elements">8.6</a>.</p>
</li>
<li>
<p>Final batch status is set by the batch runtime depending on the
outcome of the job. See table above. Exit status is set to the final
batch status if it was not overridden by any of the override means
described earlier in this list. Note the last override to set exit
status during the course of job execution takes precedence over all
others.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In addition to  these conditions and events
which are well-defined by this specification, it is also recognized that
the runtime may be forced to make another transition of job and step
batch status.</p>
</div>
<div class="paragraph">
<p>For example, a JVM hang may cause a job to appear in STARTED state even
though it is no longer running. The specification forbids running
multiple executions of a given job instance at the same time. In order
to recover and allow restart it is expect that a batch runtime
implementation might provide a mechanism to automatically or through
user intervention mark the appropriate job and step execution(s) as
FAILED (i.e. set the batch status as FAILED).</p>
</div>
<div class="paragraph">
<p>The details are left entirely to the implementation, we are just
recognizing here that this is a valid state transition.</p>
</div>
<div class="sect3">
<h4 id="_batch_and_exit_status_for_steps">8.7.1. Batch and Exit Status for Steps</h4>
<div class="paragraph">
<p>Step batch status is set initially, and then again at the conclusion of
the step, by the batch runtime. <span class="line-through">Step exit status is
initially set to the same value as batch
status.</span>  Step exit status may be set by any
batch artifact configured to the step by invoking the exit status setter
method in the StepContext object. See section <a href="#_batch_contexts">9.4</a> for further
information about the StepContext object. Setting the step exit status
does not alter the execution of the current step, but rather, is
available to influence the execution of subsequent steps via transition
elements (see <a href="#_transition_elements">8.6</a>) and deciders (see <a href="#_decider_interface">9.6</a>). If no batch artifact sets the
exit status, the batch runtime will default the value to the string form
of the batch status value of the step when step execution completes.
An important point to note is that transition elements do not affect the
batch and exit status of their containing step (for a step with one or
more child transition elements), but only potentially affect the batch
and exit status of the job.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;step id="FS1"&gt;
 &lt;batchlet &gt;
  &lt;next on="RC0" /&gt;
  &lt;fail on="RC4" exit-status="BAD"/&gt;
  &lt;fail on="RC8" /&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Suppose for the above example JSL snippet, FS1s batchlet executes
normally with an exit status of "RC4". Then step FS1s batch status will
end up as COMPLETED, and FS1s exit status will end up as "RC4". The jobs
batch status will end up as FAILED and the jobs exit status will end up
as "BAD". Likewise, if the batchlet completes with an exit status of
"RC8" the steps batch and exit status will be COMPLETED and "RC8",
respectively, while the jobs batch and exit status will be FAILED and
"FAILED" (assuming the job exit status hasnt been set and defaults in
this case).</p>
</div>
<div class="paragraph">
<p>Note the implications for restart processing. For example, a completed
step wont re-run just because the step includes a transition element
failing the job on the original step executions exit status. See section
<a href="#_supporting_classes">10.8</a> for more on restart processing.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exit_status_for_partitioned_steps">8.7.2. Exit Status for Partitioned Steps</h4>
<div class="paragraph">
<p>The exit status for a partitioned step follows the same rules as for a
regular step except for an exit status set by batch artifacts processing
individual partitions . This means any batch
artifact running on the main thread of the partitioned step can set the
steps exit status via the exit status setter method on the StepContext
object , the same as for a non-partitioned step.E.g. a steps partition
analyzer, partition reducer, or step listener could each potentially set
the steps exit status in this simple manner (since each of these
artifacts run on the initial thread, not the threads processing an
individual partition). If the exit status is not set it defaults to
batch status at the end of step execution , the
same as for a non-partitioned step.</p>
</div>
<div class="paragraph">
<p>For a partitioned batchlet, each thread processing a partition may
return a separate exit status. However, these exit status values are
ignored unless a partition analyzer is used to coalesce these separate
exit status values into a final exit status value for the step.</p>
</div>
<div class="paragraph">
<p>The batch runtime maintains a StepContext clone per partition. For a
partitioned batchlet or chunk, any batch artifact running on any of the
threads processing a partition would merely set a separate exit status
through the StepContext clone. These exit status values are ignored
unless a partition analyzer is used to coalesce these separate exit
status values into a final exit status value for the step.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_job_xml_substitution">8.8. Job XML Substitution</h3>
<div class="paragraph">
<p>Job XML supports substitution as part of any attribute value. The
following expression language is supported on all attributes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;attribute-value&gt; ::= ' " ' &lt;principle-value-expression&gt;[&lt;default-expression&gt;] ' " '

&lt;principle-value-expression&gt; ::= &lt;value-expression&gt;

&lt;value-expression&gt; ::= "#\{"&lt;operator-expression&gt;"}" | &lt;string-literal&gt;[ &lt;value-expression&gt; ]

&lt;default-expression&gt; ::= ":" &lt;value-expression&gt; ";"

&lt;operator-expression&gt; ::= &lt;operator1&gt; | &lt;operator2&gt; | &lt;operator3&gt; |&lt;operator4&gt; | &lt;operator5&gt;

&lt;operator1&gt; ::= "jobParameters" "[" &lt;target-name&gt; "]"

&lt;operator2&gt; ::= "jobProperties" "[" &lt;target-name&gt; "]"

&lt;operator3&gt; ::= "systemProperties" "[" &lt;target-name&gt; "]"

&lt;operator4&gt; ::= "partitionPlan" "[" &lt;target-name&gt; "]"

&lt;target-name&gt; ::= " ' " &lt;string-literal&gt; " ' "

&lt;string-literal&gt; is a valid XML string value.</pre>
</div>
</div>
<div class="sect3">
<h4 id="_substitution_processing_rules">8.8.1. Substitution Processing Rules</h4>
<div class="paragraph">
<p>Substitution expressions are processed for both initial job start and on
job restart. All substitution expressions must be resolved before the
job can be started or restarted, except for the partitionPlan operator,
which has deferred resolution - see section 8.8.1.4 for more on that.
After substitution expression resolution, the resultant XML document
must be checked for validity, according to the guidelines outlined in
section <a href="#_job_specification_language_2">13</a>, Job Specification Language XSD.</p>
</div>
<div class="paragraph">
<p>A substitution expression may reference a job parameter or a job
property by specifying the name of the parameter or property through a
substitution expression operator. This name is referred to generally in
substitution expression syntax as a "target name". There are four
substitution operators:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>jobParameters - specifies to use a named parameter from the job
parameters.</p>
</li>
<li>
<p>jobProperties - specifies to use a named property from among the
job&#8217;s properties.</p>
</li>
<li>
<p>systemProperties - specifies to use a named property from the system
properties.</p>
</li>
<li>
<p>partitionPlan - specifies to use a named property from the partition
plan of a partitioned step.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="_jobparameters_substitution_operator">8.8.1.1. jobParameters Substitution Operator</h5>
<div class="paragraph">
<p>The jobParameters substitution operator resolves to the value of the
job parameter with the specified target name.</p>
</div>
</div>
<div class="sect4">
<h5 id="_jobproperties_substitution_operator">8.8.1.2. jobProperties Substitution Operator</h5>
<div class="paragraph">
<p>The jobProperties substitution operator resolves to the value of the
job property with the specified target name. This property is found by
recursively searching from the innermost containment scope (this
includes earlier properties within the current scope) to the outermost
scope until a property with the specified target name is found.</p>
</div>
<div class="paragraph">
<p>E.g. The batch runtime would attempt resolution of the jobProperties
operator specification in each of the two following reader property
definitions by first searching for earlier property definitions within
the reader properties collection, then the step properties collection
(there are none in this example), then the job properties collection (if
any). The search stops at the first occurrence of the specified target
name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;job id="job1"&gt;
  &lt;properties&gt;
   &lt;property name="filestem" value="postings"/&gt;
   &lt;property name="outputlog" value="jobmessages"/&gt;
 &lt;/properties&gt;
 &lt;step id="step1"&gt;
  &lt;chunk&gt;
    &lt;reader ref="MyReader"&gt;
     &lt;properties&gt;
      &lt;property name="infile.name" value="#\{jobProperties['filestem']}.txt"/&gt;
      &lt;property name="outputlog" value="readermessages"/&gt;
      &lt;property name="outfile.name" value="#\{jobProperties['outputlog']}.txt"/&gt;
     &lt;/properties&gt;
    &lt;/reader&gt;
  &lt;/chunk&gt;
 &lt;/step&gt;
&lt;/job&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resolved value for reader property "infile.name" would be
"postings.txt".</p>
</div>
<div class="paragraph">
<p>The resolved value for reader property "outfile.name" would be
"readermessages.txt".</p>
</div>
</div>
<div class="sect4">
<h5 id="_systemproperties_substitution_operator">8.8.1.3. systemProperties Substitution Operator</h5>
<div class="paragraph">
<p>The systemProperties substitution operator resolves to the value of the
system property with the specified target name.</p>
</div>
</div>
<div class="sect4">
<h5 id="_partitionplan_substitution_operator">8.8.1.4. partitionPlan Substitution Operator</h5>
<div class="paragraph">
<p>The partitionPlan substitution operator resolves to the value of the
partition plan property with the specified target name from the
PartitionPlan returned by the PartitionMapper. Partition plan properties
are in scope only for the step to which the partition plan is defined.
The partitionPlan operator is resolved separately for each partition
before the partition execution begins.</p>
</div>
<div class="paragraph">
<p>E.g. Given job, job1:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;job id="job1"&gt;
 &lt;step id="step1"&gt;
  &lt;chunk&gt;
   &lt;reader  ref="MyReader&gt;
    &lt;properties&gt;
     &lt;property name="infile.name" value="file#\{partitionPlan['myPartitionNumber']}.txt"/&gt;
     &lt;property name="outfile.name" value="#\{partitionPlan['outFile']}"/&gt;
    &lt;/properties&gt;
   &lt;/reader&gt;
   &lt;writer ref="MyWriter"/&gt;
  &lt;/chunk&gt;
  &lt;partition&gt;
   &lt;mapper ref="MyMapper "/&gt;
  &lt;/partition&gt;
 &lt;/step&gt;
&lt;/job&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>And MyMapper implementation:</p>
</div>
<div id="app-listing" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public class MyMapper implements PartitionMapper \{
  public PartitionPlan mapPartitions() \{
    PartitionPlanImpl pp= new PartitionPlanImpl();
    pp.setPartitions(2);

    Properties p0= new Properties();
    p0.setProperty("myPartitionNumber", "0");
    p0.setProperty("outFile", "outFileA.txt");

    Properties p1= new Properties();
    p1.setProperty("myPartitionNumber", "1");
    p1.setProperty("outFile", "outFileB.txt");

    Properties[] partitionProperties= new Properties[2];
    partitionProperties[0]= p0;
    partitionProperties[1]= p1;
    pp.setPartitionProperties(partitionProperties);

    return pp;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The step1 chunk would run as two partitions, with the itemReader
property "infile.name" resolved to "file0.txt" and "file1.txt" for
partitions 0 and 1, respectively. Also, itemReader property
"outfile.name" would resolve to "outFileA.txt", and "outFileB.txt" for
partitions 0 and 1, respectively.</p>
</div>
</div>
<div class="sect4">
<h5 id="_substitution_expression_default">8.8.1.5. Substitution Expression Default</h5>
<div class="paragraph">
<p>Substitutions expressions may include a default value using the ":"
operator. The default is applied if the substitution&#8217;s principle value
expression resolves to the empty string "".</p>
</div>
</div>
<div class="sect4">
<h5 id="_property_resolution_rule">8.8.1.6. Property Resolution Rule</h5>
<div class="paragraph">
<p>Properties specified by a substitution operator must be defined before
they can be used in a substitution expression.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p><em>Resolvable Property Reference</em></p>
</div>
<div class="paragraph">
<p>The batch runtime will resolve a substitution reference to a property
that occurs before it is referenced. In the following example, property
"infile.name" is defined before it is used to form the value of property
"tmpfile.name". This is a resolvable reference.E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;property name="infile.name" value="in.txt" /&gt;
 &lt;property name="tmpfile.name" value="#\{jobProperties['infile.name']}.tmp" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The batch runtime resolves a resolvable reference with the resolved
value of the specified property reference.</p>
</div>
<div class="paragraph">
<p><em>Unresolvable Property Reference</em></p>
</div>
<div class="paragraph">
<p>The batch runtime will not resolve a substitution reference to a
property whose first occurrence is after it is referenced. In the
following example, property "infile.name" is defined after it is used to
form the value of property "tmpfile.name". This is a unresolvable
reference.E.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;property name="tmpfile.name" value="in.txt#\{jobProperties[infile.name]}" /&gt;
 &lt;property name="infile.name" value="in.txt" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The batch runtime resolves an unresolvable reference in XML to the
empty string "".</p>
</div>
</div>
<div class="sect4">
<h5 id="_undefined_target_name_rule">8.8.1.7. Undefined Target Name Rule</h5>
<div class="paragraph">
<p>A substitution expression operator that specifies an undefined target
name is assigned the empty string in XML.</p>
</div>
</div>
<div class="sect4">
<h5 id="_job_restart_rule">8.8.1.8. Job Restart Rule</h5>
<div class="paragraph">
<p>Job Parameters may be specified on job restart. Substitution expression
resolution occurs on each restart. This makes it possible for new values
to be used in Job XML attributes during job restart. While all
substitution expressions resolve the same way on restart as on initial
start, there is a special rule for the number of partitions in a
partitioned step:</p>
</div>
<div class="paragraph">
<p>The number of partitions in a partition plan</p>
</div>
<div class="paragraph">
<p>The batch runtime determines the number of partitions in a partitioned
step the first time the step is attempted. The batch runtime remembers
that decision and applies it to that step on the next job execution,
once the previous job execution is restarted. The decision cannot be
altered by a substitution expression. The decision can be altered,
however, through a PartitionMapper artifact by specifying the "override"
option in the PartitionPlan object. See section 10.9.4 for details on
the PartitionPlan class.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_examples">8.8.2. Examples</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">       &lt;property name="infile.name" value="in.txt" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resolved property: infile.name="in.txt"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">       &lt;property name="infile.name" value="#\{jobParameters['infile.name']}" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resolved property: infile.name= value of infile.name job parameter</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">       &lt;property name="infile.name" value="#\{systemProperties['infile.name']}" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resolved property: infile.name= value of infile.name system property</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">       &lt;property name="infile.name" value="#\{jobProperties['infile.name']}" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resolved property: infile.name= value of infile.name job property</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">       &lt;property name="infile.name" value="#\{partitionPlan['infile.name']}" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resolved property: infile.name= value of infile.name from partition
plan for the current partition</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">       &lt;property name="infile.name" value="#\{jobParameters['infile.name']}:in.txt;" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resolved property: infile.name = value of infile.name job parameter or
"in.txt" if infile.name job parameter is unspecified.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transitioning_rules">8.9. Transitioning Rules</h3>
<div class="sect3">
<h4 id="_combining_transition_elements">8.9.1. Combining Transition Elements</h4>
<div class="paragraph">
<p>Any combination of transition elements can be included at the end of a
step, flow, or decision definition. Combinations can include zero, one,
or more than one instance of a single type of execution element,E.g.
next.</p>
</div>
<div class="paragraph">
<p>Transition elements are evaluated in sequential order as they occur
within the JSL document. I.e. the appropriate exit status is compared
with the on attribute value of the first transition element in the
sequence and, if it matches, then the corresponding transition is
perfomed, and the rest of the transition elements are ignored. If not,
the second transition element is evaluated, etc.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;step id="Step1"&gt;
 &lt;next on="RC0" to="Step2"/&gt;
 &lt;next on="RC4" to="Step3"/&gt;
 &lt;end on="RC4" exit-status="DONE"/&gt;
 &lt;fail on="*"/&gt; &lt;!-- Matches anything, so only makes sense as last transition element--&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_transitioning_precedence_rules">8.9.2. Transitioning Precedence Rules</h4>
<div class="paragraph">
<p>The transition elements are always "evaluated" first, and if a match is
found, execution transitions accordingly (either to another execution
element or the job is stopped or failed).</p>
</div>
<div class="paragraph">
<p>If a match is not found among the transition elements (which would
always be the case if there are no transition elements), then transition
proceeds as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If execution resulted in an unhandled exception, then the job ends
with batch status of FAILED.</p>
</li>
<li>
<p>If execution ended normally, and the execution element whose
execution is completing contains a next attribute, then execution
transitions to the element named by this next attribute value.</p>
</li>
<li>
<p>If execution ended normally, and the execution element whose
execution is completing does not contain a next attribute, then the job
ends normally (with COMPLETED batch status). For transitioning from a
step within a flow, this statement doesnt apply. See section <a href="#_transitioning_from_within_flows">8.9.4</a> for
details.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The following examples illustrate how the above rules might be employed:</p>
</div>
<div class="paragraph">
<p>Example 1: Transition to Step2, unless exit status of RC_ABORT seen, in
which case fail the job</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;step id="Step1" next="Step2"&gt;
 &lt;fail on="RC_ABORT" exit-status="ABORTED"/&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 2: Transition to Step2, but if exception thrown, transition to
RecoveryStep.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;step id="Step1" next="Step2"&gt;
&lt;!-- Assumes step exit status defaults to step batch status (FAILED)--&gt;
 &lt;next on="FAILED" to="RecoveryStep"/&gt;
 &lt;fail on="*"/&gt;
&lt;/step&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the second example shows it is possible for a job to executed
to COMPLETED status, even though a constituent step ends with FAILED
batch status (See section <a href="#_step_exception_handling">8.2.7</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_loop_definition">8.9.3. Loop definition</h4>
<div class="paragraph">
<p>The specification prohibits next and to attribute values that result in
a "loop". More precisely, this means that no execution element can be
transitioned to twice within a single job execution.</p>
</div>
<div class="paragraph">
<p>This wording is purposely written this way rather than merely saying no
execution element can be executed twice within a single job execution.
Say "step1" executed to completion during an initial execution which
ultimately failed, and upon restart we transitioned past "step1" without
executing it since it had already completed, but we subsequently
transitioned (back) to "step1". This may only be a single execution of
"step1" during a single job execution, but it still violates the looping
prohibition.</p>
</div>
<div class="paragraph">
<p>The runtime may detect potential loops in an initial validation phase,
as described in section <a href="#_validation_rules">13.1</a>, or may only detect loops once they occur.</p>
</div>
</div>
<div class="sect3">
<h4 id="_transitioning_from_within_flows">8.9.4. Transitioning From Within Flows</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>As mentioned in section <a href="#_flow">8.3</a>, an execution element which is a child of a
flow may only transition to another execution element within the same
flow. The flows transition elements, however, would transition execution
to the next execution element at the level of the execution scope
containing the flow ,E.g. the job.</p>
</li>
<li>
<p>For terminating transitions (stop, end, fail) as well as failures caused
by unhandled exceptions, it is the entire job execution which is
terminated. It is not just the case that the flow alone is somehow
failed or ended yet with another level of transitioning occurring at the
containing (e.g. job) level.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Note: transition via next outside of the flow is not permitted. If
this is not detected during job validation (see section <a href="#_validation_rules">13.1</a>), then at
runtime the job execution will end at this point with batch status of
FAILED.</p>
</li>
</ol>
</div>
</li>
<li>
<p>When a child of a flow completes normally, and when there are no
matching transition elements as well as no next attribute at the level
of this child of a flow, then the flow ends.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Another way of stating rules #2 and #3 in this section would be to say
that all the rules in section <a href="#_transitioning_precedence_rules">8.9.2</a> apply to transitions within flows
(i.e. among children of flows) and are effective at the job level,
except for rule #3 in section <a href="#_transitioning_precedence_rules">8.9.2</a> (this case does not necessarily end
the job).</p>
</div>
<div class="paragraph">
<p>See the example at the end of section <a href="#_flow_level_transitions">8.9.5</a> for further clarification.</p>
</div>
</div>
<div class="sect3">
<h4 id="_flow_level_transitions_undefined">8.9.5. Flow-level Transitions Undefined</h4>
<div class="paragraph">
<p>It is recognized that the specification is incomplete with respect to
how exactly flow transition elements are evaluated. Though the list in
section <a href="#_partitionplan">10.8.4</a> has an assertion in rule 3.e. that suggests using the
exit status of the last contained execution element as a flow-level exit
status, this does not seem to be a complete definition. For example,
what if the last execution element within the flow is a split</p>
</div>
<div class="paragraph">
<p>This might be rectified in a later revision of this specification. In
the meantime it is suggested to avoid using flow-level transition
elements in light of this ambiguity.</p>
</div>
<div class="paragraph">
<p>On the other hand, a transition from a flow via the next attribute of
the flow element is well-defined at the current spec level, and is
suggested.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;flow id="Flow1" next="StepX"&gt;
 &lt;step id="FS1"&gt;
 &lt;next on="RC1" to="FS2A"/&gt;
 &lt;next on="RC2" to="FS2B"/&gt;
 &lt;!-- ILLEGAL - would be illegal, since one can only transition within the flow
 &lt;next on="RC3" to="StepX"/&gt;
 --&gt;
 &lt;/step&gt;
 &lt;step id="FS2A" &gt;
  &lt;fail on="FAILED"/&gt; &lt;!-- FAILS job, doesn't "fail flow"--&gt;
 &lt;/step&gt;
 &lt;step id="FS2B" &gt;
  &lt;fail on="FAILED"/&gt; &lt;!-- FAILS job, doesn't "fail flow"--&gt;
 &lt;/step&gt;
 &lt;next on="F*" to="StepY"/&gt; &lt;!-- UNDEFINED --&gt;
&lt;/flow&gt;
&lt;step id="StepX"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As noted in the comments inline, this example makes the following
points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>that a child of a flow can only transition to another child of
the same flow (Item 1. in section <a href="#_transitioning_from_within_flows">8.9.4</a>)</p>
</li>
<li>
<p>that a terminating transition terminates the job, not just the
flow somehow (Item 2. in section <a href="#_transitioning_from_within_flows">8.9.4</a>)</p>
</li>
<li>
<p>that a transition element which is a direct child of the flow
itself is currently UNDEFINED (section <a href="#_flow_level_transitions">8.9.5</a>)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_batch_programming_model">9. Batch Programming Model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The batch programming model is described by interfaces, abstract
classes, and field annotations. Interfaces define the essential contract
between batch applications and the batch runtime. Most interfaces have a
corresponding abstract class that provides default implementations of
certain methods for developer convenience.</p>
</div>
<div class="sect2">
<h3 id="_steps">9.1. Steps</h3>
<div class="paragraph">
<p>A batch step is either chunk or batchlet.</p>
</div>
<div class="sect3">
<h4 id="_chunk_2">9.1.1. Chunk</h4>
<div class="paragraph">
<p>A chunk type step performs item-oriented processing using a
reader-processor-writer batch pattern and does checkpointing.</p>
</div>
<div class="sect4">
<h5 id="_itemreader_interface">9.1.1.1. ItemReader Interface</h5>
<div class="paragraph">
<p>An ItemReader is used to read items for a chunk step. ItemReader is one
of the three batch artifact types that comprise a chunk type step. The
other two are ItemProcessor and ItemWriter.</p>
</div>
<div class="paragraph">
<p>The ItemReader interface may be used to implement an ItemReader batch
artifact:</p>
</div>
<div id="app-listing.ItemReader.java" class="listingblock">
<div class="title">ItemReader.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk;

import java.io.Serializable;

/*
 * ItemReader defines the batch artifact that reads
 * items for chunk processing.
 */
public interface ItemReader {
  /**
   * The open method prepares the reader to read items
   * The input parameter represents the last checkpoint
   * for this reader in a given job instance. The
   * checkpoint data is defined by this reader and is
   * provided by the checkpointInfo method. The checkpoint
   * data provides the reader whatever information it needs
   * to resume reading items upon restart. A checkpoint value
   * of null is passed upon initial start.
   *
   * @param checkpoint specifies the last checkpoint
   * @throws Exception is thrown for any errors.
   */
  public void open(Serializable checkpoint) throws Exception;

  /**
   * The close method marks the end of use of the
   * ItemReader. The reader is free to do any cleanup
   * necessary.
   * @throws Exception is thrown for any errors.
   */
  public void close() throws Exception;

  /**
   * The readItem method returns the next item
   * for chunk processing.
   * It returns null to in dicate no more items, which
   * also means the current chunk will be committed and
   * the step will end.
   * *@return* next item or null
   * @throws Exception is thrown for any errors.
   */
  public Object readItem() throws Exception;

  /**
   * The checkpointInfo method returns the current
   * checkpoint data for this reader. It is
   * called before a chunk checkpoint is committed.
   * *@return* checkpoint data
   * @throws Exception is thrown for any errors.
   */
  public Serializable checkpointInfo() throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractItemReader.java" class="listingblock">
<div class="title">AbstractItemReader.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk;
import java.io.Serializable;
public abstract class AbstractItemReader implements ItemReader
{
    @Override
    public void open(Serializable checkpoint)throws Exception {
    }

    @Override
    public void close()throws Exception {
    }

    @Override
    public abstract Object readItem() throws Exception;

    @Override
    public Serializable checkpointInfo() throws Exception {
        return null;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_itemprocessor_interface">9.1.1.2. ItemProcessor Interface</h5>
<div class="paragraph">
<p>An ItemProcessor is used to process items for a chunk step.
ItemProcessor is one of the three batch artifact types that comprise a
chunk type step. An ItemProcessor is an optional artifact on a chunk
type step. The other two are ItemReader and ItemWriter.</p>
</div>
<div class="paragraph">
<p>The ItemProcessor interface may be used to implement an ItemProcessor
batch artifact:</p>
</div>
<div id="app-listing.ItemProcessor.java" class="listingblock">
<div class="title">ItemProcessor.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk;
/**
* ItemProcessor is used in chunk processing
* to operate on an input item and produce
* an output item.
*
*/
public interface ItemProcessor {
    /**
    * The processItem method is part of a chunk
    * step. It accepts an input item from an
    * item reader and returns an item that gets
    * passed onto the item writer. Returning null
    * indicates that the item should not be continued
    * to be processed. This effectively enables processItem
    * to filter out unwanted input items.
    * @param item specifies the input item to process.
    * *@return* output item to write.
    * @throws Exception thrown for any errors.
    */
    public Object processItem(Object item) throws Exception;
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_itemwriter_interface">9.1.1.3. ItemWriter Interface</h5>
<div class="paragraph">
<p>An ItemWriter is used to write a list of output items for a chunk step.
ItemWriter is one of the three batch artifact types that comprise a
chunk type step. The other two are ItemProcessor and ItemReader.</p>
</div>
<div class="paragraph">
<p>The ItemWriter interface may be used to implement an ItemWriter batch
artifact:</p>
</div>
<div id="app-listing.ItemWriter.java" class="listingblock">
<div class="title">ItemWriter.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk;
import java.io.Serializable;
import java.util.List;
/**
*
* ItemWriter defines the batch artifact that writes to a
* list of items for chunk processing.
*
*/
public interface ItemWriter {
    /**
    * The open method prepares the writer to write items.
    *
    * The input parameter represents the last checkpoint
    * for this writer in a given job instance. The
    * checkpoint data is defined by this writer and is
    * provided by the checkpointInfo method. The checkpoint
    * data provides the writer whatever information it needs
    * to resume writing items upon restart. A checkpoint value
    * of null is passed upon initial start.
    *
    * @param checkpoint specifies the last checkpoint
    * @throws Exception is thrown for any errors.
    */
    public void open(Serializable checkpoint) throws Exception;
    /**
    * The close method marks the end of use of the
    * ItemWriter. The writer is free to do any cleanup
    * necessary.
    * @throws Exception is thrown for any errors.
    */
    public void close() throws Exception;
    /**
    * The writeItems method writes a list of item
    * for the current chunk.
    * @param items specifies the list of items to write.
    * This may be an empty list (e.g. if all the
    * items have been filtered out by the
    * ItemProcessor).
    * @throws Exception is thrown for any
    errors.
    */
    public void writeItems(List&lt;Object&gt; items) throws Exception;
    /**
    * The checkpointInfo method returns the current
    * checkpoint data for this writer. It is
    * called before a chunk checkpoint is committed.
    * *@return* checkpoint data
    * @throws Exception is thrown for any errors.
    */
    public Serializable checkpointInfo() throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractItemWriter.java" class="listingblock">
<div class="title">AbstractItemWriter.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk;
import java.io.Serializable;
import java.util.List;
/**
* The AbstractItemWriter provides default implementations
* of not commonly implemented methods.
*/
public abstract class AbstractItemWriter implements ItemWriter
{
    /**
    * Override this method if the ItemWriter requires
    * any open time processing.
    * The default implementation does nothing.
    *
    * @param last checkpoint for this ItemReader
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void open(Serializable checkpoint) throws Exception {
    }
    /**
    * Override this method if the ItemWriter requires
    * any close time processing.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void close() throws Exception {
    }
    /**
    * Implement write logic for the ItemWriter in this
    * method.
    *
    * @param items specifies the list of items to write.
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public abstract void writeItems(List&lt;Object&gt; items) throws
    Exception;
    /**
    * Override this method if the ItemWriter supports
    * checkpoints.
    * The default implementation returns null.
    *
    * *@return* checkpoint data
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public Serializable checkpointInfo() throws Exception {
        return null;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_checkpointalgorithm_interface">9.1.1.4. CheckpointAlgorithm Interface</h5>
<div class="paragraph">
<p>A CheckpointAlgorithm implements a custom checkpoint policy for a chunk
step. The CheckpointAlgorithm interface may be used to implement an
CheckpointAlgorithm batch artifact:</p>
</div>
<div id="app-listing.CheckpointAlgorithm.java" class="listingblock">
<div class="title">CheckpointAlgorithm.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk;
/**
* CheckpointAlgorithm provides a custom checkpoint
* policy for chunk steps.
*
*/
public interface CheckpointAlgorithm {
    /**
    * The checkpointTimeout is invoked at the beginning of a new
    * checkpoint interval for the purpose of establishing the checkpoint
    * timeout.
    * It is invoked before the next chunk transaction begins. This
    * method returns an integer value, which is the timeout value
    * (expressed in seconds) which will be used for the next chunk
    * transaction.
    * This method is useful to automate the setting of the
    * checkpoint timeout based on factors known outside the job
    * definition.
    * A value of '0' signifies no maximum established by this
    * CheckpointAlgorithm, i.e. the maximum permissible timeout allowed by
    * the runtime environment.
    * @return the timeout interval (expressed in seconds)
    * to use for the next checkpoint interval
    * @throws Exception thrown for any errors.
    */
    public int checkpointTimeout() throws Exception;
    /**
    * The beginCheckpoint method is invoked before the
    * next checkpoint interval begins (before the next
    * chunk transaction begins).
    * @throws Exception thrown for any errors.
    */
    public void beginCheckpoint() throws Exception;
    /**
    * The isReadyToCheckpoint method is invoked by
    * the batch runtime after each item is processed
    * to determine if now is the time to checkpoint
    * the current chunk.
    * *@return* boolean indicating whether or not
    * to checkpoint now.
    * @throws Exception thrown for any errors.
    */
    public boolean isReadyToCheckpoint() throws Exception;
    /**
    * The endCheckpoint method is invoked after the
    * last checkpoint is taken (after the chunk
    * transaction is committed).
    * @throws Exception thrown for any errors.
    */
    public void endCheckpoint() throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractCheckpointAlgorithm.java" class="listingblock">
<div class="title">AbstractCheckpointAlgorithm.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk;
/**
* The AbstractCheckpointAlgorithm provides default
* implementations of less commonly implemented
* methods.
*/
public abstract class AbstractCheckpointAlgorithm implements
CheckpointAlgorithm {
    /**
    * Override this method if the CheckpointAlgorithm
    * establishes a checkpoint timeout.
    * The default implementation returns 0, which means
    * the maximum permissible timeout allowed by the
    * runtime environment.
    *
    * @return the timeout interval (expressed in seconds)
    * to use for the next checkpoint interval
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public int checkpointTimeout() throws Exception {
        return 0;
    }
    /**
    * Override this method for the CheckpointAlgorithm
    * to do something before a checkpoint interval
    * begins (before the next chunk transaction begins).
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void beginCheckpoint() throws Exception {
    }
    /**
    * Implement logic in this method
    * to decide if a checkpoint should be taken now.
    *
    * *@return* boolean indicating whether or not
    * to checkpoint now.
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public abstract boolean isReadyToCheckpoint() throws Exception;
    /**
    * Override this method for the CheckpointAlgorithm
    * to do something after a checkpoint is taken (after
    * the chunk transaction is committed).
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void endCheckpoint() throws Exception {
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_batchlet_interface">9.1.2. Batchlet Interface</h4>
<div class="paragraph">
<p>A Batchlet-type step implements a roll your own batch pattern. This
batch pattern is invoked once, runs to completion, and returns an exit
status.</p>
</div>
<div class="paragraph">
<p>The Batchlet interface may be used to implement a Batchlet batch
artifact:</p>
</div>
<div id="app-listing.Batchlet.java" class="listingblock">
<div class="title">Batchlet.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api;
/**
*
* A batchlet is type of batch step
* that can be used for any type of
* background processing that does not
* explicitly call for a chunk oriented
* approach.
* &lt;p&gt;
* A well-behaved batchlet responds
* to stop requests by implementing
* the stop method.
*
*/
public interface Batchlet {
    /**
    * The process method does the work
    * of the batchlet. If this method
    * throws an exception, the batchlet
    * step ends with a batch status of
    * FAILED.
    * *@return* exit status string
    * @throws Exception if an error occurs.
    */
    public String process() throws Exception;
    /**
    * The stop method is invoked by the batch
    * runtime as part of JobOperator.stop()
    * method processing. This method is invoked
    * on a thread other than the thread on which
    * the batchlet process method is running.
    *
    * @throws Exception if an error occurs.
    */
    public void stop() throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractBatchlet.java" class="listingblock">
<div class="title">AbstractBatchlet.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api;
/**
* The AbstractBatchlet provides default
* implementations of less commonly implemented methods.
*/
public abstract class AbstractBatchlet implements Batchlet {
    /**
    * Implement process logic for the Batchlet in this
    * method.
    *
    * *@return* exit status string
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public abstract String process() throws Exception;
    /**
    * Override this method if the Batchlet will
    * end in response to the JobOperator.stop()
    * operation.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void stop() throws Exception {
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
A well designed batchlet stops gracefully when the JobOperator.stop operation is invoked.
See section <a href="#_stop_processing">11.13</a> for further information about stop processing.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_listeners">9.2. Listeners</h3>
<div class="paragraph">
<p>Use Listeners to interpose on batch execution.</p>
</div>
<div class="sect3">
<h4 id="_joblistener_interface">9.2.1. JobListener Interface</h4>
<div class="paragraph">
<p>A job listener receives control before and after a job execution runs,
and also if an exception is thrown during job processing. The
JobListener interface may be used to implement an JobListener batch
artifact:</p>
</div>
<div id="app-listing.JobListener.java" class="listingblock">
<div class="title">JobListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.listener;
/**
* JobListener intercepts job execution.
*
*/
public interface JobListener {
    /**
    * The beforeJob method receives control
    * before the job execution begins.
    * @throws Exception throw if an error occurs.
    */
    public void beforeJob() throws Exception;
    /**
    * The afterJob method receives control
    * after the job execution ends.
    * @throws Exception throw if an error occurs.
    */
    public void afterJob() throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractJobListener.java" class="listingblock">
<div class="title">AbstractJobListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.listener;
/**
* The AbstractJobListener provides default
* implementations of less commonly implemented methods.
*/
public abstract class AbstractJobListener implements JobListener
{
    /**
    * Override this method if the JobListener
    * will do something before the job begins.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void beforeJob() throws Exception {
    }
    /**
    * Override this method if the JobListener
    * will do something after the job ends.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void afterJob() throws Exception {
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_steplistener_interface">9.2.2. StepListener Interface</h4>
<div class="paragraph">
<p>A step listener can receive control before and after a step runs, and
also if an exception is thrown during step processing. The StepListener
interface may be used to implement an StepListener batch artifact:</p>
</div>
<div id="app-listing.StepListener.java" class="listingblock">
<div class="title">StepListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.listener;
/**
* StepListener intercepts step execution.
*
*/
public interface StepListener {
    /**
    * The beforeStep method receives control
    * before a step execution begins.
    * @throws Exception throw if an error occurs.
    */
    public void beforeStep() throws Exception;
    /**
    * The afterStep method receives control
    * after a step execution ends.
    * @throws Exception throw if an error occurs.
    */
    public void afterStep() throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractStepListener.java" class="listingblock">
<div class="title">AbstractStepListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.listener;
/**
* The AbstractStepListener provides default
* implementations of less commonly implemented methods.
*/
public abstract class AbstractStepListener implements
StepListener {
    /**
    * Override this method if the StepListener
    * will do something before the step begins.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void beforeStep() throws Exception {
    }
    /**
    * Override this method if the StepListener
    * will do something after the step ends.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void afterStep() throws Exception {
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_chunklistener_interface">9.2.3. ChunkListener Interface</h4>
<div class="paragraph">
<p>A chunk listener can receive control at the beginning and the end of
chunk, and upon an exception thrown back to the runtime implementation.
The ChunkListener interface may be used to implement a ChunkListener
batch artifact:</p>
</div>
<div id="app-listing.ChunkListener.java" class="listingblock">
<div class="title">ChunkListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* ChunkListener intercepts chunk processing.
*
*/
public interface ChunkListener {
    /**
    * The beforeChunk method receives control
    * before processing of the next
    * chunk begins. This method is invoked
    * in the same transaction as the chunk
    * processing.
    * @throws Exception throw if an error occurs.
    */
    public void beforeChunk() throws Exception;
    /**
    * The onError method receives control
    * before the chunk transaction is rolled back.
    * Note afterChunk is not invoked in this case.
    * @param ex specifies the exception that
    * caused the roll back.
    * @throws Exception throw if an error occurs.
    */
    public void onError(Exception ex) throws Exception;
    /**
    * The afterChunk method receives control
    * after processing of the current
    * chunk ends. This method is invoked
    * in the same transaction as the chunk
    * processing.
    * @throws Exception throw if an error occurs.
    */
    public void afterChunk() throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractChunkListener.java" class="listingblock">
<div class="title">AbstractChunkListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* The AbstractChunkListener provides default
* implementations of less commonly implemented methods.
*/
public abstract class AbstractChunkListener implements
ChunkListener {
    /**
    * Override this method if the ChunkListener
    * will do something before the chunk begins.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void beforeChunk() throws Exception {
    }
    /**
    * Override this method if the ChunkListener will do
    * something before the chunk transaction is rolled back.
    * Note afterChunk is not invoked in this case.
    * @param ex specifies the exception that
    * caused the roll back.
    * @throws Exception (or subclass) throw if an error occurs.
    */
    @Override
    public void onError(Exception ex) throws Exception {
    }
    /**
    * Override this method if the ChunkListener
    * will do something after the chunk ends.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void afterChunk() throws Exception {
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_itemreadlistener_interface">9.2.4. ItemReadListener Interface</h4>
<div class="paragraph">
<p>An item read listener can receive control before and after an item is
read by an item reader, and also if the reader throws an exception. The
ItemReadListener interface may be used to implement an ItemReadListener
batch artifact:</p>
</div>
<div id="app-listing.ItemReadListener.java" class="listingblock">
<div class="title">ItemReadListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* ItemReadListener intercepts item reader
* processing.
*
*/
public interface ItemReadListener {
    /**
    * The beforeRead method receives control
    * before an item reader is called to read the next item.
    * @throws Exception is thrown if an error occurs.
    */
    public void beforeRead() throws Exception;
    /**
    * The afterRead method receives control after an item
    * reader reads an item. The method receives the item read as
    * an input.
    * @param item specifies the item read by the item reader.
    * @throws Exception is thrown if an error occurs.
    */
    public void afterRead(Object item) throws Exception;
    /**
    * The onReadError method receives control after an item reader
    * throws an exception in the readItem method.
    * This method receives the exception as an input.
    * @param ex specifies the exception that occurred in the item reader.
    * @throws Exception is thrown if an error occurs.
    */
    public void onReadError(Exception ex) throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractItemReadListener.java" class="listingblock">
<div class="title">AbstractItemReadListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* The AbstractItemReadListener provides default
* implementations of less commonly implemented methods.
*/
public abstract class AbstractItemReadListener implements
ItemReadListener {
    /**
    * Override this method if the ItemReadListener
    * will do something before the item is read.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void beforeRead() throws Exception {
    }
    /**
    * Override this method if the ItemReadListener
    * will do something after the item is read.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void afterRead(Object item) throws Exception {
    }
    /**
    * Override this method if the ItemReadListener
    * will do something when the ItemReader readItem
    * method throws an exception.
    * The default implementation does nothing.
    *
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void onReadError(Exception ex) throws Exception {
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_itemprocesslistener_interface">9.2.5. ItemProcessListener Interface</h4>
<div class="paragraph">
<p>An item processor listener can receive control before and after an item
is processed by an item processor, and also if the processor throws an
exception. The ItemProcessListener interface may be used to implement an
ItemProcessListener batch artifact:</p>
</div>
<div id="app-listing.ItemProcessListener.java" class="listingblock">
<div class="title">ItemProcessListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* ItemProcessListener intercepts item processing.
*
*/
public interface ItemProcessListener {
    /**
    * The beforeProcess method receives control before
    * an item processor is called to process the next item.
    * The method receives the item to be processed as an input.
    * @param item specifies the item about to be processed.
    * @throws Exception if an error occurs.
    */
    public void beforeProcess(Object item) throws Exception;
    /**
    * The afterProcess method receives control after an item
    * processor processes an item. The method receives the item processed
    * and the result item as an input.
    * @param item specifies the item processed by the item processor.
    * @param result specifies the item to pass to the item writer.
    * @throws Exception if an error occurs.
    */
    public void afterProcess(Object item, Object result) throws
    Exception;
    /**
    * The onProcessError method receives control after an
    * item processor processItem throws an exception. The method
    * receives the item sent to the item processor as input.
    * @param item specifies the item the processor attempted to process.
    * @param ex specifies the exception thrown by the item processor.
    * @throws Exception if an error occurs
    */
    public void onProcessError(Object item, Exception ex) throws
    Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractItemProcessListener.java" class="listingblock">
<div class="title">AbstractItemProcessListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* The AbstractItemProcessListener provides default
* implementations of less commonly implemented methods.
*
*/
public abstract class AbstractItemProcessListener implements
ItemProcessListener {
    /**
    * Override this method if the ItemProcessListener
    * will do something before the item is processed.
    * The default implementation does nothing.
    *
    * @param item specifies the item about to be processed.
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void beforeProcess(Object item) throws Exception {
    }
    /**
    * Override this method if the ItemProcessListener
    * will do something after the item is processed.
    * The default implementation does nothing.
    *
    * @param item specifies the item about to be processed.
    * @param result specifies the item to pass to the item writer.
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void afterProcess(Object item, Object result) throws
    Exception {
    }
    /**
    * Override this method if the ItemProcessListener
    * will do something when the ItemProcessor processItem
    * method throws an exception.
    * The default implementation does nothing.
    *
    * @param item specifies the item about to be processed.
    * @param ex specifies the exception thrown by the item processor.
    * @throws Exception (or subclass) if an error occurs.
    */
    @Override
    public void onProcessError(Object item, Exception ex) throws
    Exception {
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_itemwritelistener_interface">9.2.6. ItemWriteListener Interface</h4>
<div class="paragraph">
<p>A item write listener can receive control before and after an item is
written by an item writer, and also if the writer throws an exception.
The ItemWriteListener interface may be used to implement an
ItemWriteListener batch artifact:</p>
</div>
<div id="app-listing.ItemWriteListener.java" class="listingblock">
<div class="title">ItemWriteListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
import java.util.List;
/**
* ItemWriteListener intercepts item writer
* processing.
*
*/
public interface ItemWriteListener {
    /**
    * The beforeWrite method receives control before
    * an item writer is called to write its items. The
    * method receives the list of items sent to the item
    * writer as an input.
    * @param items specifies the items about to be
    * written.
    * @throws Exception is thrown if an error occurs.
    */
    public void beforeWrite(List&lt;Object&gt; items) throws Exception;
    /**
    * The afterWrite method receives control after an
    * item writer writes its items. The method receives the
    * list of items sent to the item writer as an input.
    * @param items specifies the items written by the item writer.
    * @throws Exception is thrown if an error occurs.
    */
    public void afterWrite(List&lt;Object&gt; items) throws Exception;
    /**
    * The onWriteError method receives control after an
    * item writer writeItems throws an exception. The method
    * receives the list of items sent to the item writer as input.
    * @param items specifies the items which the item writer
    * attempted to write.
    * @param ex specifies the exception thrown by the item
    * writer.
    * @throws Exception is thrown if an error occurs.
    */
    public void onWriteError(List&lt;Object&gt; items, Exception ex) throws
    Exception;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_skip_listener_interfaces">9.2.7. Skip Listener Interfaces</h4>
<div class="paragraph">
<p>A skip listener can receive control when a skippable exception is
thrown from an item reader, processor, or writer. Three interfaces are
provided to implement these listeners:</p>
</div>
<div id="app-listing.SkipReadListener.java" class="listingblock">
<div class="title">SkipReadListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* SkipReadListener intercepts skippable
* itemReader exception handling.
*/
public interface SkipReadListener {
    /**
    * The onSkipReadItem method receives control
    * when a skippable exception is thrown from an
    * ItemReader readItem method. This method receives the
    * exception as an input.
    * @param ex specifies the exception thrown by the ItemReader.
    * @throws Exception is thrown if an error occurs.
    */
    public void onSkipReadItem(Exception ex) throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.SkipProcessListener.java" class="listingblock">
<div class="title">SkipProcessListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* SkipProcessListener intercepts skippable
* itemProcess exception handling.
*/
public interface SkipProcessListener {
    /**
    * The onSkipProcessItem method receives control when
    * a skippable exception is thrown from an ItemProcess
    * processItem method.
    * This method receives the exception and the item to process
    * as an input.
    * @param item specifies the item passed to the ItemProcessor.
    * @param ex specifies the exception thrown by the
    * ItemProcessor.
    * @throws Exception is thrown if an error occurs.
    */
    public void onSkipProcessItem(Object item, Exception ex) throws
    Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.SkipWriteListener.java" class="listingblock">
<div class="title">SkipWriteListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
import java.util.List;
/**
* SkipWriteListener intercepts skippable
* itemWriter exception handling.
*/
public interface SkipWriteListener {
    /**
    * The onSkipWriteItems method receives control when a
    * skippable exception is thrown from an ItemWriter
    * writeItems method. This
    * method receives the exception and the items that were
    * skipped as an input.
    * @param items specifies the list of item passed to the
    * item writer.
    * @param ex specifies the exception thrown by the
    * ItemWriter.
    * @throws Exception is thrown if an error occurs.
    */
    public void onSkipWriteItem(List&lt;Object&gt; items, Exception ex)
    throws Exception;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_retrylistener_interface">9.2.8. RetryListener Interface</h4>
<div class="paragraph">
<p>A retry listener can receive control when a retryable exception is
thrown from an item reader, processor, or writer. Three interfaces are
provided to implement these listeners:</p>
</div>
<div id="app-listing.RetryReadListener.java" class="listingblock">
<div class="title">RetryReadListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* RetryReadListener intercepts retry processing for
* an ItemReader.
*/
public interface RetryReadListener {
    /**
    * The onRetryReadException method receives control
    * when a retryable exception is thrown from an ItemReader
    * readItem method.
    * This method receives the exception as input. This method
    * receives control in the same checkpoint scope as the
    * ItemReader. If this method throws a an exception, the job
    * ends in the FAILED state.
    * @param ex specifies the exception thrown by the item
    * reader.
    * @throws Exception is thrown if an error occurs.
    */
    public void onRetryReadException(Exception ex) throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.RetryProcessListener.java" class="listingblock">
<div class="title">RetryProcessListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
/**
* RetryProcessListener intercepts retry processing for
* an ItemProcessor.
*
*/
public interface RetryProcessListener {
    /**
    * The onRetryProcessException method receives control
    * when a retryable exception is thrown from an ItemProcessor
    * processItem method. This method receives the exception and the item
    * being processed as inputs. This method receives control in same
    * checkpoint scope as the ItemProcessor. If this method
    * throws a an exception, the job ends in the FAILED state.
    * @param item specifies the item passed to the ItemProcessor.
    * @param ex specifies the exception thrown by the ItemProcessor.
    * @throws Exception is thrown if an error occurs.
    */
    public void onRetryProcessException(Object item, Exception ex)
    throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.RetryWriteListener.java" class="listingblock">
<div class="title">RetryWriteListener.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.chunk.listener;
import java.util.List;
/**
* RetryWriteListener intercepts retry processing for
* an ItemWriter.
*
*/
public interface RetryWriteListener {
    /**
    * The onRetryWriteException method receives control when a
    * retryable exception is thrown from an ItemWriter writeItems
    * method. This method receives the exception and the list of items
    * being written as inputs.
    * This method receives control in same checkpoint scope as the
    * ItemWriter. If this method throws a an exception, the job ends
    * in the FAILED state.
    * @param items specify the items passed to an item writer.
    * @param ex specifies the exception thrown by an item
    * writer.
    * @throws Exception is thrown if an error occurs.
    */
    public void onRetryWriteException(List&lt;Object&gt; items, Exception ex)
    throws Exception;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_batch_properties">9.3. Batch Properties</h3>
<div class="paragraph">
<p>Batch applications need a way to receive parameters when a job is
initiated for execution. Properties can be defined by batch programming
model artifacts, then have values passed to them when a job is
initiated. Batch properties are string values.</p>
</div>
<div class="paragraph">
<p>Note batch properties are visible only in the scope in which they are
defined (see Section <a href="#_scope_of_property_definitions_for_batchproperty">9.3.2</a>). However batch properties values can be
formed from other properties according to Job XML Substitution Rules.
See section <a href="#_job_xml_substitution">8.8</a> for further information on substitution.</p>
</div>
<div class="sect3">
<h4 id="_batchproperty">9.3.1. @BatchProperty</h4>
<div class="paragraph">
<p>The @BatchProperty annotation identifies a class field injection as a
batch property. A batch property has a name (name) and default value.
The @BatchProperty may be used on a class field for any class identified
as a batch programming model artifact -E.g. ItemReader, ItemProcessor,
JobListener, etc..</p>
</div>
<div class="paragraph">
<p>@BatchProperty must be used with the standard @Inject annotation
(javax.inject.Inject). @BatchProperty is used to assign batch artifact
property values from Job XML to the batch artifact itself.</p>
</div>
<div class="paragraph">
<p>A field annotated with the @BatchProperty annotation must not be static
and must not be final.</p>
</div>
<div class="paragraph">
<p>Note: the batch runtime must ensure @Inject works with @BatchProperty,
whether or not the execution environment includes an implementation of
JSR 299 or 330. This means the batch properties may always be injected.
Whether or not other injections are supported is dependent upon the
batch runtime implementation.</p>
</div>
<div class="paragraph">
<p>Syntax:</p>
</div>
<div id="app-listing.batchProperty" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> package: javax.batch.api

 @Inject @BatchProperty(name="&lt;property-name&gt;") String &lt;field-name&gt;;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;property-name&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the optional name of this batch property. The
default is the Java field name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;field-name&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">is the field name of the batch property.</p></td>
</tr>
</tbody>
</table>
<div id="app-listing.BatchProperty.java" class="listingblock">
<div class="title">BatchProperty.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api;
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;
import javax.enterprise.util.Nonbinding;
import javax.inject.Qualifier;
/**
* Annotation used by batch artifacts to declare a
* field which is injectable via a JSL-defined value
* (possibly leveraging Job XML substitutions).
*
*/
@Qualifier
@Target({
    ElementType._FIELD_, ElementType._METHOD_,
    ElementType._PARAMETER_
}
)
@Retention(RetentionPolicy._RUNTIME_)
public @interface BatchProperty {
    @Nonbinding
    public String name() default "";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of the annotated field is assigned by the batch runtime if a
corresponding property element with a matching name is specified in the
JSL in the scope that applies to the batch artifact in question. If the
JSL property value resolves to the empty string (either explicitly set
to the empty string literal or resolving to an empty string via property
substitution – see section <a href="#_job_xml_substitution">8.8</a>), no assignment is made and the resulting
value is undefined by the batch specification. The resulting value might
simply be the Java default value, however using various dependency
injection technologies may produce different results. The resultant
behavior may be defined by the particular dependency injection
technology used in the runtime environment and so is outside the scope
of this specification.
Example:</p>
</div>
<div id="app-listing.BatchPropertySample" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> import javax.inject.Inject;
 import javax.batch.api.BatchProperty;
 public class MyItemReaderImpl {

@Inject @BatchProperty String fname;

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Behavior:</p>
</div>
<div class="paragraph">
<p>When the batch runtime instantiates the batch artifact (item reader in
this example), it assigns the</p>
</div>
<div class="paragraph">
<p>value of the property with name equal to fname provided in the job XML
to the corresponding @BatchProperty field named fname. If no value is
defined in JSL, the Java default (null) is assigned or some other
default is provided by a particular dependency injection technology.</p>
</div>
</div>
<div class="sect3">
<h4 id="_scope_of_property_definitions_for_batchproperty_injection">9.3.2. Scope of property definitions for @BatchProperty Injection</h4>
<div class="paragraph">
<p>The rules governing the definition of properties for injection via
@BatchProperty deserve some extra explanation and an example.</p>
</div>
<div class="paragraph">
<p>For a given artifact, the only properties that are injectable via
@BatchProperty are those which are defined at the level of the artifact
itself (i.e. as children of the "properties" element which is in turn a
child of the very element defining the artifact: batchlet, reader,
listener, etc.).</p>
</div>
<div class="paragraph">
<p>In particular, just because an artifact definition is contained (at some
level of nesting) within a job element and (for most artifacts) within a
step element as well, it is NOT the case that the job properties and
step properties are themselves injectable into that artifact via
@BatchProperty. This is the case even though these job and step
properties are available for resolving the artifact-level property
definitions via the jobProperties substitution mechanism (see section
8.8.1.2) .</p>
</div>
<div class="paragraph">
<p>The following example should make this more clear:</p>
</div>
<div id="app-listing.BatchPropertyXML" class="listingblock">
<div class="title">Example JSL</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;job&gt;
 &lt;properties&gt;
 &lt;property name="x" value="xVal"/&gt;
 ...
 &lt;step id="step1"&gt;
  &lt;batchlet ref="MyBatchlet"&gt;
   &lt;properties&gt;
    &lt;property name="y" value="#\{jobProperties['x']}"/&gt;
   &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example Java (MyBatchlet from JSL above):</strong></p>
</div>
<div id="app-listing.BadBatchProperty" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"> // WONT WORK! - There is no property 'x' in scope for this injection
 @Inject @BatchProperty(name="x");

 // WILL WORK – Gets value 'xVal'
 @Inject @BatchProperty(name="y");</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_batch_contexts">9.4. Batch Contexts</h3>
<div class="paragraph">
<p>Context objects are supplied by the batch runtime and provide important
functions to a batch application. Contexts provide information about the
running batch job, provide a place for a batch job to store interim
values, and provide a way for the batch application to communicate
important information back to the batch runtime. Contexts can be
injected into an application as member variables. There is a context for
both job and step. The job context represents the entire job. The step
context represents the current step executing within the job.</p>
</div>
<div class="sect3">
<h4 id="_batch_contexts_2">9.4.1. Batch Contexts</h4>
<div class="paragraph">
<p>Batch artifact access to batch contexts is by injection using the
standard @Inject annotation (javax.inject.Inject). A field into which a
batch context is injected must not be static and must not be final.
E.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@Inject JobContext _jctxt;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>@Inject StepContext _sctxt;</pre>
</div>
</div>
<div class="paragraph">
<p>The batch runtime is responsible to ensure the correct context object is
injected according to the job or step currently executing.</p>
</div>
<div class="paragraph">
<p>Note: the batch runtime must ensure @Inject works with JobContext and
StepContext, whether or not the execution environment includes an
implementation of JSR 299 or 330. This means the batch contexts may
always be injected. Whether or not other injections are supported is
dependent upon the batch runtime implementation.
 See section 10.9.1 for definition of JobContext class. See section
10.9.2 for definition of StepContext class.</p>
</div>
<div class="sect4">
<h5 id="_batch_context_lifecycle_and_scope">9.4.1.1. Batch Context Lifecycle and Scope</h5>
<div class="paragraph">
<p>A batch context has thread affinity and is visible only to the batch
artifacts executing on that particular thread. A batch context injected
field may be null when out of scope. Each context type has a distinct
scope and lifecycle as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>JobContext<br></p>
<div class="paragraph">
<p>There is one JobContext per job execution. It exists for the life of a
job. There is a distinct JobContext for each sub-thread of a parallel
execution (e.g. partitioned step).</p>
</div>
</li>
<li>
<p>StepContext<br></p>
<div class="paragraph">
<p>There is one StepContext per step execution. It exists for the life of
the step. For a partitioned step, there is one StepContext for the
parent step/thread; there is a distinct StepContext for each sub-thread
and each StepContext has its own distinct persistent user data for each
sub-thread.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parallelization">9.5. Parallelization</h3>
<div class="paragraph">
<p>Batch jobs may be configured to run some of their steps in parallel.
There are two supported parallelization models:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Partitioned:</p>
<div class="paragraph">
<p>In the partitioned model, a step is configured to run as multiple
instances across multiple threads. Each thread runs the same step or
flow. This model is logically equivalent to launching multiple instances
of the same step. It is intended that each partition processes a
different range of the input items.</p>
</div>
<div class="paragraph">
<p>The partitioned model includes several optional batch artifacts to
enable finer control over parallel processing:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>PartitionMapper provides a programmatic means for calculating the
number of partitions and unique properties for each.</p>
</li>
<li>
<p>PartitionReducer provides a unit of work demarcation around
partition processing.</p>
</li>
<li>
<p>PartitionCollector provides a means for merging interrim results
from individual partitions.</p>
</li>
<li>
<p>PartitionAnalyzer provides a means to gather interrim and final
results from individual partitions for single point of control
processing and decision making.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Concurrent:</p>
<div class="paragraph">
<p>In the concurrent model, the flows defined by a split are configured to
run concurrently on multiple threads, one flow per thread.</p>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_partitionmapper_interface">9.5.1. PartitionMapper Interface</h4>
<div class="paragraph">
<p>A partition mapper receives control at the start of a partitioned
execution. The partition mapper is responsible to provide unique batch
properties for each partition. The PartitionMapper interface may be used
to implement a PartitionMapper batch artifact:</p>
</div>
<div id="app-listing.PartitionMapper.java" class="listingblock">
<div class="title">PartitionMapper.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.partition;
import javax.batch.api.partition.PartitionPlan;
/**
* PartitionMapper receives control at the start of a partitioned
* execution. A PartitionMapper is responsible to provide unique
* batch properties for each partition.
*
*/
public interface PartitionMapper {
    /**
    * The mapPartitions method that receives control at the
    * start of partitioned step processing. The method
    * returns a PartitionPlan, which specifies the batch properties
    * for each partition.
    * *@return* partition plan for a partitioned step.
    * @throws Exception is thrown if an error occurs.
    */
    public PartitionPlan mapPartitions( ) throws Exception;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See section 10.9.4 for details on the PartitionPlan result value type.</p>
</div>
<div class="paragraph">
<p>The PartitionMapper, when defined, is invoked upon every execution,
including restarted executions. For a full discussion of the behavior on
restart, including how to override particular details of the
PartitionPlan built by the previous execution, see section <a href="#_batchruntime">10.8.5</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_partitionreducer_interface">9.5.2. PartitionReducer Interface</h4>
<div class="paragraph">
<p>A partition reducer provides a unit of work demarcation across
partitions. It is not a JTA transaction; no resources are enlisted.
Rather, it provides transactional flow semantics to facilitate
finalizing merge or compensation logic. The PartitionReducer interface
may be used to implement an PartitionReducer batch artifact:</p>
</div>
<div id="app-listing.PartitionReducer.java" class="listingblock">
<div class="title">PartitionReducer.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.partition;
/**
* PartitionReducer provides unit of work demarcation across
* partitions. It is not a JTA transaction; no resources are
* enlisted. Rather, it provides transactional flow semantics
* to facilitate finalizing merge or compensation logic.
*
*/
public interface PartitionReducer {
    public *enum* PartitionStatus {
        COMMIT_, _ROLLBACK
    }
    /**
    * The beginPartitionedStep method receives
    * control at the start of partition processing.
    * It receives control before the PartitionMapper
    * is invoked and before any partitions are started.
    * @throws Exception is thrown if an error occurs.
    */
    public void beginPartitionedStep() throws Exception;
    /**
    * The beforePartitionedStepCompletion method
    * receives control at the end of partitioned
    * step processing. It receives control after all
    * partitions have completed. It does not receive
    * control if the PartitionReducer is rolling back.
    * @throws Exception is thrown if an error occurs.
    */
    public void beforePartitionedStepCompletion() throws Exception;
    /**
    * The rollbackPartitionedStep method receives
    * control if the runtime is rolling back a partitioned
    * step. Any partition threads still running are
    * allowed to complete before this method is invoked. This method
    * receives control if any of the following conditions
    * are true:
    * &lt;p&gt;
    * &lt;ol&gt;
    * &lt;li&gt;One or more partitions end with a Batch Status of
    * STOPPED or FAILED.&lt;/li&gt;
    * &lt;li&gt;Any of the following partitioned step callbacks
    * throw an exception:&lt;/li&gt;
    * &lt;ol&gt;
    * &lt;li&gt;PartitionMapper&lt;/li&gt;
    * &lt;li&gt;PartitionReducer&lt;/li&gt;
    * &lt;li&gt;PartitionCollector&lt;/li&gt;
    * &lt;li&gt;PartitionAnalyzer&lt;/li&gt;
    * &lt;/ol&gt;
    * &lt;li&gt;A job with partitioned steps is restarted.&lt;/li&gt;
    * &lt;/ol&gt;
    * @throws Exception is thrown if an error occurs.
    */
    public void rollbackPartitionedStep() throws Exception;
    /**
    * The afterPartitionedStepCompletion method receives control
    * at the end of a partition processing. It receives a status
    * value that identifies the outcome of the partition processing.
    * The status string value is either "COMMIT" or "ROLLBACK".
    * @param status specifies the outcome of the partitioned step. Values
    * are "COMMIT" or "ROLLBACK".
    * @throws Exception is thrown if an error occurs.
    */
    public void afterPartitionedStepCompletion(PartitionStatus status)
    throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractPartitionReducer.java" class="listingblock">
<div class="title">AbstractPartitionReducer.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.partition;
/**
* The AbstractPartitionReducer provides default
* implementations of less commonly implemented methods.
*/
public abstract class AbstractPartitionReducer implements
PartitionReducer {
    /**
    * Override this method to take action before
    * partitioned step processing begins.
    *
    * @throws Exception is thrown if an error occurs.
    */
    @Override
    public void beginPartitionedStep() throws Exception {
    }
    /**
    * Override this method to take action before
    * normal partitioned step processing ends.
    *
    * @throws Exception is thrown if an error occurs.
    */
    @Override
    public void beforePartitionedStepCompletion() throws Exception {
    }
    /**
    * Override this method to take action when a
    * partitioned step is rolling back.
    *
    * @throws Exception is thrown if an error occurs.
    */
    @Override
    public void rollbackPartitionedStep() throws Exception {
    }
    /**
    * Override this method to take action after
    * partitioned step processing ends.
    *
    * @param status specifies the outcome of the partitioned step.
    * Values are "COMMIT" or "ROLLBACK".
    * @throws Exception is thrown if an error occurs.
    */
    @Override
    public void afterPartitionedStepCompletion(PartitionStatus status)
    throws Exception {
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_partitioncollector_interface">9.5.3. PartitionCollector Interface</h4>
<div class="paragraph">
<p>A partition collector provides a way to send data from individual
partitions to a single point of control running on the parent thread.
The PartitionAnalyzer is used to receive and process this data. See
section <a href="#_partitionanalyzer_interface">9.5.4</a> for further information about the PartitionAnalyzer. The
PartitionCollector interface may be used to implement an
PartitionCollector batch artifact:</p>
</div>
<div id="app-listing.PartitionCollector.java" class="listingblock">
<div class="title">PartitionCollector.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.partition;
import java.io.Serializable;
/**
* PartitionCollector provides a way to pass data from
* individual partitions to a single point of control running on
* the step's parent thread. The PartitionAnalyzer is used to
* receive and process this data.
*
*/
public interface PartitionCollector {
    /**
    * The collectPartitionData method receives control
    * periodically during partition processing.
    * This method receives control on each thread processing
    * a partition as follows:
    * &lt;p&gt;
    * &lt;ol&gt;
    * &lt;li&gt;for a chunk type step, it receives control after
    * every chunk checkpoint and then one last time at the
    * end of the partition;
    &lt;/li&gt;
    * &lt;li&gt;for a batchlet type step, it receives control once
    * at the end of the batchlet.&lt;/li&gt;
    * &lt;/ol&gt;
    * &lt;p&gt;
    * Note the collector is not called if the partition
    * terminates due to an unhandled exception.
    * &lt;p&gt;
    * *@return* an Serializable object to pass to the
    * PartitionAnalyzer.
    * @throws Exception is thrown if an error occurs.
    */
    public Serializable collectPartitionData() throws Exception;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_partitionanalyzer_interface">9.5.4. PartitionAnalyzer Interface</h4>
<div class="paragraph">
<p>A partition analyzer receives control to process data and final results
from partitions. If a partition collector is configured on the step, the
partition analyzer receives control to process the data and results from
the partition collector. While a separate partition collector instance
is invoked on each thread processing a partition, the partition analyzer
runs on a single, consistent thread each time it is invoked. The
PartitionAnalyzer interface may be used to implement an
PartitionAnalyzer batch artifact:</p>
</div>
<div id="app-listing.PartitionAnalyzer.java" class="listingblock">
<div class="title">PartitionAnalyzer.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.partition;
import java.io.Serializable;
import javax.batch.runtime.BatchStatus;
/**
* PartitionAnalyzer receives control to process
* data and final results from each partition. If
* a PartitionCollector is configured on the step,
* the PartitionAnalyzer receives control to process
* the data and results from the partition collector.
* While a separate PartitionCollector instance is
* invoked on each thread processing a step partition,
* a single PartitionAnalyzer instance runs on a single,
* consistent thread each time it is invoked.
*
*/
public interface PartitionAnalyzer {
    /**
    * The analyzeCollectorData method receives
    * control each time a Partition collector sends
    * its payload. It receives the
    * Serializable object from the collector as an
    * input.
    * @param data specifies the payload sent by a
    * PartitionCollector.
    * @throws Exception is thrown if an error occurs.
    */
    public void analyzeCollectorData(Serializable data) throws
    Exception;
    /**
    * The analyzeStatus method receives control each time a
    * partition ends. It receives the batch and exit
    * status strings of the partition as inputs.
    * @param batchStatus specifies the batch status of a partition.
    * @param exitStatus specifies the exit status of a partition.
    * @throws Exception is thrown if an error occurs.
    */
    public void analyzeStatus(BatchStatus batchStatus, String
    exitStatus) throws Exception;
}</code></pre>
</div>
</div>
<div id="app-listing.AbstractPartitionAnalyzer.java" class="listingblock">
<div class="title">AbstractPartitionAnalyzer.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.partition;
import java.io.Serializable;
import javax.batch.runtime.BatchStatus;
/**
* The AbstractPartitionAnalyzer provides default
* implementations of less commonly implemented methods.
*/
public abstract class AbstractPartitionAnalyzer implements
PartitionAnalyzer {
    /**
    * Override this method to analyze PartitionCollector payloads.
    *
    * @param data specifies the payload sent by the
    * PartitionCollector.
    * @throws Exception is thrown if an error occurs.
    */
    @Override
    public void analyzeCollectorData(Serializable data) throws
    Exception {
    }
    /**
    * Override this method to analyze partition end status.
    * @param batchStatus specifies the batch status of a partition.
    * @param exitStatus specifies the exit status of a partition.
    * @throws Exception is thrown if an error occurs.
    */
    @Override
    public void analyzeStatus(BatchStatus batchStatus, String
    exitStatus)
    throws Exception {
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_decider_interface">9.6. Decider Interface</h3>
<div class="paragraph">
<p>A decider may be used to determine batch exit status and sequencing
between steps, splits, and flows in a Job XML. The decider returns a
String value which becomes the exit status value on which the decision
chooses the next transition. The Decider interface may be used to
implement an Decider batch artifact:</p>
</div>
<div id="app-listing.Decider.java" class="listingblock">
<div class="title">Decider.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api;
import javax.batch.runtime.StepExecution;
/**
* A Decider receives control as part of a decision element
* in a job. It is used to direct execution flow during job
* processing. It returns an exit status that updates the
* current job execution's exit status. This exit status
* value also directs the execution transition based on
* next, end, stop, fail child elements configured on the
* same decision element as the decider.
*/
public interface Decider {
    /**
    * The decide method sets a new exit status for a job.
    * It receives an array of StepExecution objects as input.
    * These StepExecution objects represent the execution
    * element that transitions to this decider as follows:
    * &lt;p&gt;
    * &lt;ul&gt;
    * &lt;li&gt;Step&lt;/li&gt;
    * &lt;p&gt;
    * When the transition is from a step, the decide method
    * receives the StepExecution corresponding
    * to the step as input.
    * &lt;li&gt;Split&lt;/li&gt;
    * &lt;p&gt;
    * When the transition is from a split, the decide method
    * receives a StepExecution from each flow defined to the split
    * as input.
    * &lt;li&gt;Flow&lt;/li&gt;
    * &lt;p&gt;
    * When the transition is from a flow, the decide method
    * receives a StepExecution corresponding
    * to the last execution element that completed in the flow.
    * This will be a single StepExecution if the last element
    * was a step and multiple StepExecutions if the last element
    * was a split.
    * &lt;/ul&gt;
    * @param executions specifies the StepExecution(s) of the preceding
    * element.
    * *@return* updated job exit status
    * @throws Exception is thrown if an error occurs.
    */
    public String decide(StepExecution[] executions) throws Exception;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transactionality">9.7. Transactionality</h3>
<div class="paragraph">
<p>Chunk type check points are transactional. The batch runtime uses global
transaction mode on the Java EE platform and local transaction mode on
the Java SE platform. Global transaction timeout is configurable at
step-level with a step-level property:</p>
</div>
<div class="paragraph">
<p>'javax.transaction.global.timeout={seconds} - default is 180
seconds'</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"> &lt;step id="MyGlobalStep"&gt;
  &lt;properties&gt;
   &lt;property name="javax.transaction.global.timeout" value="600"/&gt;
  &lt;/properties&gt;
 &lt;/step&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_batch_runtime_specification">10. Batch Runtime Specification</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_batch_properties_reserved_namespace">10.1. Batch Properties Reserved Namespace</h3>
<div class="paragraph">
<p>The batch runtime supports properties at job, step, partition, and artifact level. The property name prefix, 'javax.batch', is reserved for
use by the batch runtime, as prescribed by this specification and future
revisions of same. Applications and specification implementations must
not define properties for their own use that begin with this prefix.
Applications that do so risk undefined behavior.</p>
</div>
</div>
<div class="sect2">
<h3 id="_job_metrics">10.2. Job Metrics</h3>
<div class="paragraph">
<p>The batch runtime supports the following chunk-type step metrics:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>readCount - the number of items successfully read.</p>
</li>
<li>
<p>writeCount - the number of items successfully written.</p>
</li>
<li>
<p>filterCount - the number of items filtered by ItemProcessor.</p>
</li>
<li>
<p>commitCount - the number of transactions committed.</p>
</li>
<li>
<p>rollbackCount - the number of transactions rolled back.</p>
</li>
<li>
<p>readSkipCount - the number of skippable exceptions thrown by the ItemReader.</p>
</li>
<li>
<p>processSkipCount - the number of skippable exceptions thrown by the ItemProcessor.</p>
</li>
<li>
<p>writeSkipCount - the number of skippable exceptions thrown by the ItemWriter.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These metrics are available through the StepExecution runtime object.
See section 10.9.10 for further information on StepExecution.</p>
</div>
</div>
<div class="sect2">
<h3 id="_job_runtime_identifiers">10.3. Job Runtime Identifiers</h3>
<div class="paragraph">
<p>Job runtime artifacts are uniquely defined at runtime with the following
operational identifiers:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">instanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is a long that represents an instance of a job. A new job
instance is created everytime a job is started with the JobOperator
"start" method.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is a long that represents the next attempt to run a
particular job instance. A new execution is created the first time a job
is started and everytime thereafter when an existing job execution is
restarted with the JobOperator "restart" method. Note there can be no
more than one executionId in the STARTED state at one time for a given
job instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stepExecutionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is a long that represents the attempt to execute a
particular step within a job execution.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note instanceId, executionId, and stepExecutionId are all globally
unique values within a job repository. See section <a href="#_job_repository">7.4</a> for explanation
of job repository.</p>
</div>
</div>
<div class="sect2">
<h3 id="_joboperator_2">10.4. JobOperator</h3>
<div class="paragraph">
<p>The JobOperator interface provides a set of operations to start, stop,
restart, and inspect jobs. See 10.9.6 for detailed description of this
interface. The JobOperator interface is accessible via a factory
pattern:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>JobOperator jobOper = BatchRuntime.getJobOperator();</pre>
</div>
</div>
<div class="paragraph">
<p>See section 10.9.5 for details on the BatchRuntime class.</p>
</div>
</div>
<div class="sect2">
<h3 id="_batch_artifact_loading">10.5. Batch Artifact Loading</h3>
<div class="paragraph">
<p>All batch artifacts comprising a batch application are loadable by the
following loaders in the order specified:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implementation-specific loader<br></p>
<div class="paragraph">
<p>The batch runtime implementation _may_provide an
implementation-specific means by which batch artifacts references in a Job XML (i.e. via the 'ref=' attribute) are resolved to an implementation class and instantiated. When the batch runtime resolves a batch artifact reference to an instance the implementation-specific mechanism (if one exists) is attempted first. The loader must return an
instance or null.<br></p>
</div>
<div class="paragraph">
<p>An example of an implementation-specific loader might be CDI or Spring DI.</p>
</div>
</li>
<li>
<p>Archive loader<br></p>
<div class="paragraph">
<p>If an implementation-specific mechanism does not exist or fails toresolve a batch artifact reference (returns null), then the batch
runtime implementation must resolve the reference with an archive
loader. The implementation must provide an archive loader that resolves
the reference by looking up the reference in a <code>batch.xml</code> file, which
maps reference name to implementation class name. The loader must return
an instance or null.<br></p>
</div>
<div class="paragraph">
<p>The <code>batch.xml</code> file is packaged by the developer with the application under the &#8216;META-INF&#8217; directory (&#8216;WEB-INF/classes/META-INF&#8217; for .war files).<br></p>
</div>
<div class="paragraph">
<p>See <a href="#_job_parameters_on_restart">10.7.1</a> for more about the <code>batch.xml</code> file.</p>
</div>
</li>
<li>
<p>Thread Context Class Loader<br></p>
<div class="paragraph">
<p>If the archive loader fails to resolve a batch artifact reference (returns null), then the batch runtime implementation must resolve the reference by treating the reference as a class name and loading it through the thread context class loader. The loader must return an instance or null.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_job_xml_loading">10.6. Job XML Loading</h3>
<div class="paragraph">
<p>Job XML is specified by name on the JobOperator.start command (see
10.9.6) to start a job.</p>
</div>
<div class="paragraph">
<p>All Job XML references are loadable by the following loaders in the
order specified:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>implementation-specific loader<br></p>
<div class="paragraph">
<p>The batch runtime implementation _must_provide an implementation-specific means by which Job XML references are resolved to a Job XML document.<br></p>
</div>
<div class="paragraph">
<p>The purpose of an implementation-specific loader is to enable Job XMLloading from outside of the application archive, such as from a repository, file system, remote cache, or elsewhere.</p>
</div>
</li>
<li>
<p>archive loader<br></p>
<div class="paragraph">
<p>If the implementation-specific mechanism does fails to resolve a Job XML reference, then the batch runtime implementation must resolve the reference with an archive loader. The implementation must provide an archive loader that resolves the reference by looking up the reference
from the <code>META-INF/batch-jobs</code> directory.<br></p>
</div>
<div class="paragraph">
<p>Job XML documents may be packaged by the developer with the application under the &#8216;META-INF/batch-jobs&#8217; directory ('`WEB-INF/classes/META-INF`/batch-jobs' for .war files).<br></p>
</div>
<div class="paragraph">
<p>See <a href="#_job_xml_substitution_during_restart">10.7.2</a> for more about the <code>META-INF/batch-jobs</code>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_application_packaging_model">10.7. Application Packaging Model</h3>
<div class="paragraph">
<p>The batch artifacts that comprise a batch application requiring no
unique packaging. They may be packaged in a standard jar file or can be
included inside any Java archive type, as supported by the target
execution platform in question.E.g. batch artifacts may be included in
wars, EJB jars, etc, so long as they exist in the class loader scope of
the program initiating the batch jobs (i.e. using the JobOperator start
method).</p>
</div>
<div class="sect3">
<h4 id="_meta_infbatch_xml">10.7.1. <code>META-INF/batch.xml</code></h4>
<div class="paragraph">
<p>A batch application may use the archive loader (see section <a href="#_job_xml_loading">10.5</a>) to
load batch artifacts. The application can direct artifact loading by
supplying an optional <code>batch.xml</code> file. The <code>batch.xml</code> file must be stored
under the <code>META-INF</code> directory. For .jar files it is the standard <code>META-INF</code>
directory. For .war files it is the <code>WEB-INF/classes/META-INF</code> directory.
The format and content of the <code>batch.xml</code> file follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;batch-artifacts xmlns="http://xmlns.jcp.org/xml/ns/javaee"&gt;
 &lt;ref id="&lt;reference-name&gt;" class="&lt;impl-class-name&gt;" /&gt;
&lt;/batch-artifacts&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;reference-name&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the reference name of the batch artifact.
This is the value that is specified on the ref= attribute of the Job
XML.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;impl-class-name&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the fully qualified class name of the
batch artifact implementation.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Notes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If an implementation-specific loader is used (see
<a href="#_job_xml_loading">10.5</a>) any artifact it loads takes precedence over artifacts specified in <code>batch.xml</code>.</p>
</li>
<li>
<p>Use of <code>batch.xml</code> to load batch artifacts requires the
availability of a zero-argument constructor (either a default
constructor or an explicitly-defined, no-arg
constructor ).</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_meta_infbatch_jobs">10.7.2. <code>META-INF/batch-jobs</code></h4>
<div class="paragraph">
<p>A batch application may use the archive loader (see section <a href="#_application_packaging_model">10.6</a>) to
load Job XML documents. The application does this by storing the Job XML
documents under the <code>META-INF/batch-jobs</code> directory. For .jar files the
batch-jobs directory goes under the standard <code>META-INF</code> directory. For
.war files it goes under the <code>WEB-INF/classes/META-INF</code> directory. Note
Job XML documents are valid only in the batch-jobs directory:
sub-directories are ignored.
Job XML documents stored under <code>META-INF/batch-jobs</code> are named with the
convention <code>`&lt;name&gt;.xml</code>,Where:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;name&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the name of a Job XML. This is the value that is
specified on the JobOperator.start command.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.xml</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies required file type of a Job XML file under
<code>META-INF/batch-jobs</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note if an implementation-specific loader (see <a href="#_application_packaging_model">10.6</a>) loads a Job XML
document that document takes precedence over documents stored under
<code>META-INF/batch-jobs</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_restart_processing">10.8. Restart Processing</h3>
<div class="paragraph">
<p>The JobOperator restart method is used to restart a JobExecution. A
JobExecution is eligible for restart if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Its batch status is STOPPED or FAILED.</p>
</li>
<li>
<p>It is the most recent JobExecution.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_job_parameters_on_restart">10.8.1. Job Parameters on Restart</h4>
<div class="paragraph">
<p>Job parameter values are not remembered from one execution to the next.
All Job Parameter substitution during job restart is performed based
exclusively on the job parameters specified on that restart.</p>
</div>
</div>
<div class="sect3">
<h4 id="_job_xml_substitution_during_restart">10.8.2. Job XML Substitution during Restart</h4>
<div class="paragraph">
<p>See section 8.8.1.8 Job Restart Rule.</p>
</div>
</div>
<div class="sect3">
<h4 id="_execution_sequence_on_restart_overview">10.8.3. Execution Sequence on Restart – Overview</h4>
<div class="paragraph">
<p>On the initial execution of a JobInstance, the sequence of execution is
essentially:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start at initial execution element</p>
</li>
<li>
<p>Execute the current execution element</p>
</li>
<li>
<p>Either:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Transition to next execution element (and go to step 2. above) OR</p>
</li>
<li>
<p>Terminate execution</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>On a restart, i.e. a subsequent execution of a JobInstance, the sequence
of execution is similar, but the batch implementation must, in addition,
determine which steps it does and does not need to re-execute.</p>
</div>
<div class="paragraph">
<p>So on a restart, the sequence of execution looks like:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start at restart position</p>
</li>
<li>
<p>Decide whether or not to execute (or re-execute) the current execution element</p>
</li>
<li>
<p>Either:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Transition to next execution element (and go to step 2. above) OR</p>
</li>
<li>
<p>Terminate execution</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>So it follows that for restart we need: a definition of where in the job
definition to begin; rules for deciding whether or not to execute the
current execution element; and rules for performing transitioning,
especially taking into account that all steps relevant to transitioning
may not have executed on this (restart) execution. These rules are
provided below.</p>
</div>
</div>
<div class="sect3">
<h4 id="_execution_sequence_on_restart_detailed_rules">10.8.4. Execution Sequence on Restart – Detailed Rules</h4>
<div class="paragraph">
<p>Upon restart, the job is processed as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Job XML Substitution is performed (see section <a href="#_job_xml_substitution">8.8</a>).</p>
</li>
<li>
<p>Start by setting the current position to the restart position. The restart position is either:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>the execution element identified by the &lt;stop&gt; elements "restart"
attribute if that is how the previous execution ended; else</p>
</li>
<li>
<p>the initial execution element determined the same as upon initial
job start, as described in section <a href="#_step_sequence">8.2.5</a> Step Sequence;</p>
</li>
</ol>
</div>
</li>
<li>
<p>Determine if the current execution element should re-execute:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the current execution element is a COMPLETED step that specifies allow-restart-if-complete=false, then transition based on the exit status for this step from the previous completed execution. If the transition is a next transition, then repeat step 3 here with the value of next as the new, "current" execution element. Or, if the transition
is a terminating transition such as end, stop, or fail, then terminate
the restart execution accordingly.</p>
</li>
<li>
<p>If the current execution element is a COMPLETED step that specifies
allow-restart-if-complete=true, then re-run the step and transition
based on the new exit status from the new step execution. As above,
either repeat step 3 with the next execution element or terminate the
new execution as the transition element</p>
</li>
<li>
<p>If the current execution element is a
STOPPED or FAILED step then restart the step and transition based on the
exit status from the new step execution.+</p>
<div class="paragraph">
<p>Note if the step is a partitioned step, only the partitions that did not
complete previously are restarted. This behavior may be overridden via a
PartitionMapper (see section <a href="#_batchruntime">10.8.5</a>).  Note
for a partitioned step, the checkpoints and persistent user data are
loaded from the persistent store on a per-partition basis (this is not a
new rule, but a fact implied by the discussion of checkpoints in section
<a href="#_step_partitioning">8.2.6</a> and the Step Context in section 9.4.1.1, which is summarized here
for convenience).</p>
</div>
</li>
<li>
<p>If the current execution element is a decision, execute the decision
(i.e. execute the Decider) unconditionally. The Deciders "decide" method
is passed a StepExecution array as a parameter. This array will be
populated with the most-recently completed StepExecution(s) for each
corresponding step.E.g. some StepExecution(s) may derive from previous
job executions and some from the current restart (execution). A single
decision following a split could even have a mix of old, new
StepExecution(s) in the same array.</p>
</li>
<li>
<p>If the current execution element is a flow, transition to the first
execution element in the flow and perform step 3 with this as the
current element. When restart processing of the flow has completed, then
follow the same rules which apply during the original execution (see
section <a href="#_transitioning_rules">8.9</a>) to transition at the flow level to the next execution
element, and repeat step 3 with that element as the current element.<br></p>
<div class="paragraph">
<p>Note the same rules regarding transitioning within a flow during an
original execution apply during restart processing as well.</p>
</div>
</li>
<li>
<p>If the current execution element is a split, proceed in parallel for
each flow in the split. For each flow, repeat step 3 with the flow
element as the current element. When all flows in the split have been
processed, follow the split&#8217;s transition to the next execution element
and repeat step 3 with that element as the current element.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_partitionmapper_on_restart">10.8.5. PartitionMapper on Restart</h4>
<div class="paragraph">
<p>When the PartitionMapper is invoked at the beginning of a step which has
been executed within a previous job execution, the first and most
important decision for the mapper implementor to make is whether or not
to keep the previous partitions or to begin the new execution with new
partition definitions.</p>
</div>
<div class="paragraph">
<p>This decision is communicated to the batch implementation via the
'partitionsOverride' property of the PartitionPlan built by the mapper,
i.e. the result of PartitionPlan&#8217;s getPartitionsOverride() method.</p>
</div>
<div class="paragraph">
<p>This property directs whether or not the partitions used in the previous
execution of this step will or will be used (i.e. the relevant data
carried forward and applied) within the current execution of this step.
(As a consequence, the value of this property has no real meaning when
the mapper is first called on the first execution of this step).</p>
</div>
<div class="sect4">
<h5 id="_partitionsoverride_false">10.8.5.1. partitionsOverride = False</h5>
<div class="paragraph">
<p>Three rules apply in the case where override is set to 'false':</p>
</div>
<div class="sect5">
<h6 id="_number_of_partitions_must_be_same">10.8.5.1.1. Number of Partitions Must Be Same</h6>
<div class="paragraph">
<p>The key idea here is that the mapper must build a partition plan with
the same number of partitions that were used in the previous execution
of this step. As a consequence, it is an error for the partition plan to
return (via getPartitions()) a different number than the number of
partitions established by the plan the last time this step was executed.</p>
</div>
</div>
<div class="sect5">
<h6 id="_partition_properties_populated_from_current_plan">10.8.5.1.2. Partition Properties Populated From Current Plan</h6>
<div class="paragraph">
<p>Though the number of partitions in the previous plan is persisted, the
Properties[] returned by the previous PartitionPlan&#8217;s
getPartitionProperties() is not. On a new execution of this step, it is
the current return value of PartitionPlan#getPartitionProperties() which
is used to populate the pool of potential 'partitionPlan' substitutions
(see section 8.8.1.4).</p>
</div>
</div>
<div class="sect5">
<h6 id="_numbering_of_partitions_via_partition_properties">10.8.5.1.3. "Numbering" of Partitions via Partition Properties</h6>
<div class="paragraph">
<p>Upon execution of this step, the batch implementation will associate
each element of the Properties[] returned by
PartitionPlan#getPartitionProperties() with a single partition, in order
to potentially resolve 'partitionPlan' substitutions (see section
8.8.1.4) for a single partition. During the course of execution of each
partition, the batch implementation will capture data such as checkpoint
values, persistent user data, etc.</p>
</div>
<div class="paragraph">
<p>Upon a new execution of this step during restart, the batch
implementation must ensure that a similar mapping occurs. That is, the
elements of the new Properties[] returned by the
PartitionPlan#getPartitionProperties() built by the mapper must be
mapped to the partitions in the same order as the earlier elements of
the earlier Properties[] were mapped (for resolving 'partitionPlan'
substitutions).</p>
</div>
<div class="paragraph">
<p>E.g., the following must hold:</p>
</div>
<div class="paragraph">
<p>Earlier Execution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>partitionPlanProps[] = mapper.getPartitionPlan().getPartitionProperties();

partitionPlanProps[0] ---maps to---&gt; partition leaving off at checkpoints R0, W0

partitionPlanProps[1] ---maps to---&gt; partition leaving off at checkpoints R1, W1</pre>
</div>
</div>
<div class="paragraph">
<p>Current Execution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>newPartitionPlanProps[] = mapper.getPartitionPlan().getPartitionProperties();

newPartitionPlanProps[0] ---maps to---&gt; partition resuming at checkpoints R0, W0

newPartitionPlanProps [1] ---maps to---&gt; partition resuming at checkpoints R1, W1</pre>
</div>
</div>
<div class="paragraph">
<p>In the shorthand above, "maps to" simply means that the Properties
object on the left is used to potentially resolve the 'partitionPlan'
substitutions for the give partition, before it executes as described.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_partitionsoverride_true">10.8.5.2. partitionsOverride = True</h5>
<div class="paragraph">
<p>In this case, all partition execution data: checkpoints, persistent user
data, etc. from the earlier execution are discarded, and the new
PartitionPlan built by the new execution of the PartitionMapper may
define either the same or a different number of partitions; the new P
artitionPlan&#8217;s getPartitionProperties() return value will be used to
resolve 'partitionPlan' substitutions.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_classes">10.9. Supporting Classes</h3>
<div class="sect3">
<h4 id="_jobcontext">10.9.1. JobContext</h4>
<div id="app-listing.JobContext.java" class="listingblock">
<div class="title">JobContext.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.runtime.context;
/**
*
* A JobContext provides information about the current
* job execution.
*
*/
import java.util.Properties;
import javax.batch.runtime.BatchStatus;
public interface JobContext
{
    /**
    * Get job name
    * *@return* value of 'id' attribute from &lt;job&gt;
    */
    public String getJobName();
    /**
    * The getTransientUserData method returns a transient data object
    * belonging to the current Job XML execution element.
    * *@return* user-specified type
    */
    public Object getTransientUserData();
    /**
    * The setTransientUserData method stores a transient data object into
    * the current batch context.
    * @param data is the user-specified type
    */
    public void setTransientUserData(Object data);
    /**
    * The getInstanceId method returns the current job's instance
    * id.
    * *@return* job instance id
    */
    public *long* getInstanceId();
    /**
    * The getExecutionId method returns the current job's current
    * execution id.
    * *@return* job execution id
    */
    public *long* getExecutionId();
    /**
    * The getProperties method returns the job level properties
    * specified in a job definition.
    * &lt;p&gt;
    * A couple notes:
    * &lt;ul&gt;
    * &lt;li&gt; There is no guarantee that the same Properties object instance
    * is always returned in the same (job) scope.
    * &lt;li&gt; Besides the properties which are defined in JSL within a child
    * &amp;lt;
    properties&amp;gt;
    element of a &amp;lt;
    job&amp;gt;
    element, the batch
    * runtime implementation may choose to include additional,
    * implementation-defined properties.
    * &lt;/ul&gt;
    *
    * *@return* job level properties
    */
    public Properties getProperties();
    /**
    * The getBatchStatus method simply returns the batch status value * set
    by the batch runtime into the job context.
    * *@return* batch status string
    */
    public BatchStatus getBatchStatus();
    /**
    * The getExitStatus method simply returns the exit status value stored
    * into the job context through the setExitStatus method or null.
    * *@return* exit status string
    */
    public String getExitStatus();
    /**
    * The setExitStatus method assigns the user-specified exit status for
    * the current job. When the job ends, the exit status of the job is
    * the value specified through setExitStatus. If setExitStatus was not
    * called or was called with a null value, then the exit status
    * defaults to the batch status of the job.
    * @param status string
    */
    public void setExitStatus(String status);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_stepcontext">10.9.2. StepContext</h4>
<div id="app-listing.StepContext.java" class="listingblock">
<div class="title">StepContext.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.runtime.context;
import java.io.Serializable;
import java.util.Properties;
import javax.batch.runtime.BatchStatus;
import javax.batch.runtime.Metric;
/**
*
* A StepContext provides information about the current step
* of a job execution.
*
*/
public interface StepContext
{
    /**
    * Get step name
    * *@return* value of 'id' attribute from &lt;step&gt;
    *
    */
    public String getStepName();
    /**
    * The getTransientUserData method returns a transient data object
    * belonging to the current Job XML execution element.
    * *@return* user-specified type
    */
    public Object getTransientUserData();
    /**
    * The setTransientUserData method stores a transient data object into
    * the current batch context.
    * @param data is the user-specified type
    */
    public void setTransientUserData(Object data);
    /**
    * The getStepExecutionId method returns the current step's
    * execution id.
    * *@return* step execution id
    */
    public *long* getStepExecutionId();
    /**
    * The getProperties method returns the step
    level properties
    * specified in a job definition.
    * &lt;p&gt;
    * A couple notes:
    * &lt;ul&gt;
    * &lt;li&gt; There is no guarantee that the same Properties object instance
    * is always returned in the same (step) scope.
    * &lt;li&gt; Besides the properties which are defined in JSL within a child
    * &amp;lt;
    properties&amp;gt;
    element of a &amp;lt;
    step&amp;gt;
    element, the batch
    * runtime implementation may choose to include additional,
    * implementation-defined properties.
    * &lt;/ul&gt;
    * *@return* step level properties
    */
    public Properties getProperties();
    /**
    * The getPersistentUserData method returns a persistent data object
    * belonging to the current step. The user data type must implement
    * java.util.Serializable. This data is saved as part of a step's
    * checkpoint. For a step that does not do checkpoints, it is saved
    * after the step ends. It is available upon restart.
    * *@return* user-specified type
    */
    public Serializable getPersistentUserData();
    /**
    * The setPersistentUserData method stores a persistent data object
    * into the current step. The user data type must implement
    * java.util.Serializable. This data is saved as part of a step's
    * checkpoint. For a step that does not do checkpoints, it is saved
    * after the step ends. It is available upon restart.
    * @param data is the user-specified type
    */
    public void setPersistentUserData(Serializable data);
    /**
    * The getBatchStatus method returns the current batch status of the
    * current step. This value is set by the batch runtime and changes as
    * the batch status changes.
    * *@return* batch status string
    */
    public BatchStatus getBatchStatus();
    /**
    * The getExitStatus method simply returns the exit status value stored
    * into the step context through the setExitStatus method or null.
    * *@return* exit status string
    */
    public String getExitStatus();
    /**
    * The setExitStatus method assigns the user-specified exit status for
    * the current step. When the step ends, the exit status of the step is
    * the value specified through setExitStatus. If setExitStatus was not
    * called or was called with a null value, then the exit status
    * defaults to the batch status of the step.
    * @param status string
    */
    public void setExitStatus(String status);
    /**
    * The getException method returns the last exception thrown from a
    * step level batch artifact to the batch runtime.
    * *@return* the last exception
    */
    public Exception getException();
    /**
    * The getMetrics method returns an array of step level metrics. These
    * are things like commits, skips, etc.
    * *@see* javax.batch.runtime.metric.Metric for definition of standard
    * metrics.
    * *@return* metrics array
    */
    public Metric[] getMetrics();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_metric">10.9.3. Metric</h4>
<div id="app-listing.Metric.Java" class="listingblock">
<div class="title">Metric.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.runtime;
/**
*
* The Metric interface defines job metrics recorded by
* the batch runtime.
*
*/
public interface Metric
{
    public *enum* MetricType
    {
        READ_COUNT_, _WRITE_COUNT_,
        _COMMIT_COUNT_,
        _ROLLBACK_COUNT_, _READ_SKIP_COUNT_, _PROCESS_SKIP_COUNT_,
        _FILTER_COUNT_,
        _WRITE_SKIPCOUNT
    }
    /**
    * The getName method returns the metric type.
    * *@return* metric type.
    */
    public MetricType getType();
    /**
    * The getValue method returns the metric value.
    * *@return* metric value.
    */
    public *long* getValue();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_partitionplan">10.9.4. PartitionPlan</h4>
<div id="app-listing.PartitionPlan.java" class="listingblock">
<div class="title">PartitionPlan.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.partition;
/**
*
* PartitionPlan is a helper class that carries partition processing
* information set by the *@PartitionMapper* method.
*
* A PartitionPlan contains:
* &lt;ol&gt;
* &lt;li&gt;number of partition instances &lt;/li&gt;
* &lt;li&gt;number of threads on which to execute the partitions&lt;/li&gt;
* &lt;li&gt;substitution properties for each Partition (which can be
* referenced using the &lt;b&gt;&lt;i&gt;#
{
    partitionPlan['propertyName']
}
&lt;/i&gt;&lt;/b&gt;
* syntax. &lt;/li&gt;
* &lt;/ol&gt;
*/
import java.util.Properties;
public interface PartitionPlan
{
    /**
    * Set number of partitions.
    * @param count specifies the partition count
    */
    public void setPartitions(int count);
    /**
    * Specify whether or not to override the partition
    * count from the previous job execution. This applies
    * only to step restart .
    * &lt;p&gt;
    * When false is specified, the
    * partition count from the previous job execution is used
    * and any new value set for partition count in the current run
    * is ignored. In addition, partition results from the previous
    * job execution are remembered, and only incomplete partitions
    * are reprocessed.
    * &lt;p&gt;
    * When true is specified, the partition count from the current run
    * is used and all results from past partitions are discarded. Any
    * resource cleanup or back out of work done in the previous run is the
    * responsibility of the application. The PartitionReducer artifact's
    * rollbackPartitionedStep method is invoked during restart before any
    * partitions begin processing to provide a cleanup hook.
    */
    public void setPartitionsOverride(boolean override);
    /**
    * Return current value of partition override setting.
    * *@return* override setting.
    */
    public boolean getPartitionsOverride();
    /**
    * Set maximum number of threads requested to use to run
    * partitions for this step. A value of '0' requests the batch
    * implementation to use the partition count as the thread
    * count. Note the batch runtime is not required to use
    * this full number of threads;
    it may not have this many
    * available, and may use less.
    *
    * @param count specifies the requested thread count
    */
    public void setThreads(int count);
    /**
    * Sets array of substitution Properties objects for the set of
    Partitions.
    * @param props specifies the Properties object array
    * @see PartitionPlan#getPartitionProperties()
    */
    public void setPartitionProperties(Properties[] props);
    /**
    * Gets count of Partitions.
    * *@return* Partition count
    */
    public int getPartitions();
    /**
    * Gets maximum number of threads requested to use to run
    * partitions for this step. A value of '0' requests the batch
    * implementation to use the partition count as the thread
    * count. Note the batch runtime is not required to use
    * this full number of threads;
    it may not have this many
    * available, and may use less.
    *
    * *@return* requested thread count
    */
    public int getThreads();
    /**
    * Gets array of Partition Properties objects for Partitions.
    * &lt;p&gt;
    * These can be used in Job XML substitution using
    * substitution expressions with the syntax:
    * &lt;b&gt;&lt;i&gt;#
    {
        partitionPlan['propertyName']
    }
    &lt;/i&gt;&lt;/b&gt;
    * &lt;p&gt;
    * Each element of the Properties array returned can
    * be used to resolving substitutions for a single partition.
    * In the typical use case, each Properties element will
    * have a similar set of property names, with a
    * substitution potentially resolving to the corresponding
    * value for each partition.
    *
    * *@return* Partition Properties object array
    */
    public Properties[]
    getPartitionProperties();
}</code></pre>
</div>
</div>
<div id="app-listing.PartitionPlanImpl.java" class="listingblock">
<div class="title">PartitionPlanImpl.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.api.partition;
import java.util.Properties;
/**
* The PartitionPlanImpl class provides a basic implementation
* of the PartitionPlan interface.
*/
public class PartitionPlanImpl implements PartitionPlan
{
    *private* int partitions= 0;
    *private* boolean override= *false*;
    *private* int threads= 0;
    Properties[] partitionProperties= null;
    @Override
    public void setPartitions(int count)
    {
        partitions= count;
        // default thread count to partition count
        *if* (threads == 0) threads= count;
    }
    @Override
    public void setThreads(int count)
    {
        threads= count;
    }
    @Override
    public void setPartitionsOverride(boolean override)
    {
        *this*.override= override;
    }
    @Override
    public boolean getPartitionsOverride()
    {
        return override;
    }
    @Override
    public void setPartitionProperties(Properties[] props)
    {
        partitionProperties= props;
    }
    @Override
    public int getPartitions()
    {
        return partitions;
    }
    @Override
    public int getThreads()
    {
        return threads;
    }
    @Override
    public Properties[] getPartitionProperties()
    {
        return partitionProperties;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_batchruntime">10.9.5. BatchRuntime</h4>
<div id="app-listing.BatchRuntime.java" class="listingblock">
<div class="title">BatchRuntime.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.runtime;
/**
* The BatchRuntime represents the batch
* runtime environment.
*
*/
import javax.batch.operations.JobOperator;
/**
* BatchRuntime represents the JSR 352 Batch Runtime.
* It provides factory access to the JobOperator interface.
*
*/
public class BatchRuntime
{
    /**
    * The getJobOperator factory method returns
    * an instance of the JobOperator interface.
    * *@return* JobOperator instance.
    */
    public *static* JobOperator getJobOperator()
    {
        return null;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_batchstatus">10.9.6. BatchStatus</h4>
<div id="app-listing.BatchStatus.java" class="listingblock">
<div class="title">BatchStatus.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.runtime;

/**
* BatchStatus enum defines the batch status values
* possible for a job.
*
*/
public enum BatchStatus
{
    STARTING_, _STARTED_, _STOPPING_,
    _STOPPED_, _FAILED_, _COMPLETED_, _ABANDONED_
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_joboperator_3">10.9.7. JobOperator</h4>
<div id="app-listing.JobOperator.java" class="listingblock">
<div class="title">JobOperator.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.operations;
import java.util.List;
import java.util.Set;
import java.util.Properties;
import javax.batch.runtime.JobExecution;
import javax.batch.runtime.JobInstance;
import javax.batch.runtime.StepExecution;
/**
* JobOperator provide the interface for operating on batch jobs.
* Through the JobOperator a program can start, stop, and restart jobs.
* It can additionally inspect job history, to discover what jobs
* are currently running and what jobs have previously run.
*
* The JobOperator interface imposes no security constraints. However,
* the implementer is free to limit JobOperator methods with a security
* scheme of its choice. The implementer should terminate any method
* that is limited by the security scheme with a JobSecurityException.
*
*/
public interface JobOperator
{
    /**
    * Returns a set of all job names known to the batch runtime.
    *
    * *@return* a set of job names.
    * @throws JobSecurityException
    */
    public Set&lt;String&gt; getJobNames() throws JobSecurityException;
    /**
    * Returns number of instances of a job with a particular name.
    *
    * @param jobName
    * specifies the name of the job.
    * *@return* count of instances of the named job.
    * @throws NoSuchJobException
    * @throws JobSecurityException
    */
    public int getJobInstanceCount(String jobName) throws
    NoSuchJobException,
    JobSecurityException;
    /**
    * Returns all JobInstances belonging to a job with a particular name
    * in reverse chronological order.
    *
    * @param jobName
    * specifies the job name.
    * @param start
    * specifies the relative starting number (zero based) to
    * return from the
    * maximal list of job instances.
    * @param count
    * specifies the number of job instances to return from the
    * starting position of the maximal list of job instances.
    * *@return* list of JobInstances.
    * @throws NoSuchJobException
    * @throws JobSecurityException
    */
    public List&lt;JobInstance&gt; getJobInstances(String jobName, int start,
    int count)throws NoSuchJobException, JobSecurityException;
    /**
    * Returns execution ids for job instances with the specified
    * name that have running executions.
    *
    * @param jobName
    * specifies the job name.
    * *@return* a list of execution ids.
    * @throws NoSuchJobException
    * @throws JobSecurityException
    */
    public List&lt;Long&gt; getRunningExecutions(String jobName) throws
    NoSuchJobException, JobSecurityException;
    /**
    * Returns job parameters for a specified job instance. These are the
    * key/value pairs specified when the instance was originally created
    * by the start method.
    *
    * @param executionId
    * specifies the execution from which to retrieve the
    * parameters.
    * *@return* a Properties object containing the key/value job parameter
    * pairs.
    * @throws NoSuchJobExecutionException
    * @throws JobSecurityException
    */
    public Properties getParameters(*long* executionId)
    throws NoSuchJobExecutionException, JobSecurityException;
    /**
    * Creates a new job instance and starts the first execution of that
    * instance, which executes asynchronously.
    *
    * Note the Job XML describing the job is first searched for by name
    * according to a means prescribed by the batch runtime implementation.
    * This may vary by implementation. If the Job XML is not found by that
    * means, then the batch runtime must search for the specified Job XML
    * as a resource from the `META-INF/batch-jobs` directory based on the
    * current class loader. Job XML files under `META-INF/batch-jobs`
    * directory follow a naming convention of "name".xml where "name" is
    * the value of the jobXMLName parameter (see below).
    *
    * @param jobXMLName
    * specifies the name of the Job XML describing the job.
    * @param jobParameters
    * specifies the keyword/value pairs for attribute
    * substitution in the Job XML.
    * *@return* executionId for the job execution.
    * @throws JobStartException
    * @throws JobSecurityException
    */
    public *long* start(String jobXMLName, Properties jobParameters)
    throws
    JobStartException, JobSecurityException;
    /**
    * Restarts a failed or stopped job instance, which executes
    * asynchronously.
    *
    * @param executionId
    * specifies the execution to to restart. This execution
    * must be the most recent execution that ran.
    * @param restartParameters
    * specifies the keyword/value pairs for attribute
    * substitution in the Job XML.
    * *@return* new executionId
    * @throws JobExecutionAlreadyCompleteException
    * @throws NoSuchJobExecutionException
    * @throws JobExecutionNotMostRecentException,
    * @throws JobRestartException
    * @throws JobSecurityException
    */
    public *long* restart(*long* executionId, Properties
    restartParameters)
    throws JobExecutionAlreadyCompleteException,
    NoSuchJobExecutionException,
    JobExecutionNotMostRecentException,
    JobRestartException,
    JobSecurityException;
    /**
    * Request a running job execution stops. This
    * method notifies the job execution to stop
    * and then returns. The job execution normally
    * stops and does so asynchronously. Note
    * JobOperator cannot guarantee the jobs stops:
    * it is possible a badly behaved batch application
    * does not relinquish control.
    * &lt;p&gt;
    * Note for partitioned batchlet steps the Batchlet
    * stop method is invoked on each thread actively
    * processing a partition.
    *
    * @param executionId
    * specifies the job execution to stop.
    * The job execution must be running.
    * @throws NoSuchJobExecutionException
    * @throws JobExecutionNotRunningException
    * @throws JobSecurityException
    */
    public void stop(*long* executionId) throws
    NoSuchJobExecutionException,
    JobExecutionNotRunningException, JobSecurityException;
    /**
    * Set batch status to ABANDONED. The instance must have
    * no running execution.
    * &lt;p&gt;
    * Note that ABANDONED executions cannot be restarted.
    *
    * @param executionId
    * specifies the job execution to abandon.
    * @throws NoSuchJobExecutionException
    * @throws JobExecutionIsRunningException
    * @throws JobSecurityException
    */
    public void abandon(*long* executionId) throws
    NoSuchJobExecutionException,
    JobExecutionIsRunningException, JobSecurityException;
    /**
    * Return the job instance for the specified execution id.
    *
    * @param executionId
    * specifies the job execution.
    * *@return* job instance
    * @throws NoSuchJobExecutionException
    * @throws JobSecurityException
    */
    public JobInstance getJobInstance(*long* executionId) throws
    NoSuchJobExecutionException, JobSecurityException;
    /**
    * Return all job executions belonging to the specified job instance.
    *
    * @param jobInstance
    * specifies the job instance.
    * *@return* list of job executions
    * @throws NoSuchJobInstanceException
    * @throws JobSecurityException
    */
    public List&lt;JobExecution&gt; getJobExecutions(JobInstance instance)
    throws
    NoSuchJobInstanceException, JobSecurityException;
    /**
    * Return job execution for specified execution id
    *
    * @param executionId
    * specifies the job execution.
    * *@return* job execution
    * @throws NoSuchJobExecutionException
    * @throws JobSecurityException
    */
    public JobExecution getJobExecution(*long* executionId) throws
    NoSuchJobExecutionException, JobSecurityException;
    /**
    * Return StepExecutions for specified execution id.
    *
    * @param executionId
    * specifies the job execution.
    * *@return* step executions (order not guaranteed)
    * @throws NoSuchJobExecutionException
    * @throws JobSecurityException
    */
    public List&lt;StepExecution&gt; getStepExecutions(*long* jobExecutionId)
    throws NoSuchJobExecutionException, JobSecurityException;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jobinstance_2">10.9.8. JobInstance</h4>
<div id="app-listing.JobInstance.java" class="listingblock">
<div class="title">JobInstance.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.runtime;
public interface JobInstance
{
    /**
    * Get unique id for this JobInstance.
    * *@return* instance id
    */
    public *long* getInstanceId();
    /**
    * Get job name.
    * *@return* value of 'id' attribute from &lt;job&gt;
    */
    public String getJobName();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jobexecution_2">10.9.9. JobExecution</h4>
<div id="app-listing.JobExecution.java" class="listingblock">
<div class="title">JobExecution.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.runtime;
import java.util.Date;
import java.util.Properties;
public interface JobExecution
{
    /**
    * Get unique id for this JobExecution.
    * *@return* execution id
    */
    public *long* getExecutionId();
    /**
    * Get job name.
    * *@return* value of 'id' attribute from &lt;job&gt;
    */
    public String getJobName();
    /**
    * Get batch status of this execution.
    * *@return* batch status value.
    */
    public BatchStatus getBatchStatus();
    /**
    * Get time execution entered STARTED status.
    * *@return* date (time)
    */
    public Date getStartTime();
    /**
    * Get time execution entered end status: COMPLETED, STOPPED, FAILED
    * *@return* date (time)
    */
    public Date getEndTime();
    /**
    * Get execution exit status.
    * *@return* exit status.
    */
    public String getExitStatus();
    /**
    * Get time execution was created.
    * *@return* date (time)
    */
    public Date getCreateTime();
    /**
    * Get time execution was last updated.
    * *@return* date (time)
    */
    public Date getLastUpdatedTime();
    /**
    * Get job parameters for this execution.
    * *@return* job parameters
    */
    public Properties getJobParameters();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_stepexecution_2">10.9.10. StepExecution</h4>
<div id="app-listing.StepExecution.java" class="listingblock">
<div class="title">StepExecution.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package javax.batch.runtime;
import java.util.Date;
import java.io.Serializable;
public interface StepExecution
{
    /**
    * Get unique id for this StepExecution.
    * *@return* StepExecution id
    */
    public *long* getStepExecutionId();
    /**
    * Get step name.
    * *@return* value of 'id' attribute from &lt;step&gt;
    */
    public String getStepName();
    /**
    * Get batch status of this step execution.
    * *@return* batch status.
    */
    public BatchStatus getBatchStatus();
    /**
    * Get time this step started.
    * *@return* date (time)
    */
    public Date getStartTime();
    /**
    * Get time this step ended.
    * *@return* date (time)
    */
    public Date getEndTime();
    /**
    * Get exit status of step.
    * *@return* exit status
    */
    public String getExitStatus();
    /**
    * Get persistent user data.
    * &lt;p&gt;
    * For a partitioned step, this returns
    * the persistent user data of the
    * &lt;code&gt;StepContext&lt;/code&gt; of the "top-level"
    * or main thread (the one the &lt;code&gt;PartitionAnalyzer&lt;/code&gt;, etc.
    * execute on). It does not return the persistent user
    * data of the partition threads.
    * *@return* persistent data
    */
    public Serializable
    getPersistentUserData ();
    /**
    * Get step metrics
    * *@return* array of metrics
    */
    public Metric[] getMetrics();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_batch_exception_classes">10.9.11. Batch Exception Classes</h4>
<div class="paragraph">
<p>This specification defines batch exception classes in package
javax.batch.operations. Note all batch exceptions are direct subclasses
of base class BatchRuntimeException, which itself is a direct subclass
of java.lang.RuntimeException. The following batch exception classes are
defined:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>JobExecutionAlreadyCompleteException</p>
</li>
<li>
<p>JobExecutionIsRunningException</p>
</li>
<li>
<p>JobExecutionNotMostRecentException</p>
</li>
<li>
<p>JobExecutionNotRunningException</p>
</li>
<li>
<p>JobRestartException</p>
</li>
<li>
<p>JobSecurityException</p>
</li>
<li>
<p>JobStartException</p>
</li>
<li>
<p>NoSuchJobException</p>
</li>
<li>
<p>NoSuchJobExecutionException</p>
</li>
<li>
<p>NoSuchJobInstanceException</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_job_runtime_lifecycle">11. Job Runtime Lifecycle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections describe an ordered flow of artifact method
invocations. Simple symbols are used to denote actions as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Symbol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Meaning</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;action&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An action performed by the batch runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt; - &gt; method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invocation of a batch artifact method by the batch runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[method]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional method.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">// comment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comment to clarify behavior.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LABEL:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Label used for flow control comments.</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_batch_artifact_lifecycle">11.1. Batch Artifact Lifecycle</h3>
<div class="paragraph">
<p>All batch artifacts are instantiated prior to their use in the scope in
which they are declared in the Job XML and are valid for the life of
their containing scope. There are three scopes that pertain to artifact
lifecycle: job, step, and step-partition.</p>
</div>
<div class="paragraph">
<p>One artifact per Job XML reference is instantiated. In the case of a
partitioned step, one artifact per Job XML reference per partition is
instantiated. This means job level artifacts are valid for the life of
the job. Step level artifacts are valid for the life of the step. Step
level artifacts in a partition are valid for the life of the partition.</p>
</div>
<div class="paragraph">
<p>No artifact instance may be shared across concurrent scopes. The same
instance must be used in the applicable scope for a specific Job XML
reference.</p>
</div>
</div>
<div class="sect2">
<h3 id="_job_repository_artifact_lifecycle">11.2. Job Repository Artifact Lifecycle</h3>
<div class="paragraph">
<p>All job repository artifacts are created by the batch runtime during job
processing and exist until deleted by an implementation provided means.</p>
</div>
</div>
<div class="sect2">
<h3 id="_job_processsing">11.3. Job Processsing</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&lt;Create JobContext&gt;</p>
</li>
<li>
<p>&lt;Store job level properties in JobContext&gt;</p>
</li>
<li>
<p>&lt; - &gt;[JobListener.beforeJob&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt;processs execution elements&gt;</p>
</li>
<li>
<p>&lt; - &gt;[JobListener.afterJob&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt;Destroy JobContext&gt;</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_regular_batchlet_processsing">11.4. Regular Batchlet Processsing</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&lt;Create StepContext&gt;</p>
</li>
<li>
<p>&lt;Store step level properties in StepContext&gt;</p>
</li>
<li>
<p>&lt; - &gt; [StepListener.beforeStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt; - &gt; Batchlet.process // thread A</p>
</li>
<li>
<p>// if stop issued:</p>
</li>
<li>
<p>&lt; - &gt;[Batchlet.stop] // thread B, StepContext is available</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.afterStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>&lt;Destroy StepContext&gt;</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_partitioned_batchlet_processsing">11.5. Partitioned Batchlet Processsing</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&lt;Create StepContext&gt;</p>
</li>
<li>
<p>&lt;Store step level properties in StepContext&gt;</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.beforeStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[PartitionReducer.beginPartitionedStep] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[PartitionMapper.mapPartitions] // thread A</p>
</li>
<li>
<p>// per partition:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>&lt; - &gt;Batchlet.process // thread Px</p>
</li>
<li>
<p>// if stop issued:</p>
</li>
<li>
<p>&lt; - &gt;[Batchlet.stop] // thread Py, StepContext is available</p>
</li>
<li>
<p>&lt; - &gt;[PartitionCollector.collectPartitionData] // thread Px</p>
</li>
</ol>
</div>
</li>
<li>
<p>// when collector payload arrives:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[PartitionAnalyzer.analyzeCollectorData] // thread A</p>
</li>
<li>
<p>// when partition ends:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[PartitionAnalyzer.analyzeStatus] // thread A</p>
</li>
<li>
<p>// if rollback condition occurs:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[PartitionReducer.rollbackPartitionedStep] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[PartitionReducer.beforePartitionedStepCompletion] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[PartitionReducer.afterPartitionedStepCompletion] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.afterStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>&lt;Destroy StepContext&gt;</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_regular_chunk_processing">11.6. Regular Chunk Processing</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&lt;Create StepContext&gt;</p>
</li>
<li>
<p>&lt;Store step level properties in StepContext&gt;</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.beforeStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.open // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.open // thread A</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
<li>
<p>// chunk processing:</p>
</li>
<li>
<p>&lt;repeat until no more items (i.e. while readItem hasn&#8217;t returned 'null') &gt; \{</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>&lt;begin checkpoint interval [&lt;begin chunk transaction&gt;]&gt;</p>
</li>
<li>
<p>&lt;repeat until checkpoint criteria reached OR readItem returns <code>null</code>&gt; \{</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>&lt; - &gt;ItemReader.readItem // thread A</p>
</li>
<li>
<p>// if readItem returns non-null</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>&lt; - &gt;ItemProcessor.processItem // thread A</p>
</li>
<li>
<p>// if processItem returns non-null, &lt;add item to writeItems
buffer&gt;</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>// if at least one non-null value has been successfully read inthe present chunk</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>&lt; - &gt;ItemWriter.writeItems // thread A</p>
</li>
</ol>
</div>
</li>
<li>
<p>&lt; - &gt;[ItemReader.checkpointInfo] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[ItemWriter.checkpointInfo] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>[&lt;commit chunk transaction&gt;]</p>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.close // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.close // thread A</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.afterStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>&lt;Destroy StepContext&gt;</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_partitioned_chunk_processing">11.7. Partitioned Chunk Processing</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&lt;Create StepContext&gt;</p>
</li>
<li>
<p>&lt;Store step level properties in StepContext&gt;</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.beforeStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[PartitionReducer.beginPartitionedStep] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[PartitionMapper.mapPartitions] // thread A<br>
// per partition - on thread Px:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.open // thread Px</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.open // thread Px</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
<li>
<p>&lt;repeat until no more items (i.e. while readItem hasn&#8217;t returned
'null') &gt; \{</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>&lt;begin checkpoint interval [&lt;begin chunk transaction&gt;]&gt;</p>
</li>
<li>
<p>&lt;repeat until checkpoint criteria reached OR readItem returns 'null'&gt; \{</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>&lt; - &gt;ItemReader.readItem // thread Px</p>
</li>
<li>
<p>// if readItem returns non-null</p>
<div class="olist upperroman">
<ol class="upperroman" type="I">
<li>
<p>&lt; - &gt;ItemProcessor.processItem // thread Px</p>
</li>
<li>
<p>//if processItem returns non-null, &lt;add item to writeItems buffer&gt;</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>//if at least one non-null value has been successfully read in this partition of the present chunk</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>&lt; - &gt;ItemWriter.writeItems // thread Px</p>
</li>
</ol>
</div>
</li>
<li>
<p>&lt; - &gt;[ItemReader.checkpointInfo] // thread Px</p>
</li>
<li>
<p>&lt; - &gt;[ItemWriter.checkpointInfo] // thread Px</p>
</li>
<li>
<p>&lt;Store (partition-local) StepContext persistent area&gt;</p>
</li>
<li>
<p>[&lt;commit chunk transaction&gt;]</p>
</li>
<li>
<p>&lt; - &gt;[PartitionCollector.collectPartitionData] // thread Px</p>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.close // thread Px</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.close // thread Px</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
</ol>
</div>
</li>
<li>
<p>[&lt;begin transaction&gt; ] // thread A</p>
</li>
<li>
<p>// Actions 9-12 run continuously until all partitions end.</p>
</li>
<li>
<p>// when collector payload arrives:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[PartitionAnalyzer.analyzeCollectorData] // thread A</p>
</li>
<li>
<p>// when partition ends:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[PartitionAnalyzer.analyzeStatus] // thread A</p>
</li>
<li>
<p>// Remaining actions run after all partitions end:</p>
</li>
<li>
<p>// if rollback condition occurs:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[PartitionReducer.rollbackPartitionedStep] // thread A</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;[&lt;rollback transaction &gt;]</p>
</li>
<li>
<p>// else not rollback</p>
</li>
<li>
<p>&lt; - &gt;[PartitionReducer.beforePartitionedStepCompletion] // thread A</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[PartitionReducer.afterPartitionedStepCompletion] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.afterStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>&lt;Destroy StepContext&gt;</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_chunk_with_listeners_except_retrylistener">11.8. Chunk with Listeners (except RetryListener)</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&lt;Create StepContext&gt;</p>
</li>
<li>
<p>&lt;Store step level properties in StepContext&gt;</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.beforeStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.open // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.open // thread A</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
<li>
<p>// chunk processing:</p>
</li>
<li>
<p>&lt;repeat until no more items (i.e. while readItem hasn&#8217;t returned
'null') &gt; \{</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>&lt;begin checkpoint interval [&lt;begin chunk transaction&gt;]&gt;</p>
</li>
<li>
<p>&lt; - &gt;[ChunkListener.beforeChunk] // thread A</p>
</li>
<li>
<p>&lt;repeat until checkpoint criteria reached OR readItem returns 'null'&gt; {</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>&lt; - &gt;[ItemReadListener.beforeRead] // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.readItem // thread A</p>
</li>
<li>
<p>&lt; - &gt;[ItemReadListener.afterRead] // thread A</p>
</li>
<li>
<p>// or:</p>
</li>
<li>
<p>{</p>
</li>
<li>
<p>&lt; - &gt;[ItemReadListener.onReadError] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[SkipListener.onSkipReadItem] // thread A</p>
</li>
<li>
<p>}</p>
</li>
<li>
<p>// if readItem returns non-null</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>&lt; - &gt;[ItemProcessListener.beforeProcess] // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemProcessor.processItem // thread A</p>
</li>
<li>
<p>&lt; - &gt;[ItemProcessListener.afterProcess] // thread A</p>
</li>
<li>
<p>//if processItem returns non-null,&lt; add item to writeItems buffer&gt;</p>
</li>
<li>
<p>// or:</p>
</li>
<li>
<p>{</p>
</li>
<li>
<p>&lt; - &gt;[ItemProcessListener.onProcessError] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[SkipListener.onSkipProcessItem] // thread A</p>
</li>
<li>
<p>}</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>//if at least one non-null value has been successfully read in
the present chunk</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>&lt; - &gt;[ItemWriteListener.beforeWrite] // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.writeItems // thread A</p>
</li>
<li>
<p>&lt; - &gt;[ItemWriteListener.afterWrite] // thread A</p>
</li>
<li>
<p>// or:</p>
</li>
<li>
<p>{</p>
</li>
<li>
<p>&lt; - &gt;[ItemWriteListener.onWriteError] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[SkipListener.onSkipWriteItems] // thread A</p>
</li>
<li>
<p>}</p>
</li>
</ol>
</div>
</li>
<li>
<p>&lt; - &gt;[ChunkListener.afterChunk] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[ItemReader.checkpointInfo] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[ItemWriter.checkpointInfo] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>[&lt;commit chunk transaction&gt;]</p>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.close // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.close // thread A</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.afterStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>&lt;Destroy StepContext&gt;</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_chunk_with_retrylistener">11.9. Chunk with RetryListener</h3>
<div class="paragraph">
<p>Note rollback processing is also depicted in this section.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&lt;Create StepContext&gt;</p>
</li>
<li>
<p>&lt;Store step level properties in StepContext&gt;</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.beforeStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.open // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.open // thread A</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
<li>
<p>// chunk processing:</p>
</li>
<li>
<p>&lt;repeat until no more items (i.e. while readItem hasn&#8217;t returned
'null') &gt; \{</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>S1:</p>
</li>
<li>
<p>&lt;begin checkpoint interval [&lt;begin chunk transaction&gt;]&gt;</p>
</li>
<li>
<p>&lt;repeat until checkpoint criteria reached OR readItem returns
'null'&gt; \{</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>S2:</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.readItem // thread A</p>
</li>
<li>
<p>// if exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[ItemReadListener.onReadErrror] // thread A</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[RetryReadListener.onRetryReadException] // thread A</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;// if retryable exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if no-rollback exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;resume S2:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// else</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;end repeat&gt;</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;// else</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;end repeat&gt;</p>
</li>
<li>
<p>S3:</p>
</li>
<li>
<p>// if readItem returns non-null</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;ItemProcessor.processItem // thread A</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;// if exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[ItemProcessListener.onProcessErrror] // thread A</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[RetryProcessListener.onRetryProcessException] // thread A</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if retryable exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if no-rollback exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;resume S3:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// else</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;end repeat&gt;</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// else</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;end repeat&gt;</p>
</li>
<li>
<p>// if processItem returns non-null, &lt;add item to writeItems buffer&gt;</p>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>// if rollback exception, execute rollback procedure (below) and
resume at S1 with item-count=1</p>
</li>
<li>
<p>S4:</p>
</li>
<li>
<p>// if at least one non-null value has been successfully read in the present chunk</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&lt; - &gt;ItemWriter.writeItems (buffer) // thread A</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;// if exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[ItemWriteListener.onWriteErrror] // thread A</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt; - &gt;[RetryWriteListener.onRetryWriteException] // thread A</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if retryable exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if no-rollback exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;resume S4:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// else</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;execute rollback procedure (below) and resume S1:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// else execute rollback procedure (below) and resume S1:</p>
</li>
<li>
<p>&lt; - &gt;[ItemReader.checkpointInfo] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[ItemWriter.checkpointInfo] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt; // thread A</p>
</li>
<li>
<p>S5:</p>
</li>
<li>
<p>[&lt;commit chunk transaction&gt;] // thread A</p>
</li>
<li>
<p>// if exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;// if retryable exception</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// if no-rollback exception:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;resume S5:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// else</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;execute rollback procedure (below) and resume S1:</p>
</li>
<li>
<p>&#160;&#160;&#160;&#160;&#160;// else execute rollback procedure (below) and resume S1:</p>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.close // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.close // thread A</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.afterStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>&lt;Destroy StepContext&gt;</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Rollback Procedure</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&lt; - &gt;ItemWriter.close // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.close // thread A</p>
</li>
<li>
<p>[ChunkListener.onError] // thread A</p>
</li>
<li>
<p>[rollback transaction]</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.open // thread A, pass last committed checkpoint
info</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.open // thread A, pass last committed checkpoint
info</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_chunk_with_custom_checkpoint_processing">11.10. Chunk with Custom Checkpoint Processing</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>&lt;Create StepContext&gt;</p>
</li>
<li>
<p>&lt;Store step level properties in StepContext&gt;</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.beforeStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.open // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.open // thread A</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
<li>
<p>// chunk processing:</p>
</li>
<li>
<p>&lt;repeat until no more items (i.e. while readItem hasn&#8217;t returned
'null') &gt; \{</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>[</p>
</li>
<li>
<p>&lt; - &gt;[CheckpointAlgorithm.checkpointTimeout]] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[CheckpointAlgorithm.beginCheckpoint] // thread A</p>
</li>
<li>
<p>&lt;begin checkpoint interval [&lt;begin chunk transaction&gt;]&gt;</p>
</li>
<li>
<p>]</p>
</li>
<li>
<p>&lt;repeat until isReadyToCheckpoint returns 'true' OR readItem returns 'null'&gt; \{</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>&lt; - &gt;ItemReader.readItem // thread A</p>
</li>
<li>
<p>// if readItem returns non-null</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>&lt; - &gt;ItemProcessor.processItem // thread A</p>
</li>
<li>
<p>//if processItem returns non-null, &lt;add item to writeItems buffer&gt;</p>
</li>
</ol>
</div>
</li>
<li>
<p>&lt; - &gt;CheckpointAlgorithm.isReadyToCheckpoint // thread A</p>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>//if at least one non-null value has been successfully read in
the present chunk</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>&lt; - &gt;ItemWriter.writeItems // thread A</p>
</li>
</ol>
</div>
</li>
<li>
<p>&lt; - &gt;[ItemReader.checkpointInfo] // thread A</p>
</li>
<li>
<p>&lt; - &gt;[ItemWriter.checkpointInfo] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>[&lt;commit chunk transaction&gt;]</p>
</li>
<li>
<p>&lt; - &gt;[CheckpointAlgorithm.endCheckpoint] // thread A</p>
</li>
</ol>
</div>
</li>
<li>
<p>}</p>
</li>
<li>
<p>[&lt;begin transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;ItemWriter.close // thread A</p>
</li>
<li>
<p>&lt; - &gt;ItemReader.close // thread A</p>
</li>
<li>
<p>[&lt;commit transaction&gt; ]</p>
</li>
<li>
<p>&lt; - &gt;[StepListener.afterStep&#8230;&#8203;] // thread A</p>
</li>
<li>
<p>&lt;Store StepContext persistent area&gt;</p>
</li>
<li>
<p>&lt;Destroy StepContext&gt;</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_split_processing">11.11. Split Processing</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>// For each flow:</p>
</li>
<li>
<p>&lt;run flow&gt; // thread Fx</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_flow_processing">11.12. Flow Processing</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>// For each split or step:</p>
</li>
<li>
<p>&lt;run split or step&gt; // thread Xy</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_stop_processing">11.13. Stop Processing</h3>
<div class="paragraph">
<p>The JobOperator.stop operation stops a running job execution. If a step
is running at the time the stop is invoked, the batch runtime takes the
following actions:</p>
</div>
<div class="paragraph">
<p>Chunk Step</p>
</div>
<div class="paragraph">
<p>The job and step batch status is marked STOPPING. Note the batch runtime
cannot guarantee the step actually exits. The batch runtime attempts to
interrupt the read/process/write chunk processing loop. The batch
runtime allows the step to finish processing the current item. This
means the current item is read, processed if a processor is configured,
and all currently buffered items, if any, including the current item,
are written. If the batch artifacts configured on the chunk type step
return to the batch runtime, as expected, the job and step batch status
is marked STOPPED.</p>
</div>
<div class="paragraph">
<p>Batchlet Step</p>
</div>
<div class="paragraph">
<p>The job and step batch status is marked STOPPING. The batch runtime
invokes the batchlet&#8217;s stop method. Note the batch runtime cannot
guarantee the batchlet actually exits. But a well behaved batchlet will.
If the batchlet returns to the batch runtime, the job and step batch
status is marked STOPPED.</p>
</div>
<div class="paragraph">
<p>Note for partitioned batchlet steps the Batchlet stop method is invoked
on each thread actively processing a partition.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_batch_xml_xsd">12. Batch XML XSD</h2>
<div class="sectionbody">
<div id="app-listing.batch_xml_xsd" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;xml version="1.0" encoding="UTF-8"&gt;
 &lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
elementFormDefault="qualified"
 targetNamespace="http://xmlns.jcp.org/xml/ns/javaee"
 mlns:jbatch="http://xmlns.jcp.org/xml/ns/javaee" version="1.0"&gt;
 &lt;xs:element name="batch-artifacts" type="jbatch:BatchArtifacts" /&gt;
 &lt;xs:complexType name="BatchArtifacts"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="ref" type="jbatch:BatchArtifactRef" minOccurs="0"
maxOccurs="unbounded" /&gt;
 &lt;/xs:sequence&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="BatchArtifactRef"&gt;
 &lt;xs:attribute name="id" use="required" type="xs:string" /&gt;
 &lt;xs:attribute name="class" use="required" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;/xs:schema&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_job_specification_language_2">13. Job Specification Language</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jobs are described by a declarative Job Specification Language (JSL)
defined by an XML schema, also known informally as Job XML.</p>
</div>
<div class="sect2">
<h3 id="_validation_rules">13.1. Validation Rules</h3>
<div class="paragraph">
<p>The batch runtime must perform schema validation during JobOperator
start processing before the start method returns to the caller. A schema
validation error results in JobStartException. The implementation has
two choices for handling semantic errors in the JSL:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Do semantic validation during JobOperator start processing before
returning to the caller. If there is a semantic validation error, the
implementation must throw JobStartException.</p>
</li>
<li>
<p>Do semantic validation after job execution begins. If a semantic
validation error occurs, the implementation must end the job in the
FAILED state. The implementation is advised to log sufficient error
information to enable problem resolution.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Typical semantic validation the batch runtime should detect and handle
include, but is not limited to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>no executable elements</p>
</li>
<li>
<p>non-existent transitions (e.g. next="value" where "value" does not
exist)</p>
</li>
<li>
<p>cycles among next values (e.g. step1:next=step2; step2:next=step1)</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_jsl_xsd">13.2. JSL XSD</h3>
<div id="app-listing.jsl_xsd" class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;xml version="1.0" encoding="UTF-8"&gt;
 &lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
 elementFormDefault="qualified"
targetNamespace="http://xmlns.jcp.org/xml/ns/javaee"
xmlns:jsl="http://xmlns.jcp.org/xml/ns/javaee" version="1.0"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 Job Specification Language (JSL) specifies a job,
 its steps, and directs their execution.
 JSL also can be referred to as "Job XML".
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;xs:simpleType name="artifactRef"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 This is a helper type. Though it is not otherwise
 called out by this name
 in the specification, it captures the fact
 that the xs:string value refers
 to a batch artifact, across numerous
 other JSL type definitions.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;xs:restriction base="xs:string" /&gt;
 &lt;/xs:simpleType&gt;
 &lt;xs:complexType name="Job"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
The type of a job definition, whether concrete or
Abstract. This is the type of the root element of any JSL document.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
The job-level properties, which are accessible
 via the JobContext.getProperties() API in a batch
Artifact.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;/xs:element&gt;
 &lt;xs:element name="listeners" type="jsl:Listeners"
 minOccurs="0" maxOccurs="1"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 Note that "listeners" sequence order in XML does
 not imply order of execution by
The batch runtime, per the
 specification.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;/xs:element&gt;
 &lt;xs:choice minOccurs="0" maxOccurs="unbounded"&gt;
 &lt;xs:element name="decision" type="jsl:Decision" /&gt;
 &lt;xs:element name="flow" type="jsl:Flow" /&gt;
 &lt;xs:element name="split" type="jsl:Split" /&gt;
 &lt;xs:element name="step" type="jsl:Step" /&gt;
 &lt;/xs:choice&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="version" use="required" type="xs:string"
fixed="1.0" /&gt;
 &lt;xs:attribute name="id" use="required" type="xs:ID" /&gt;
 &lt;xs:attribute name="restartable" use="optional" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:element name="job" type="jsl:Job"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
The definition of an job, whether concrete or
Abstract. This is the
 type of the root element of any JSL document.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;/xs:element&gt;
 &lt;xs:complexType name="Listener"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Split"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="flow" type="jsl:Flow" minOccurs="0"
maxOccurs="unbounded" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="id" use="required" type="xs:ID" /&gt;
 &lt;xs:attribute name="next" use="optional" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Flow"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:choice minOccurs="0" maxOccurs="unbounded"&gt;
 &lt;xs:element name="decision" type="jsl:Decision" /&gt;
 &lt;xs:element name="flow" type="jsl:Flow" /&gt;
 &lt;xs:element name="split" type="jsl:Split" /&gt;
 &lt;xs:element name="step" type="jsl:Step" /&gt;
 &lt;/xs:choice&gt;
 &lt;xs:group ref="jsl:TransitionElements" minOccurs="0"
maxOccurs="unbounded" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="id" use="required" type="xs:ID" /&gt;
 &lt;xs:attribute name="next" use="optional" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:group name="TransitionElements"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 This grouping provides allows for the reuse of the
 'end', 'fail', 'next', 'stop' element sequences which
 may appear at the end of a 'step', 'flow', 'split' or 'decision'.
The term 'TransitionElements' does not formally appear in the spec, it
is
A schema convenience.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;xs:choice&gt;
 &lt;xs:element name="end" type="jsl:End" /&gt;
 &lt;xs:element name="fail" type="jsl:Fail" /&gt;
 &lt;xs:element name="next" type="jsl:Next" /&gt;
 &lt;xs:element name="stop" type="jsl:Stop" /&gt;
 &lt;/xs:choice&gt;
 &lt;/xs:group&gt;
 &lt;xs:complexType name="Decision"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;xs:group ref="jsl:TransitionElements" minOccurs="0"
maxOccurs="unbounded"
 /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="id" use="required" type="xs:ID" /&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:attributeGroup name="TerminatingAttributes"&gt;
 &lt;xs:attribute name="on" use="required" type="xs:string" /&gt;
 &lt;xs:attribute name="exit-status" use="optional" type="xs:string" /&gt;
 &lt;/xs:attributeGroup&gt;
 &lt;xs:complexType name="Fail"&gt;
 &lt;xs:attributeGroup ref="jsl:TerminatingAttributes" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="End"&gt;
 &lt;xs:attributeGroup ref="jsl:TerminatingAttributes" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Stop"&gt;
 &lt;xs:attributeGroup ref="jsl:TerminatingAttributes" /&gt;
 &lt;xs:attribute name="restart" use="optional" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Next"&gt;
 &lt;xs:attribute name="on" use="required" type="xs:string" /&gt;
 &lt;xs:attribute name="to" use="required" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="CheckpointAlgorithm"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="ExceptionClassFilter"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="include" minOccurs="0" maxOccurs="unbounded"&gt;
 &lt;xs:complexType&gt;
 &lt;xs:sequence /&gt;
 &lt;xs:attribute name="class" use="required" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;/xs:element&gt;
 &lt;xs:element name="exclude" minOccurs="0" maxOccurs="unbounded"&gt;
 &lt;xs:complexType&gt;
 &lt;xs:sequence /&gt;
 &lt;xs:attribute name="class" use="required" type="xs:string" /&gt;
&lt;/xs:complexType&gt;
 &lt;/xs:element&gt;
 &lt;/xs:sequence&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Step"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties" minOccurs="0"
maxOccurs="1" /&gt;
 &lt;xs:element name="listeners" type="jsl:Listeners"
 minOccurs="0" maxOccurs="1"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 Note that "listeners" sequence order in XML does
 not imply order of execution by
The batch runtime, per the
 specification.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;/xs:element&gt;
 &lt;xs:choice minOccurs="0" maxOccurs="1"&gt;
 &lt;xs:element name="batchlet" type="jsl:Batchlet" /&gt;
 &lt;xs:element name="chunk" type="jsl:Chunk" /&gt;
 &lt;/xs:choice&gt;
 &lt;xs:element name="partition" type="jsl:Partition"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;xs:group ref="jsl:TransitionElements"

minOccurs="0" maxOccurs="unbounded" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="id" use="required" type="xs:ID" /&gt;
 &lt;xs:attribute name="start-limit" use="optional" type="xs:string" /&gt;
 &lt;xs:attribute name="allow-start-if-complete" use="optional"
 type="xs:string" /&gt;
 &lt;xs:attribute name="next" use="optional" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Batchlet"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
&lt;/xs:complexType&gt;
 &lt;xs:complexType name="Chunk"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="reader" type="jsl:ItemReader" /&gt;
 &lt;xs:element name="processor" type="jsl:ItemProcessor"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;xs:element name="writer" type="jsl:ItemWriter" /&gt;
 &lt;xs:element name="checkpoint-algorithm" type="jsl:CheckpointAlgorithm"
minOccurs="0" maxOccurs="1" /&gt;
 &lt;xs:element name="skippable-exception-classes"
type="jsl:ExceptionClassFilter" minOccurs="0" maxOccurs="1" /&gt;
 &lt;xs:element name="retryable-exception-classes"
type="jsl:ExceptionClassFilter"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;xs:element name="no-rollback-exception-classes"
type="jsl:ExceptionClassFilter"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="checkpoint-policy" use="optional"
type="xs:string"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 Specifies the checkpoint policy that governs
 commit behavior for this chunk.
 Valid values are: "item" or
 "custom". The "item" policy means the
 chunk is checkpointed after a
 specified number of items are
 processed. The "custom" policy means
The chunk is checkpointed
According to a checkpoint algorithm
 implementation. Specifying
 "custom" requires that the
 checkpoint-algorithm element is also
 specified. It is an optional
Attribute. The default policy is
 "item". However, we chose not to define
A schema-specified default for this attribute.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;/xs:attribute&gt;
 &lt;xs:attribute name="item-count" use="optional" type="xs:string"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 Specifies the number of items to process per chunk
 when using the item
 checkpoint policy. It must be valid XML integer.
 It is an optional
Attribute. The default is 10. The item-count
Attribute is ignored
 for "custom" checkpoint policy. However, to
 make it easier for implementations to support JSL inheritance
 we abstain from defining a schema-specified default for this
Attribute.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;/xs:attribute&gt;
 &lt;xs:attribute name="time-limit" use="optional" type="xs:string"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 Specifies the amount of time in seconds before
 taking a checkpoint for the
 item checkpoint policy. It must be valid
 XML integer. It is an
 optional attribute. The default is 0, which
 means no limit. However, to
 make it easier for implementations to
 support JSL inheritance
 we abstain from defining a schema-specified
 default for this attribute.
 When a value greater than zero is
 specified, a checkpoint is taken when
 time-limit is reached or
 item-count items have been processed,
 whichever comes first. The
 time-limit attribute is ignored for
 "custom" checkpoint policy.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;/xs:attribute&gt;
 &lt;xs:attribute name="skip-limit" use="optional" type="xs:string"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 Specifies the number of exceptions a step will
 skip if any configured
 skippable exceptions are thrown by chunk
 processing. It must be a
 valid XML integer value. It is an optional
Attribute. The default
 is no limit.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;/xs:attribute&gt;
 &lt;xs:attribute name="retry-limit" use="optional" type="xs:string"&gt;
 &lt;xs:annotation&gt;
 &lt;xs:documentation&gt;
 Specifies the number of times a step will retry if
Any configured retryable
 exceptions are thrown by chunk processing.
 It must be a valid XML
 integer value. It is an optional attribute.
The default is no
 limit.
 &lt;/xs:documentation&gt;
 &lt;/xs:annotation&gt;
 &lt;/xs:attribute&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="ItemReader"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="ItemProcessor"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="ItemWriter"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Property"&gt;
 &lt;xs:attribute name="name" type="xs:string" use="required" /&gt;
 &lt;xs:attribute name="value" type="xs:string" use="required" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Properties"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="property" type="jsl:Property" maxOccurs="unbounded"
minOccurs="0" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="partition" use="optional" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Listeners"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="listener" type="jsl:Listener" maxOccurs="unbounded"
minOccurs="0" /&gt;
 &lt;/xs:sequence&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Partition"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:choice minOccurs="0" maxOccurs="1"&gt;
 &lt;xs:element name="mapper" type="jsl:PartitionMapper" /&gt;
 &lt;xs:element name="plan" type="jsl:PartitionPlan" /&gt;
 &lt;/xs:choice&gt;
 &lt;xs:element name="collector" type="jsl:Collector"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;xs:element name="analyzer" type="jsl:Analyzer" minOccurs="0"
 maxOccurs="1" /&gt;
 &lt;xs:element name="reducer" type="jsl:PartitionReducer"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="PartitionPlan"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="unbounded" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="partitions" use="optional" type="xs:string" /&gt;
 &lt;xs:attribute name="threads" use="optional" type="xs:string" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="PartitionMapper"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Collector"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="Analyzer"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;xs:complexType name="PartitionReducer"&gt;
 &lt;xs:sequence&gt;
 &lt;xs:element name="properties" type="jsl:Properties"
 minOccurs="0" maxOccurs="1" /&gt;
 &lt;/xs:sequence&gt;
 &lt;xs:attribute name="ref" use="required" type="jsl:artifactRef" /&gt;
 &lt;/xs:complexType&gt;
 &lt;/xs:schema&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_credits">14. Credits</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Section 7 Domain Language of Batch, was adapted from Spring Batch
Reference Documentation:</p>
</div>
<div class="paragraph">
<p><a href="http://static.springsource.org/spring-batch/trunk/reference/html-single/index.html">http://static.springsource.org/spring-batch/trunk/reference/html-single/index.html</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_change_log">15. Change Log</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_version_1_0_revision_a_maintenance_release">15.1. Version 1.0 Revision A - Maintenance Release</h3>
<div class="sect3">
<h4 id="_issues_list">15.1.1. Issues List</h4>
<div class="paragraph">
<p>Following these links will show each original issue on our official spec
issues tracking list. In most cases the bug report contains the complete
text of the spec delta or addition, but not in every single case.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5389">5389</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In Sec. <a href="#_job_parameters_on_restart">10.7.1</a>,
should we have said we require a "no-arg" explicit or implicit
constructor rather than a "default constructor"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=4827">4827</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPEC: Misspoke on
collector role on exit status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5490">5490</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clarify
JobContext/StepContext properties; fix TCK to not depend on writable
Properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5431">5431</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ItemProcessListener#onProcessError has javadoc from
ItemProcessListener#afterProcess</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5498">5498</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add "mark FAILED"
to BatchStatus state transitions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5370">5370</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spec is unclear
whether JobOperator methods may/must execute synchronously or not (with
TCK implications)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5583">5583</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CheckpointAlgorithm needs to specify timeunit (seconds) and other
javadoc fixes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5372">5372</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluation order
of multiple transition elements</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5691">5691</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Looping" should
be clarified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5690">5690</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flow/Split
transitioning &amp; termination not fully defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5374">5374</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Details of
exception handling (by container)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=4830">4830</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#_next_element">8.6.1</a> Transition
Next Element</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=4865">4865</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPEC Partition
Plan example confusing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5533">5533</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stop/end/fail
exit-status should affect job exit status, not step (as claimed in
spec).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5780">5780</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spec should
clarify StepExecution values passed to Decider on a restart</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5373">5373</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Co-existence of
transition elements with @next attribute PLUS behavior if no transition
element @on is matched</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5375">5375</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spec contradicts
itself when talking about uninitialized exit status (TCK assumes 'null')</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=4866">4866</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPEC Partition
Properties example has a invalid tag</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5746">5746</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Inject
@BatchProperty should work for job level properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5911">5911</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clarify partition
restart processing, PartitionPlan properties, and persistent user data
for partitioned steps.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5873">5873</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clarify when
CheckpointAlgorithm#beginCheckpoint is invoked</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5919">5919</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spec doesn&#8217;t fully
describe PartitionPlan override and the use of PartitionMapper</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5875">5875</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When the first
readItem() in a chunk return 'null', is this a zero-item chunk or is
this not a new chunk after all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://java.net/bugzilla/show_bug.cgiid=5403">5403</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spec unclear on
skipping part of an Exception hierarchy</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-10-28 14:23:57 -0400
</div>
</div>
</body>
</html>